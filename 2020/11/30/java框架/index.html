<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Java框架 | mikasa</title><meta name="keywords" content="Java框架"><meta name="author" content="mikasa"><meta name="copyright" content="mikasa"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="description" content="Java框架">
<meta property="og:type" content="article">
<meta property="og:title" content="Java框架">
<meta property="og:url" content="http://yoursite.com/2020/11/30/java%E6%A1%86%E6%9E%B6/index.html">
<meta property="og:site_name" content="mikasa">
<meta property="og:description" content="Java框架">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://ss1.bdstatic.com/70cFvXSh_Q1YnxGkpoWK1HF6hhy/it/u=564071848,1846939077&fm=26&gp=0.jpg">
<meta property="article:published_time" content="2020-11-30T07:28:46.462Z">
<meta property="article:modified_time" content="2020-11-30T08:51:26.982Z">
<meta property="article:author" content="mikasa">
<meta property="article:tag" content="Java,JavaScript,Node,Json,Sql,前端,数据库,后端">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://ss1.bdstatic.com/70cFvXSh_Q1YnxGkpoWK1HF6hhy/it/u=564071848,1846939077&fm=26&gp=0.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://yoursite.com/2020/11/30/java%E6%A1%86%E6%9E%B6/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":1,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  ClickShowText: undefined,
  lightbox: 'mediumZoom',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
};

var saveToLocal = {
  set: function setWithExpiry(key, value, ttl) {
    const now = new Date()
    const expiryDay = ttl * 86400000
    const item = {
      value: value,
      expiry: now.getTime() + expiryDay,
    }
    localStorage.setItem(key, JSON.stringify(item))
  },

  get: function getWithExpiry(key) {
    const itemStr = localStorage.getItem(key)

    if (!itemStr) {
      return undefined
    }
    const item = JSON.parse(itemStr)
    const now = new Date()

    if (now.getTime() > item.expiry) {
      localStorage.removeItem(key)
      return undefined
    }
    return item.value
  }
}

// https://stackoverflow.com/questions/16839698/jquery-getscript-alternative-in-native-javascript
const getScript = url => new Promise((resolve, reject) => {
  const script = document.createElement('script')
  script.src = url
  script.async = true
  script.onerror = reject
  script.onload = script.onreadystatechange = function() {
    const loadState = this.readyState
    if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
    script.onload = script.onreadystatechange = null
    resolve()
  }
  document.head.appendChild(script)
})</script><script id="config_change">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2020-11-30 16:51:26'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(function () {  window.activateDarkMode = function () {
    document.documentElement.setAttribute('data-theme', 'dark')
    if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
    }
  }
  window.activateLightMode = function () {
    document.documentElement.setAttribute('data-theme', 'light')
   if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
    }
  }
  const autoChangeMode = 'false'
  const t = saveToLocal.get('theme')
  if (autoChangeMode === '1') {
    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
    const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
    const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified
    if (t === undefined) {
      if (isLightMode) activateLightMode()
      else if (isDarkMode) activateDarkMode()
      else if (isNotSpecified || hasNoSupport) {
        const now = new Date()
        const hour = now.getHours()
        const isNight = hour <= 6 || hour >= 18
        isNight ? activateDarkMode() : activateLightMode()
      }
      window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
        if (saveToLocal.get('theme') === undefined) {
          e.matches ? activateDarkMode() : activateLightMode()
        }
      })
    } else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else if (autoChangeMode === '2') {
    const now = new Date()
    const hour = now.getHours()
    const isNight = hour <= 6 || hour >= 18
    if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
    else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else {
    if (t === 'dark') activateDarkMode()
    else if (t === 'light') activateLightMode()
  }const asideStatus = saveToLocal.get('aside-status')
if (asideStatus !== undefined) {
   if (asideStatus === 'hide') {
     document.documentElement.classList.add('hide-aside')
   } else {
     document.documentElement.classList.remove('hide-aside')
   }
}})()</script><meta name="generator" content="Hexo 5.2.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="/img/index/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">57</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/source/categories/"><div class="headline">分类</div><div class="length-num">16</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标籤</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 娱乐</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li><li><a class="site-page" href="/games/"><i class="fa-fw fas fa-video"></i><span> 游戏</span></a></li><li><a class="site-page" href="/books/"><i class="fa-fw fas fa-video"></i><span> 书籍</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div></div></div></div><div id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://ss1.bdstatic.com/70cFvXSh_Q1YnxGkpoWK1HF6hhy/it/u=564071848,1846939077&amp;fm=26&amp;gp=0.jpg)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">mikasa</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标籤</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 娱乐</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li><li><a class="site-page" href="/games/"><i class="fa-fw fas fa-video"></i><span> 游戏</span></a></li><li><a class="site-page" href="/books/"><i class="fa-fw fas fa-video"></i><span> 书籍</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Java框架</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2020-11-30T07:28:46.462Z" title="发表于 2020-11-30 15:28:46">2020-11-30</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2020-11-30T08:51:26.982Z" title="更新于 2020-11-30 16:51:26">2020-11-30</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/source/categories/Java/">Java</a></span></div><div class="meta-secondline"> <span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">25.7k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>119分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="一-maven"><a href="#一-maven" class="headerlink" title="一.maven"></a>一.maven</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">项目管理工具</span><br><span class="line">	使用maven来构建，会发现总体上工程文件会小很多</span><br><span class="line">		jar包的坐标，放在 xml配置文件</span><br><span class="line">	核心功能</span><br><span class="line">	依赖管理，maven工程对jar包的管理</span><br><span class="line">	一键构建 指的是项目从编译测试运行，打包，安装部署，整个过程都交给maven进行管理</span><br></pre></td></tr></table></figure>

<h2 id="1-1仓库的种类"><a href="#1-1仓库的种类" class="headerlink" title="1.1仓库的种类"></a>1.1仓库的种类</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">本地仓库</span><br><span class="line">中央仓库</span><br><span class="line">远程仓库（私服）</span><br></pre></td></tr></table></figure>

<h2 id="1-2配置文件"><a href="#1-2配置文件" class="headerlink" title="1.2配置文件"></a>1.2配置文件</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">核心代码部分</span><br><span class="line">配置文件是  jar包之外的部分，不把他打包在 jar包里面</span><br><span class="line">单元测试</span><br><span class="line">测试配置文件</span><br><span class="line">	</span><br><span class="line">	标准目录结构</span><br><span class="line">		src/main/java  核心代码部分</span><br><span class="line">		src/main/resource 配置文件部分</span><br><span class="line">		src/test/java 测试代码部分</span><br><span class="line">        src/test/resource 测试配置文件</span><br><span class="line">        src/main/webapp 页面资源 js css html</span><br></pre></td></tr></table></figure>

<h2 id="1-3maven常用指令"><a href="#1-3maven常用指令" class="headerlink" title="1.3maven常用指令"></a>1.3maven常用指令</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mvn clean  删除掉target目录 </span><br><span class="line">mvn compile  编译</span><br><span class="line">mvn test   会把测试代码进行编译，会把main下面的主代码编译</span><br><span class="line">mvn <span class="keyword">package</span>  打包，把测试/main代码编译</span><br><span class="line">mvn install  编译测试打包，把项目打包在本地仓库</span><br><span class="line">mvn deploy  	发布</span><br></pre></td></tr></table></figure>

<h2 id="1-4创建java工程"><a href="#1-4创建java工程" class="headerlink" title="1.4创建java工程"></a>1.4创建java工程</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">    </span><br><span class="line">包是红色，选择  maven 重新导入</span><br></pre></td></tr></table></figure>



<h1 id="二-mybatis"><a href="#二-mybatis" class="headerlink" title="二.mybatis"></a>二.mybatis</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">在 mybatis中把它的持久层的操作接口名称和映射文件 叫做  Mapper</span><br></pre></td></tr></table></figure>



<h2 id="2-1环境搭建流程"><a href="#2-1环境搭建流程" class="headerlink" title="2.1环境搭建流程"></a>2.1环境搭建流程</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">	&lt;dependencies&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;org.mybatis&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;mybatis&lt;/artifactId&gt;</span><br><span class="line">            &lt;version&gt;3.4.5&lt;/version&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;mysql&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;</span><br><span class="line">            &lt;version&gt;5.1.6&lt;/version&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;log4j&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;log4j&lt;/artifactId&gt;</span><br><span class="line">            &lt;version&gt;1.2.12&lt;/version&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;junit&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;junit&lt;/artifactId&gt;</span><br><span class="line">            &lt;version&gt;4.10&lt;/version&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line">    &lt;/dependencies&gt;</span><br><span class="line">    <span class="number">3.</span>创建一个实体类对应数据字段，并在数据库中创建对应的数据表它内部封装了  jdbc，开发者只需要关注sql语句本身，不需要创建连接等繁琐的过程！</span><br><span class="line"></span><br><span class="line">ORM（Object Relational Mapping）对象关系映射。简单地说，就是把数据库表和实体类及实体类的属性对应起来，让我们可以通过操作实体类来操作数据库表。</span><br><span class="line"></span><br><span class="line">配置环境步骤</span><br><span class="line">	<span class="number">1.</span>创建工程</span><br><span class="line">	<span class="number">2.</span>引入mybatis所需jar包</span><br><span class="line">        &lt;dependencies&gt;</span><br><span class="line">            &lt;dependency&gt;</span><br><span class="line">                &lt;groupId&gt;org.mybatis&lt;/groupId&gt;</span><br><span class="line">                &lt;artifactId&gt;mybatis&lt;/artifactId&gt;</span><br><span class="line">                &lt;version&gt;3.4.5&lt;/version&gt;</span><br><span class="line">            &lt;/dependency&gt;</span><br><span class="line">            &lt;dependency&gt;</span><br><span class="line">                &lt;groupId&gt;mysql&lt;/groupId&gt;</span><br><span class="line">                &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;</span><br><span class="line">                &lt;version&gt;5.1.6&lt;/version&gt;</span><br><span class="line">            &lt;/dependency&gt;</span><br><span class="line">            &lt;dependency&gt;</span><br><span class="line">                &lt;groupId&gt;log4j&lt;/groupId&gt;</span><br><span class="line">                &lt;artifactId&gt;log4j&lt;/artifactId&gt;</span><br><span class="line">                &lt;version&gt;1.2.12&lt;/version&gt;</span><br><span class="line">            &lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">            &lt;dependency&gt;</span><br><span class="line">                &lt;groupId&gt;junit&lt;/groupId&gt;</span><br><span class="line">                &lt;artifactId&gt;junit&lt;/artifactId&gt;</span><br><span class="line">                &lt;version&gt;4.10&lt;/version&gt;</span><br><span class="line">            &lt;/dependency&gt;</span><br><span class="line">        &lt;/dependencies&gt;</span><br><span class="line">    <span class="number">3.</span>创建一个实体类对应数据字段，并在数据库中创建对应的数据表</span><br><span class="line">    <span class="number">4.</span>添加mysql配置文件，mybatis配置文件</span><br><span class="line">    	&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span><br><span class="line">                &lt;!--约束--&gt;</span><br><span class="line">                &lt;!DOCTYPE configuration</span><br><span class="line">                        PUBLIC <span class="string">&quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span></span><br><span class="line">                        <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line">                &lt;!--配置环境--&gt;</span><br><span class="line">                &lt;configuration&gt;</span><br><span class="line">                    &lt;typeAliases&gt;</span><br><span class="line">                        &lt;<span class="keyword">package</span> name=<span class="string">&quot;com.it.domain&quot;</span>/&gt;</span><br><span class="line">                    &lt;/typeAliases&gt;</span><br><span class="line">                    &lt;environments <span class="keyword">default</span>=<span class="string">&quot;mysql&quot;</span>&gt;</span><br><span class="line">                        &lt;!--配置mysql的环境--&gt;</span><br><span class="line">                        &lt;environment id=<span class="string">&quot;mysql&quot;</span>&gt;</span><br><span class="line">                            &lt;!--配置事务类型--&gt;</span><br><span class="line">                            &lt;transactionManager type=<span class="string">&quot;JDBC&quot;</span> /&gt;</span><br><span class="line">                            &lt;!--配置数据源连接池--&gt;</span><br><span class="line">                            &lt;dataSource type=<span class="string">&quot;POOLED&quot;</span>&gt;</span><br><span class="line">                                &lt;!--配置连接数据库的四个基本信息--&gt;</span><br><span class="line">                                &lt;property name=<span class="string">&quot;driver&quot;</span> value=<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>/&gt;</span><br><span class="line">                                &lt;property name=<span class="string">&quot;url&quot;</span> value=<span class="string">&quot;jdbc:mysql://localhost:3306/mybatis&quot;</span>/&gt;</span><br><span class="line">                                &lt;property name=<span class="string">&quot;username&quot;</span> value=<span class="string">&quot;root&quot;</span>/&gt;</span><br><span class="line">                                &lt;property name=<span class="string">&quot;password&quot;</span> value=<span class="string">&quot;root&quot;</span>/&gt;</span><br><span class="line">                            &lt;/dataSource&gt;</span><br><span class="line">                        &lt;/environment&gt;</span><br><span class="line">                    &lt;/environments&gt;</span><br><span class="line">                    &lt;!--指定映射文件的位置，每个dao独立的配置文件--&gt;</span><br><span class="line">                    &lt;!--指定带有注解的位置--&gt;</span><br><span class="line">                    &lt;mappers&gt;</span><br><span class="line">                        &lt;!--&lt;mapper <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;com.it.dao.IUserdao&quot;</span>/&gt;--&gt;</span><br><span class="line">                        &lt;<span class="keyword">package</span> name=<span class="string">&quot;com.it.dao&quot;</span>/&gt;</span><br><span class="line">                    &lt;/mappers&gt;</span><br><span class="line">                &lt;/configuration&gt;</span><br><span class="line">                </span><br><span class="line">        <span class="number">5.</span>编写 sql 映射配置文件</span><br><span class="line">        	&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span><br><span class="line">                &lt;!DOCTYPE mapper PUBLIC <span class="string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span><br><span class="line">                        <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span><br><span class="line">                &lt;mapper namespace=<span class="string">&quot;com.it.dao.IUserdao&quot;</span>&gt;</span><br><span class="line">                    &lt;!--配置查询所有--&gt;</span><br><span class="line">                    &lt;select id=<span class="string">&quot;findAll&quot;</span>&gt;</span><br><span class="line">                        SELECT * FROM USER</span><br><span class="line">                    &lt;/select&gt;</span><br><span class="line">                &lt;/mapper&gt;</span><br><span class="line">              </span><br><span class="line">              注意事项</span><br><span class="line">              		<span class="number">1.</span>mybatis的映射文件配置必须和dao接口的包结构相同</span><br><span class="line">              		<span class="number">2.</span>映射配置文件的mapper标签namespace必须是dao接口的全限定类名</span><br><span class="line">              		<span class="number">3.</span>映射配置文件的操作配置，id属性必须是dao接口的方法名 select</span><br></pre></td></tr></table></figure>

<h2 id="2-2注解"><a href="#2-2注解" class="headerlink" title="2.2注解"></a>2.2注解</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">把Iuserdao.xml删除，在dao接口的方法上 写 <span class="meta">@select</span>注解，并且sql语句，同时需要在</span><br><span class="line">sqlmapconfig.xml  mapper配置的时候使用<span class="class"><span class="keyword">class</span>属性指定接口的全类名</span></span><br></pre></td></tr></table></figure>

<h2 id="2-3开始执行"><a href="#2-3开始执行" class="headerlink" title="2.3开始执行"></a>2.3开始执行</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//读取配置文件</span></span><br><span class="line">      <span class="comment">//创建sqlSessionFactory工厂模式</span></span><br><span class="line">      <span class="comment">//生成sqlSession对象</span></span><br><span class="line">      <span class="comment">//使用sqlSession创建dao接口的代理对象</span></span><br><span class="line">      <span class="comment">//使用代理对象执行方法</span></span><br><span class="line">      <span class="comment">//释放资源</span></span><br><span class="line">      InputStream in = Resources.getResourceAsStream(<span class="string">&quot;sqlmap.xml&quot;</span>);</span><br><span class="line">      SqlSessionFactoryBuilder builder = <span class="keyword">new</span> SqlSessionFactoryBuilder();</span><br><span class="line">      SqlSessionFactory factory = builder.build(in);</span><br><span class="line">      SqlSession session = factory.openSession();</span><br><span class="line">      IUserdao userdao = session.getMapper(IUserdao.class);</span><br><span class="line">      List&lt;User&gt; users = userdao.findAll();</span><br><span class="line">      <span class="keyword">for</span> (User user:users)&#123;</span><br><span class="line">          System.out.println(user);</span><br><span class="line">      &#125;</span><br><span class="line">      session.close();</span><br><span class="line">      in.close();</span><br><span class="line">      </span><br><span class="line">      </span><br><span class="line">      保存操作需要提交事务</span><br><span class="line">      	 session.commit();</span><br><span class="line">      	 新增用户后，还需要返回当前用户的id值</span><br><span class="line">      	 &lt;select key keyproperty =<span class="string">&quot;id&quot;</span> </span><br><span class="line">      	 keyclunm =<span class="string">&quot;id&quot;</span></span><br><span class="line">      	 order=<span class="string">&quot;AFTER&quot;</span> result type=<span class="string">&quot;INTERFE&quot;</span>&gt;  </span><br><span class="line">      	 <span class="function">select <span class="title">last_insert_id</span><span class="params">()</span></span></span><br><span class="line"><span class="function">      	 用keyproperty 代表要返回的值</span></span><br><span class="line"><span class="function">      	 </span></span><br><span class="line"><span class="function">      删除用户</span></span><br><span class="line"><span class="function">      	parameterType</span>=<span class="string">&quot;Integer&quot;</span></span><br><span class="line">     	查询根据id一个用户</span><br><span class="line">     		parameterType=<span class="string">&quot;INt&quot;</span> resulttype=<span class="string">&quot;com.it.domain.User&quot;</span></span><br><span class="line">     	</span><br><span class="line">      模糊查询的占位符分析</span><br><span class="line">      	有两种方法</span><br><span class="line">      		#&#123;&#125;  #%&#123;&#125;%</span><br><span class="line">      	</span><br><span class="line">      </span><br><span class="line">      </span><br><span class="line">      解决数据库添加汉字时候出现？？？</span><br><span class="line">      	在mysql.xml  连接数据库配置文件后面加上</span><br><span class="line">      	?useUnicode=<span class="keyword">true</span>&amp;amp;characterEncoding=UTF-<span class="number">8</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">      	 </span></span><br><span class="line"><span class="string">      </span></span><br><span class="line"><span class="string">      代码分析</span></span><br><span class="line"><span class="string">      	读取配置文件</span></span><br><span class="line"><span class="string">      		1.使用类加载器，他只能读取类路径的配置文件</span></span><br><span class="line"><span class="string">      		2.使用sessioncontext对象的getrealpath()</span></span><br><span class="line"><span class="string">      	创建工厂mybatis使用了构建模式，</span></span><br><span class="line"><span class="string">      		优势 解耦</span></span><br><span class="line"><span class="string">      	创建Dao接口实现类使用了代理，</span></span><br><span class="line"><span class="string">      		优势，不修改源码对已有方法进行增强</span></span><br></pre></td></tr></table></figure>

<h2 id="2-4-OGNL表达式"><a href="#2-4-OGNL表达式" class="headerlink" title="2.4 OGNL表达式"></a>2.4 OGNL表达式</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">对象图导航语言</span><br><span class="line">	它通过对象中的取值方法来获取数据，在写法上 把get省略了</span><br><span class="line">	因为在 parameterType中已经提供了属性所属的类，</span><br><span class="line">	此时sql表达式不需要写对象名</span><br><span class="line">	</span><br><span class="line">	<span class="number">1.</span>使用实体类的包装对象作为查询对象</span><br><span class="line">	<span class="number">2.</span></span><br></pre></td></tr></table></figure>

<h2 id="2-5通过配置properties文件来实现"><a href="#2-5通过配置properties文件来实现" class="headerlink" title="2.5通过配置properties文件来实现"></a>2.5通过配置properties文件来实现</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">也可以</span><br><span class="line">&lt;properties&gt;</span><br><span class="line">        &lt;property name=<span class="string">&quot;driver&quot;</span> value=<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>/&gt;</span><br><span class="line">        &lt;property name=<span class="string">&quot;url&quot;</span> value=<span class="string">&quot;jdbc:mysql://localhost:3306/mybatis?useUnicode=true&amp;amp;characterEncoding=UTF-8&quot;</span>/&gt;</span><br><span class="line">        &lt;property name=<span class="string">&quot;username&quot;</span> value=<span class="string">&quot;root&quot;</span>/&gt;</span><br><span class="line">        &lt;property name=<span class="string">&quot;password&quot;</span> value=<span class="string">&quot;root&quot;</span>/&gt;</span><br><span class="line">    &lt;/properties&gt;</span><br><span class="line">    </span><br><span class="line">    下面改为$&#123;username&#125;的方式来用</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    还可以把属性内的数据库信息放到外部文件  properties内</span><br><span class="line">    然后引入外部</span><br><span class="line">    &lt;properties resouce=<span class="string">&quot;jdbcconfig.properties&quot;</span>&gt;</span><br><span class="line">    然后配置文件前面加上  jdbc.url</span><br><span class="line"> 	引入也加上</span><br><span class="line"> 	</span><br><span class="line"> 	urI: 统一资源标识符  http:<span class="comment">//localhost:8080/mybatis/demo1servlet</span></span><br></pre></td></tr></table></figure>

<h2 id="2-6typealiases，package标签"><a href="#2-6typealiases，package标签" class="headerlink" title="2.6typealiases，package标签"></a>2.6typealiases，package标签</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">typealiases标签 只能配置 domain的别名</span><br><span class="line"><span class="keyword">package</span>标签   用于指定要配置的包，自动注册别名</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	MyBatis的返回参数类型分两种</span><br><span class="line"></span><br><span class="line">对应的分类为：</span><br><span class="line"><span class="number">1.1</span>. resultMap :</span><br><span class="line">			 结果集[对象等]</span><br><span class="line"><span class="number">1.2</span>. resultType :	 Integer,String ,Long ,<span class="class"><span class="keyword">class</span></span></span><br></pre></td></tr></table></figure>

<h2 id="2-7mybatis的连接池的使用"><a href="#2-7mybatis的连接池的使用" class="headerlink" title="2.7mybatis的连接池的使用"></a>2.7mybatis的连接池的使用</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">开发中都会使用连接池，因为它可以减少我们开发的时间</span><br><span class="line">是一个用来存储连接的容器</span><br><span class="line">	容器其实就是一个集合对象，该集合必须是线程安全的，不能两个线程拿到一个连接，</span><br><span class="line">    该集合还必须实现队列的特性</span><br></pre></td></tr></table></figure>

<h3 id="2-7-1配置"><a href="#2-7-1配置" class="headerlink" title="2.7.1配置"></a>2.7.1配置</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">主配置文件</span><br><span class="line">	datasource 取值</span><br><span class="line">			POOLed    采用传统的java.sql.datasource规范的连接池，有实现</span><br><span class="line">			UNPOOLed	采用了传统的获取链接，虽然也实现sql.datasource规范，但是没有池的思想</span><br><span class="line">			JNDi	采用服务器提供的技术JNDI技术实现，来获取datasource实现，不同的服务器不一样，</span><br><span class="line">					如果不是web或者maven的war工程是不能使用的，tomcat使用的就是dbcp连接池</span><br></pre></td></tr></table></figure>

<h3 id="2-7-2动态sql语句"><a href="#2-7-2动态sql语句" class="headerlink" title="2.7.2动态sql语句"></a>2.7.2动态sql语句</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line">sqlif and sql where</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span></span><br><span class="line">choose (when, otherwise)</span><br><span class="line">trim (where, set)</span><br><span class="line">foreach</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="number">1.</span><span class="keyword">if</span></span><br><span class="line">通常要做的事情是有条件地包含 where 子句的一部分，例如查询年龄，身高，筛选</span><br><span class="line">	&lt;select id=<span class="string">&quot;findActiveBlogLike&quot;</span></span><br><span class="line">         resultType=<span class="string">&quot;Blog&quot;</span>&gt;</span><br><span class="line">      SELECT * FROM BLOG WHERE state = ‘ACTIVE’ </span><br><span class="line">      &lt;<span class="keyword">if</span> test=<span class="string">&quot;title != null&quot;</span>&gt;</span><br><span class="line">        AND title like #&#123;title&#125;</span><br><span class="line">      &lt;/if&gt;</span><br><span class="line">      &lt;<span class="keyword">if</span> test=<span class="string">&quot;author != null and author.name != null&quot;</span>&gt;</span><br><span class="line">        AND author_name like #&#123;author.name&#125;</span><br><span class="line">      &lt;/if&gt;</span><br><span class="line">    &lt;/select&gt;</span><br><span class="line"> </span><br><span class="line">优化</span><br><span class="line">where 元素知道只有在一个以上的<span class="keyword">if</span>条件有值的情况下才去插入<span class="string">&quot;WHERE&quot;</span>子句。而且，若最后的内容是<span class="string">&quot;AND&quot;</span>或<span class="string">&quot;OR&quot;</span>开头的，where 元素也知道如何将他们去除。</span><br><span class="line">				&lt;select id=<span class="string">&quot;findActiveBlogLike&quot;</span></span><br><span class="line">                     resultType=<span class="string">&quot;Blog&quot;</span>&gt;</span><br><span class="line">                  SELECT * FROM BLOG </span><br><span class="line">                  &lt;where&gt; </span><br><span class="line">                    &lt;<span class="keyword">if</span> test=<span class="string">&quot;state != null&quot;</span>&gt;</span><br><span class="line">                         state = #&#123;state&#125;</span><br><span class="line">                    &lt;/if&gt; </span><br><span class="line">                    &lt;<span class="keyword">if</span> test=<span class="string">&quot;title != null&quot;</span>&gt;</span><br><span class="line">                        AND title like #&#123;title&#125;</span><br><span class="line">                    &lt;/if&gt;</span><br><span class="line">                    &lt;<span class="keyword">if</span> test=<span class="string">&quot;author != null and author.name != null&quot;</span>&gt;</span><br><span class="line">                        AND author_name like #&#123;author.name&#125;</span><br><span class="line">                    &lt;/if&gt;</span><br><span class="line">                  &lt;/where&gt;</span><br><span class="line">                &lt;/select&gt;</span><br><span class="line"> </span><br><span class="line"><span class="number">2.</span>choose (when, otherwise)</span><br><span class="line">有些时候，我们不想用到所有的条件语句，而只想从中择其一二。针对这种情况，MyBatis 提供了 choose 元素，它有点像 Java 中的 <span class="keyword">switch</span> 语句。</span><br><span class="line">        &lt;select id=<span class="string">&quot;findActiveBlogLike&quot;</span></span><br><span class="line">             resultType=<span class="string">&quot;Blog&quot;</span>&gt;</span><br><span class="line">          SELECT * FROM BLOG WHERE state = ‘ACTIVE’</span><br><span class="line">          &lt;choose&gt;</span><br><span class="line">            &lt;when test=<span class="string">&quot;title != null&quot;</span>&gt;</span><br><span class="line">              AND title like #&#123;title&#125;</span><br><span class="line">            &lt;/when&gt;</span><br><span class="line">            &lt;when test=<span class="string">&quot;author != null and author.name != null&quot;</span>&gt;</span><br><span class="line">              AND author_name like #&#123;author.name&#125;</span><br><span class="line">            &lt;/when&gt;</span><br><span class="line">            &lt;otherwise&gt;</span><br><span class="line">              AND featured = <span class="number">1</span></span><br><span class="line">            &lt;/otherwise&gt;</span><br><span class="line">          &lt;/choose&gt;</span><br><span class="line">        &lt;/select&gt;</span><br><span class="line"></span><br><span class="line"><span class="number">3.</span>trim (where, set)</span><br><span class="line">如果 where 元素没有按正常套路出牌，我们还是可以通过自定义 trim 元素来定制我们想要的功能。比如，和 where 元素等价的自定义 trim 元素为：</span><br><span class="line">						&lt;trim prefix=<span class="string">&quot;WHERE&quot;</span> prefixOverrides=<span class="string">&quot;AND |OR &quot;</span>&gt;</span><br><span class="line">                          ... </span><br><span class="line">                        &lt;/trim&gt;</span><br><span class="line">                        </span><br><span class="line">                   &lt;update id=<span class="string">&quot;updateAuthorIfNecessary&quot;</span>&gt;</span><br><span class="line">                      update Author</span><br><span class="line">                        &lt;set&gt;</span><br><span class="line">                          &lt;if test=&quot;username != null&quot;&gt;username=#&#123;username&#125;,&lt;/if&gt;</span><br><span class="line">                          &lt;if test=&quot;password != null&quot;&gt;password=#&#123;password&#125;,&lt;/if&gt;</span><br><span class="line">                          &lt;if test=&quot;email != null&quot;&gt;email=#&#123;email&#125;,&lt;/if&gt;</span><br><span class="line">                          &lt;if test=&quot;bio != null&quot;&gt;bio=#&#123;bio&#125;&lt;/if&gt;</span><br><span class="line">                        &lt;/set&gt;</span><br><span class="line">                      where id=#&#123;id&#125;</span><br><span class="line">                    &lt;/update&gt;</span><br><span class="line">                    </span><br><span class="line"><span class="number">4.</span>foreach</span><br><span class="line">	动态 SQL 的另外一个常用的必要操作是需要对一个集合进行遍历，通常是在构建 IN 条件语句的时候。比如：</span><br><span class="line">				&lt;select id=<span class="string">&quot;selectPostIn&quot;</span> resultType=<span class="string">&quot;domain.blog.Post&quot;</span>&gt;</span><br><span class="line">  SELECT *</span><br><span class="line">  FROM POST P</span><br><span class="line">  WHERE ID in</span><br><span class="line">  &lt;foreach item=<span class="string">&quot;item&quot;</span> index=<span class="string">&quot;index&quot;</span> collection=<span class="string">&quot;list&quot;</span></span><br><span class="line">      open=<span class="string">&quot;(&quot;</span> separator=<span class="string">&quot;,&quot;</span> close=<span class="string">&quot;)&quot;</span>&gt;</span><br><span class="line">        #&#123;item&#125;</span><br><span class="line">  &lt;/foreach&gt;</span><br><span class="line">&lt;/select&gt;</span><br><span class="line">	foreach 遍历</span><br><span class="line">	collection  代表要遍历的集合元素</span><br><span class="line">	open开始的部分  </span><br><span class="line">	close  结束的部分</span><br><span class="line">	item 代表遍历集合的每个元素，生成的变量名</span><br><span class="line">	sperator  分隔符</span><br></pre></td></tr></table></figure>

<h2 id="2-8多表查询"><a href="#2-8多表查询" class="headerlink" title="2.8多表查询"></a>2.8多表查询</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>创建一个新的类 ，继承account，tostring方法要<span class="keyword">super</span>.toString</span><br><span class="line"></span><br><span class="line"><span class="number">2.</span>体现出主表和从表的关系</span><br><span class="line">		<span class="number">1.</span>从表实体应该包含主表实体的对象引用</span><br><span class="line">			就是 <span class="keyword">private</span> User user;</span><br><span class="line">			生成get，set方法</span><br><span class="line">		<span class="number">2.</span>定义封装account和user的 resultmap</span><br><span class="line">			&lt;resultMap id=<span class="string">&quot;accountUserMap&quot;</span> type=<span class="string">&quot;account&quot;</span>&gt;</span><br><span class="line">				&lt;id property=&quot;id&quot;  column=&quot;aid&quot;&gt;&lt;/id&gt;</span><br><span class="line">				&lt;result property=&quot;uid&quot;  column=&quot;uid&quot;&gt;&lt;/result&gt;</span><br><span class="line">				&lt;result property=&quot;money&quot;  column=&quot;money&quot;&gt;&lt;/result&gt;</span><br><span class="line">				&lt;!----!&gt;</span><br><span class="line">				&lt;association property=<span class="string">&quot;user&quot;</span> column=<span class="string">&quot;uid&quot;</span>&gt;</span><br><span class="line">                	&lt;id property=<span class="string">&quot;id&quot;</span> column=<span class="string">&quot;id&quot;</span>&gt;&lt;id&gt;</span><br><span class="line">                	&lt;result property=&quot;username&quot;  column=&quot;username&quot;&gt;&lt;/result&gt;</span><br><span class="line">                	&lt;result property=&quot;address&quot;  column=&quot;address&quot;&gt;&lt;/result&gt;</span><br><span class="line">                	&lt;result property=&quot;sex&quot;  column=&quot;sex&quot;&gt;&lt;/result&gt;</span><br><span class="line">                	&lt;result property=&quot;birthday&quot;  column=&quot;birthday&quot;&gt;&lt;/result&gt;</span><br><span class="line">                &lt;/association&gt;</span><br><span class="line">			&lt;/resultMap&gt;</span><br><span class="line">			</span><br><span class="line">			</span><br><span class="line">			</span><br><span class="line">		也可以反过来操作</span><br></pre></td></tr></table></figure>

<h2 id="2-9延迟加载"><a href="#2-9延迟加载" class="headerlink" title="2.9延迟加载"></a>2.9延迟加载</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">问题</span><br><span class="line">	在查询用户时候，是么时候用，什么时候查询</span><br><span class="line">	查询账户时候，账户所属的用户信息应该查出来</span><br><span class="line">延迟加载</span><br><span class="line">	查询用户，在真正使用数据时候才发起查询，也可以理解为懒加载，按需加载</span><br><span class="line">立即加载</span><br><span class="line">	不管用不用，只要一调用方法，马上发起来查询</span><br><span class="line">	一对多，多对多 通常情况下都是延迟加载</span><br><span class="line">				延迟加载全局开关在 主配置文件中</span><br><span class="line">	多对一，一对一 通常都是立即加载</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="2-10缓存"><a href="#2-10缓存" class="headerlink" title="2.10缓存"></a>2.10缓存</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">减少和数据库的交互次数，提高执行效率</span><br><span class="line">	适用于缓存</span><br><span class="line">		经常查询，并且不经常改变的</span><br><span class="line">		数据的正确与否对最终的影响不大</span><br><span class="line">	不适用于缓存</span><br><span class="line">		经常改变的数据</span><br><span class="line">		数据的正确与否对最终结果影响很大</span><br><span class="line">		</span><br><span class="line">	一级缓存</span><br><span class="line">		值得是mybatis中sqlsession的缓存，查询的结果会存到SQL session中，结果是一个map</span><br><span class="line">		再次查询同样的数据，mybatis回去sqlsession中查看是否有，直接拿出来用</span><br><span class="line">		当sqlsession消失的时候，mybatis就消失了</span><br><span class="line">		</span><br><span class="line">		当修改的时候，就会清除一级缓存</span><br><span class="line">		</span><br><span class="line">	二级缓存</span><br><span class="line">		值得是sqlsessionfactory对象的缓存，由同一个值得是sqlsessionfactory对象创建的sqlsession共享他的缓存</span><br><span class="line">		opensession();</span><br><span class="line">		二级缓存步骤</span><br><span class="line">			让mybatis框架支持二级缓存   主配置文件  默认<span class="keyword">true</span></span><br><span class="line">			让当前文件映射文件支持二级缓存 写一个cache标签</span><br><span class="line">			让当前的操作支持二级缓存 查询用户的时候 加一个属性 操作usercache = <span class="string">&quot;true&quot;</span>;</span><br><span class="line">			注意 二级缓存中存放的是数据 </span><br></pre></td></tr></table></figure>

<h2 id="2-11注解开发"><a href="#2-11注解开发" class="headerlink" title="2.11注解开发"></a>2.11注解开发</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">配置</span><br><span class="line"></span><br><span class="line">		&lt;!--配置别名--&gt;</span><br><span class="line">            &lt;typeAliases&gt;</span><br><span class="line">                &lt;<span class="keyword">package</span> name=<span class="string">&quot;com.it.domain&quot;</span>/&gt;</span><br><span class="line">            &lt;/typeAliases&gt;</span><br><span class="line">		</span><br><span class="line">		&lt;mappers&gt;</span><br><span class="line">            &lt;!--&lt;mapper <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;com.it.dao.IUserdao&quot;</span>/&gt;--&gt;</span><br><span class="line">            &lt;<span class="keyword">package</span> name=<span class="string">&quot;com.it.dao&quot;</span>/&gt;</span><br><span class="line">        &lt;/mappers&gt;</span><br><span class="line">   		 </span><br><span class="line">   		  <span class="meta">@Select(&quot;select * from user&quot;)</span>;</span><br><span class="line">    			<span class="function">List&lt;User&gt; <span class="title">findAll</span><span class="params">()</span></span>;</span><br><span class="line">    			</span><br><span class="line">    	 session.commit();删除操作需要提交</span><br><span class="line">    	 注解来设置一对多</span><br><span class="line">    	 <span class="meta">@results()</span></span><br><span class="line">    	 </span><br><span class="line">    	 一对一</span><br><span class="line">    	 		    <span class="meta">@Select(&quot;select * from user&quot;)</span></span><br><span class="line">                    <span class="meta">@Results(id=&quot;userMap&quot;)</span></span><br><span class="line">                    <span class="function">List&lt;User&gt; <span class="title">findAll</span><span class="params">()</span></span>;</span><br><span class="line">                    <span class="comment">//保存用户</span></span><br><span class="line">                <span class="comment">//    @Delete(&quot;delete from user where id=#&#123;id&#125; &quot;)</span></span><br><span class="line">                <span class="comment">//    void deleteinfo(Integer userid);</span></span><br><span class="line"></span><br><span class="line">                    <span class="meta">@Select(&quot;select * from user where id =#&#123;id&#125; &quot;)</span></span><br><span class="line">                    <span class="meta">@ResultMap(value = &#123;&quot;userMap&quot;&#125;)</span></span><br><span class="line">                    <span class="function">User <span class="title">findById</span><span class="params">(Integer id)</span></span>;</span><br><span class="line">    	 	</span><br><span class="line">    	 </span><br><span class="line">    	 </span><br><span class="line">    	 </span><br><span class="line">    	 	    <span class="meta">@Select(&quot;select * from account&quot;)</span></span><br><span class="line">                <span class="meta">@Results(id=&quot;accountMap&quot;,value = &#123;</span></span><br><span class="line"><span class="meta">                        @Result(id = true,column = &quot;id&quot;,property = &quot;id&quot;),</span></span><br><span class="line"><span class="meta">                        @Result(column = &quot;money&quot;,property = &quot;money&quot;),</span></span><br><span class="line"><span class="meta">                        @Result(property = &quot;user&quot;,column = &quot;id&quot;,</span></span><br><span class="line"><span class="meta">                        one=@One(select = &quot;com.it.dao.IUserdao.findById&quot;,</span></span><br><span class="line"><span class="meta">                                fetchType = FetchType.EAGER))</span></span><br><span class="line"><span class="meta">                &#125;)</span></span><br><span class="line">                </span><br><span class="line">       注意事项：         </span><br><span class="line">               <span class="number">1.</span> one=<span class="meta">@One(select = &quot;com.it.dao.IUserdao.findById&quot;,</span></span><br><span class="line"><span class="meta">                                fetchType = FetchType.EAGER)</span> 是一对一的注解方式</span><br><span class="line">                                一对多用many</span><br><span class="line">               <span class="number">2.</span>fenchtype用来配置  延迟加载还是懒加载</span><br><span class="line">               <span class="number">3.</span>一级缓存，mtbatis自动使用，不在主配置文件中配置，二级缓存也是默认开启的，在映射接口的上面写上<span class="meta">@cacheNameSpace(blocking=true)</span>	开启二级缓存</span><br><span class="line">               <span class="number">4.</span><span class="meta">@Results</span>需要配合<span class="meta">@Select</span>一起使用</span><br><span class="line">               <span class="number">5.</span>已经定义的Result可以通过resultMap直接使用，两者通过id匹配</span><br><span class="line">               <span class="number">6.</span>子查询可以直接使用父查询的参数</span><br><span class="line">               	</span><br></pre></td></tr></table></figure>

<h1 id="3-Spring"><a href="#3-Spring" class="headerlink" title="3.Spring"></a>3.Spring</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>spring框架的概述以及spring继续xml的ioc配置</span><br><span class="line"><span class="number">2.</span>spring中基于注解的ioc和ioc的案例</span><br><span class="line"><span class="number">3.</span>spring中的AOP和基于xml的Aop配置</span><br><span class="line"><span class="number">4.</span>spring中的jdbcTemplate和事务控制</span><br><span class="line">下载地址：https:<span class="comment">//repo.spring.io/libs-release-local/</span></span><br><span class="line"></span><br><span class="line">Spring是分层的javaSE/EE应用的轻量级的开源框架以AOP(面向切面编程)和IOC(控制反转)为核心</span><br><span class="line">提供了展现层  SPringMVC 和Spring JDBC以及事务管理的技术</span><br><span class="line"></span><br><span class="line">优势</span><br><span class="line">	<span class="number">1.</span>方便解耦，简化开发</span><br><span class="line">	<span class="number">2.</span>AOP编程的支持</span><br><span class="line">	<span class="number">3.</span>声明式的支持</span><br><span class="line">	<span class="number">4.</span>方便程序的测试</span><br><span class="line">	<span class="number">5.</span>方便集成各种优秀的框架</span><br><span class="line">	<span class="number">6.</span>降低javaEE api的使用难度</span><br><span class="line">	</span><br><span class="line">体系结构</span><br><span class="line">	耦合：</span><br><span class="line">		程序之间的依赖关系，</span><br><span class="line">		方法之间的依赖</span><br><span class="line">		类之间的依赖</span><br><span class="line">	解耦：降低程序之间的依赖关系</span><br><span class="line">	实际开发中：编译器不依赖，运行期依赖</span><br><span class="line">		思路：</span><br><span class="line">		<span class="number">1.</span>使用反射来创建对象，而且避免<span class="keyword">new</span>关键字</span><br><span class="line">		<span class="number">2.</span>通过读取配置文件来读取类名</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">		xml配置文件</span><br><span class="line">			&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span><br><span class="line">            &lt;beans xmlns=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span><br><span class="line">                   xmlns:xsi=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="line">                   xsi:schemaLocation=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span><br><span class="line"><span class="string">                            http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span><br><span class="line">                &lt;!--把对象的创建交给spring来管理--&gt;</span><br><span class="line">                &lt;bean id=&quot;accountService&quot; class=&quot;com.it.service.imp1.AccountServiceImp&quot;&gt;&lt;/bean&gt;</span><br><span class="line">                &lt;bean id=&quot;accountDao&quot; class=&quot;com.it.dao.impl.AccountDaoImpl&quot;&gt;&lt;/bean&gt;</span><br><span class="line">            &lt;/beans&gt;</span><br><span class="line">            </span><br><span class="line">            </span><br><span class="line">          main函数调用</span><br><span class="line">		 ApplicationContext ac = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;bean.xml&quot;</span>);</span><br><span class="line">        <span class="comment">/*根据id获取bean对象*/</span></span><br><span class="line">        IAccountService as = (IAccountService)ac.getBean(<span class="string">&quot;accountService&quot;</span>);</span><br><span class="line">        IAccountDao adao = ac.getBean(<span class="string">&quot;accountDao&quot;</span>,IAccountDao.class);</span><br></pre></td></tr></table></figure>

<h2 id="3-1-IOC"><a href="#3-1-IOC" class="headerlink" title="3.1 IOC"></a>3.1 IOC</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">控制反转</span><br><span class="line">	把对象创建的权利交给框架或者工厂，并非面向对象编程的专业术语，它包括依赖注入和依赖查找</span><br><span class="line">	作用</span><br><span class="line">		降低他们之间的依赖关系</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">	表现层---&gt;调业务层--&gt;调持久层</span><br><span class="line">	</span><br><span class="line">	spring IOC核心容器</span><br><span class="line">			ApplicationContext的三个常用是实现类</span><br><span class="line">				ClassPathXmlApplicationContext 可以加载类路径下的配置文件</span><br><span class="line">				FileSyetemXmlApplicationContext	可以加载磁盘任意路径下的配置文件</span><br><span class="line">				AnnotationConfigApplicationContext 用于读取注解创建容器</span><br><span class="line">				</span><br><span class="line">	核心容器的两个接口</span><br><span class="line">		ApplicationContext 采用立即加载的方式，只要读取完毕，马上创建配置对象</span><br><span class="line">		Beanfactory		创建对象采取的策略是延迟加载的什么时候获取id，什么时候创建再使用</span><br><span class="line">		</span><br><span class="line">	bean细节三种创建对象</span><br><span class="line">		<span class="number">1.</span>默认构造函数</span><br><span class="line">			&lt;bean id=&quot;accountDao&quot; class=&quot;com.it.dao.impl.AccountDaoImpl&quot;&gt;&lt;/bean&gt;</span><br><span class="line">		<span class="number">2.</span>使用普通工厂中的方法创建对象，并且存入spring容器</span><br><span class="line">			factory-bean   factory-method=<span class="string">&quot;方法&quot;</span></span><br><span class="line">		<span class="number">3.</span>使用静态方法创建对象并且存入spring容器</span><br><span class="line">		&lt;bean id=<span class="string">&quot;accountDao&quot;</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;com.it.dao.impl.AccountDaoImpl</span></span><br><span class="line">		 factory-method=&quot;方法&quot;&quot;&gt;&lt;/bean&gt;</span><br><span class="line">	</span><br><span class="line">	作用范围</span><br><span class="line">		scope属性用于指定作用范围</span><br><span class="line">			singleton    单例   立马创建</span><br><span class="line">			prototype	多例	使用对象时候创建   java辣鸡回收</span><br><span class="line">			request		作用于web应用的请求范围</span><br><span class="line">			session		作用域web应用的会话范围</span><br><span class="line">			global-session		作于集群环境的会话范围，不是集群环境，就是session</span><br><span class="line">								负载均衡，</span><br><span class="line">		</span><br></pre></td></tr></table></figure>

<h2 id="3-2注入"><a href="#3-2注入" class="headerlink" title="3.2注入"></a>3.2注入</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">依赖关系的管理，交给spring来维护，就称为依赖注入</span><br><span class="line">	有三类</span><br><span class="line">		基本类型和String</span><br><span class="line">		其他bean类型，在Spring容器中有的类</span><br><span class="line">		复杂类型/集合</span><br><span class="line">			&lt;property name=<span class="string">&quot;shuxing&quot;</span>&gt;</span><br><span class="line">				&lt;array&gt;</span><br><span class="line">					&lt;value&gt;AAA&lt;value&gt;</span><br><span class="line">					&lt;value&gt;AAdasdA&lt;value&gt;</span><br><span class="line">					&lt;value&gt;AdasdaAA&lt;value&gt;</span><br><span class="line">				&lt;array&gt;</span><br><span class="line">			&lt;/property&gt;</span><br><span class="line">			&lt;property name=<span class="string">&quot;shuxing&quot;</span>&gt;</span><br><span class="line">				&lt;map&gt;</span><br><span class="line">					&lt;entry key=“”&gt;</span><br><span class="line">						&lt;value&gt;AAA&lt;value&gt;</span><br><span class="line">					&lt;entry&gt;</span><br><span class="line">					</span><br><span class="line">				&lt;map&gt;</span><br><span class="line">			&lt;/property&gt;</span><br><span class="line">	注入的方法有三种</span><br><span class="line">		<span class="number">1.</span>使用构造函数提供</span><br><span class="line">			&lt;constructor-arg</span><br><span class="line">            type=<span class="string">&quot;java.lang.String&quot;</span></span><br><span class="line">            index=<span class="string">&quot;&quot;</span>  参数索引</span><br><span class="line">            name=<span class="string">&quot;&quot;</span>		参数名字</span><br><span class="line">            ref=<span class="string">&quot;&quot;</span>		引入外部的值，bean对象</span><br><span class="line">            value=<span class="string">&quot;&quot;</span>   基本类型和string&gt;</span><br><span class="line">            &lt;/constructor-arg&gt;</span><br><span class="line">            优势 获取bean对象时候，注入式必须的操作</span><br><span class="line">            弊端 改变了bean实例化的方式，用不到这些数据也必须提供</span><br><span class="line">		<span class="number">2.</span>使用set方法</span><br><span class="line">			 &lt;property name=&quot;&quot; value=&quot;&quot; ref=&quot;&quot;&gt;&lt;/property&gt;</span><br><span class="line">			 name = 指定注入的所调用deset方法名称</span><br><span class="line">			 常用</span><br><span class="line">			 优势：创建对象没有明确的限制，直接可以使用默认构造函数</span><br><span class="line">			 弊端：如果某个成员必须有值，则获取对象又可能set方法没有执行</span><br><span class="line">		<span class="number">3.</span>使用注解</span><br><span class="line">			用于创建对象的注解</span><br><span class="line">				<span class="meta">@component</span> 把当前对象存入spring容器中，不写默认id为当前类名，首字母小写</span><br><span class="line">				aop jar包，注解扫描配置 ：context</span><br><span class="line">				&lt;context :component-scan base-<span class="keyword">package</span>=<span class="string">&quot;com.it&quot;</span>&gt;</span><br><span class="line">				<span class="meta">@controller</span> 表现层</span><br><span class="line">				<span class="meta">@service</span>	业务层 </span><br><span class="line">				<span class="meta">@responsity</span>	 持久层			</span><br><span class="line">			用于注入数据的注解</span><br><span class="line">				Autowired:自动按照类型注入，只要和容器中匹配，那就匹配</span><br><span class="line">				类型匹配到变量匹配</span><br><span class="line">				Qualifier  按照类型的基础上，在按照名称注入，再给类成员注入不能单独使用，和上面的组合，				</span><br><span class="line">				Resoure  name用于指定bean的id，上面三个只能注入基本类型和String类型</span><br><span class="line">				Value 用于注入基本类型和String类型的数据</span><br><span class="line">						value用于指定数据的值，可以使用spring中的 el表达式  $&#123;value&#125;</span><br><span class="line">			用于改变作用范围的</span><br><span class="line">				Scope 指定bean的作用范围</span><br><span class="line">			和生命周期相关 的</span><br><span class="line">				preDestory  销毁方法</span><br><span class="line">				postconstruct  用于指定初始化方法 </span><br><span class="line">				</span><br><span class="line">				</span><br><span class="line">				Configration  指定当前类是一个配置类</span><br><span class="line">			带有 <span class="meta">@Configuration</span> 的注解类表示这个类可以使用 Spring IoC 容器作为 bean 定义的来源</span><br><span class="line">				</span><br><span class="line">				Componentscan 用于通过注解指定spring在创建容器时候要扫描的包</span><br><span class="line">				</span><br><span class="line">				bean注解</span><br><span class="line">				<span class="meta">@Bean</span> 注解告诉 Spring，一个带有 <span class="meta">@Bean</span> 的注解方法将返回一个对象，该对象应该被注册为在 Spring 应用程序上下文中的 bean。</span><br><span class="line">				</span><br><span class="line">				<span class="keyword">import</span>注解</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="3-3AOP’"><a href="#3-3AOP’" class="headerlink" title="3.3AOP’"></a>3.3AOP’</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">面向切面编程</span><br><span class="line">	将重复的代码提取出来，在需要执行的时候，利用动态代理技术，再不修改源码的基础上，对方法进行增强</span><br><span class="line">	优势</span><br><span class="line">		减少重复代码</span><br><span class="line">		提高开发效率</span><br><span class="line">		维护方便</span><br><span class="line">	使用动态代理的技术，通过配置的方式</span><br><span class="line">	</span><br><span class="line">	连接点</span><br><span class="line">		那些被拦截到的点，这些点指的是方法</span><br><span class="line">	切入点</span><br><span class="line">		指的是那些被增强的方法</span><br><span class="line">	通知</span><br><span class="line">		拦截到之后要干的事情</span><br><span class="line">        	通知的类型 </span><br><span class="line">        	前置通知 后置通知 异常通知 最终通知 环绕通知：整个</span><br><span class="line">    引介</span><br><span class="line">    target</span><br><span class="line">    	代理的目标对象</span><br><span class="line">    waving</span><br><span class="line">    	增强应用到目标对象来创建新的对象的过程</span><br><span class="line">    Proxy</span><br><span class="line">    		一个类被aop织入增强后，就产生一个结果代理类</span><br><span class="line">    aspect</span><br><span class="line">    	切面 切入点和通知，引介的结合</span><br><span class="line">    	</span><br><span class="line">    	</span><br><span class="line">    	开发阶段</span><br><span class="line">    		编写核心业务代码：熟悉业务需求</span><br><span class="line">    		公共代码抽取出来形成通知</span><br><span class="line">    		配置文件中，声明切入点和通知间的关系</span><br><span class="line">    	运行阶段</span><br><span class="line">    		框架监控切入点方法的执行，使用代理机制，</span><br></pre></td></tr></table></figure>

<h3 id="3-3-1初步配置"><a href="#3-3-1初步配置" class="headerlink" title="3.3.1初步配置"></a>3.3.1初步配置</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span><br><span class="line">&lt;beans xmlns=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span><br><span class="line">       xmlns:xsi=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="line">       xmlns:context=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span><br><span class="line">       xmlns:aop=<span class="string">&quot;http://www.springframework.org/schema/aop&quot;</span></span><br><span class="line">       xmlns:tx=<span class="string">&quot;http://www.springframework.org/schema/tx&quot;</span></span><br><span class="line">       xsi:schemaLocation=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span><br><span class="line"><span class="string">	http://www.springframework.org/schema/beans/spring-beans.xsd</span></span><br><span class="line"><span class="string">	http://www.springframework.org/schema/context</span></span><br><span class="line"><span class="string">	http://www.springframework.org/schema/context/spring-context.xsd</span></span><br><span class="line"><span class="string">	http://www.springframework.org/schema/aop</span></span><br><span class="line"><span class="string">	http://www.springframework.org/schema/aop/spring-aop.xsd</span></span><br><span class="line"><span class="string">	http://www.springframework.org/schema/tx</span></span><br><span class="line"><span class="string">	http://www.springframework.org/schema/tx/spring-tx.xsd&quot;</span>&gt;</span><br><span class="line">	</span><br><span class="line">	最全约束</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;!--aop配置</span><br><span class="line">        <span class="number">1.</span>把通知bean交给spring来管理</span><br><span class="line">        <span class="number">2.</span>配置aop</span><br><span class="line">        <span class="number">3.</span>配置切面</span><br><span class="line">            id 给切面提供一个唯一标识</span><br><span class="line">            ref 通知类bean的id</span><br><span class="line">        <span class="number">4.</span>aspect内部使用对应的标签配置通知类型</span><br><span class="line">            现在是让logger方法在切入点之前执行，前置通知</span><br><span class="line">            aop；before 前置通知</span><br><span class="line">                    method属性用于执行logger内中的方法</span><br><span class="line">                    pointcut 指定对那些方法进行增强</span><br><span class="line">                        execution(表达式)</span><br><span class="line">                            访问修饰符 返回值 包名 方法（参数列）</span><br><span class="line">                            execution(<span class="keyword">public</span> <span class="keyword">void</span> com.it.service.impl.IAccountServiceimpl.saveAccount())</span><br><span class="line">    --&gt;</span><br><span class="line">    &lt;!--配置logger--&gt;</span><br><span class="line">    &lt;bean id=&quot;logger&quot; class=&quot;com.it.uitls.Logger&quot;&gt;&lt;/bean&gt;</span><br><span class="line">    &lt;!--配置aop--&gt;</span><br><span class="line">    &lt;aop:config&gt;</span><br><span class="line">        &lt;aop:aspect id=<span class="string">&quot;logAdvice&quot;</span> ref=<span class="string">&quot;logger&quot;</span>&gt;</span><br><span class="line">            &lt;aop:before method=&quot;printLog&quot; pointcut=&quot;execution(public void com.it.service.impl.IAccountServiceimpl.saveAccount())&quot;&gt;&lt;/aop:before&gt;</span><br><span class="line">        &lt;/aop:aspect&gt;</span><br><span class="line">    &lt;/aop:config&gt;</span><br></pre></td></tr></table></figure>

<h3 id="3-3-2切入点表达式"><a href="#3-3-2切入点表达式" class="headerlink" title="3.3.2切入点表达式"></a>3.3.2切入点表达式</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">全通配符</span><br><span class="line">	访问修饰父可以省略 返回值可以使用通配符 包名可以使用通配符，几个包几个※</span><br><span class="line">	包名可以使用 ..表示当前包和子包 类名和方法名都可以使用统配</span><br><span class="line">	参数列表可以直接写数据类型，通配符表示任意类型</span><br><span class="line">	..表示任意类型，有无参数</span><br><span class="line">	* *..*.*</span><br><span class="line">	</span><br><span class="line">	实际开发</span><br><span class="line">		切到业务层是实现类下面的所有方法</span><br><span class="line">		* com.it.service.impl.*.*(..)</span><br><span class="line">		</span><br><span class="line">	四种通知方法</span><br><span class="line">		 &lt;aop:before method=&quot;printLog&quot; pointcut=&quot;execution(* com.it.service.impl.*.*(..)))&quot;&gt;&lt;/aop:before&gt;</span><br><span class="line">            &lt;aop:after method=&quot;afterLog&quot; pointcut=&quot;execution(* com.it.service.impl.*.*(..)))&quot;&gt;&lt;/aop:after&gt;</span><br><span class="line">            &lt;aop:after-returning method=&quot;lastLog&quot; pointcut=&quot;execution(* com.it.service.impl.*.*(..)))&quot;&gt;&lt;/aop:after-returning&gt;</span><br><span class="line">            &lt;aop:after-throwing method=&quot;excepLog&quot; pointcut=&quot;execution(* com.it.service.impl.*.*(..)))&quot;&gt;&lt;/aop:after-throwing&gt;</span><br><span class="line">            </span><br><span class="line">            简化标签</span><br><span class="line">            写在外面所有类可用</span><br><span class="line">   &lt;aop:pointcut id=<span class="string">&quot;pt&quot;</span> expression=<span class="string">&quot;execution(* com.it.service.impl.*.*(..)))&quot;</span>/&gt;</span><br><span class="line">               &lt;aop:before method=&quot;printLog&quot; pointcut-ref=&quot;pt&quot;&gt;&lt;/aop:before&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	</span><br></pre></td></tr></table></figure>

<h3 id="3-3-3环绕通知"><a href="#3-3-3环绕通知" class="headerlink" title="3.3.3环绕通知"></a>3.3.3环绕通知</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">  </span><br><span class="line">  环绕通知</span><br><span class="line">当配置了环绕通知，切入点方法没有执行，通知方法执行了</span><br><span class="line">ProceedJoinPonit接口，接口方法 proceed(),可以明确调用切入点方法</span><br><span class="line">环绕通知可以控制什么时候执行</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> Object <span class="title">aroundPrint</span><span class="params">(ProceedingJoinPoint pjp)</span></span>&#123;</span><br><span class="line">       Object rtvalue = <span class="keyword">null</span>;</span><br><span class="line">       <span class="keyword">try</span> &#123;</span><br><span class="line">           Object[] args = pjp.getArgs();</span><br><span class="line">           System.out.println(<span class="string">&quot;前置通知执行....&quot;</span>);</span><br><span class="line">           System.out.println(<span class="string">&quot;环绕通知执行....&quot;</span>);</span><br><span class="line">           rtvalue = pjp.proceed(args);</span><br><span class="line">           System.out.println(<span class="string">&quot;后置通知执行....&quot;</span>);</span><br><span class="line">           <span class="keyword">return</span> rtvalue;</span><br><span class="line">       &#125; <span class="keyword">catch</span> (Throwable throwable) &#123;</span><br><span class="line">           System.out.println(<span class="string">&quot;异常通知执行....&quot;</span>);</span><br><span class="line">           throwable.printStackTrace();</span><br><span class="line">       &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">           System.out.println(<span class="string">&quot;最终通知执行....&quot;</span>);</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">return</span> rtvalue;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="3-3-4注解aop"><a href="#3-3-4注解aop" class="headerlink" title="3.3.4注解aop"></a>3.3.4注解aop</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--配置spring容器要扫描的包--&gt;</span><br><span class="line">    &lt;context:component-scan base-package=&quot;com.it&quot;&gt;&lt;/context:component-scan&gt;</span><br><span class="line">    </span><br><span class="line">        &lt;aop:aspectj-autoproxy&gt;&lt;/aop:aspectj-autoproxy&gt;</span><br><span class="line">        </span><br><span class="line">     <span class="meta">@Component(&quot;logger&quot;)</span></span><br><span class="line">	<span class="meta">@Aspect</span></span><br><span class="line">	<span class="meta">@Before(&quot;execution(* com.it.service.impl.*.*(..))&quot;)</span></span><br><span class="line"></span><br><span class="line">	全局声明</span><br><span class="line">		 <span class="meta">@Pointcut(&quot;execution(* com.it.service.impl.*.*(..))&quot;)</span></span><br><span class="line">    		<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">pt1</span><span class="params">()</span></span>&#123;&#125;</span><br></pre></td></tr></table></figure>

<h2 id="3-4JDBCtemp事务"><a href="#3-4JDBCtemp事务" class="headerlink" title="3.4JDBCtemp事务"></a>3.4JDBCtemp事务</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">设置数据源</span><br><span class="line">	DriverManageDateSource ds = <span class="keyword">new</span> DriverManageDateSource();</span><br><span class="line">	ds.setDriverClassName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line">	ds.setUrl(<span class="string">&quot;jdbc:mysql://localhost:3306/数据库名&quot;</span>)</span><br><span class="line">	ds.setUsername(<span class="string">&quot;root&quot;</span>)</span><br><span class="line">	ds.setPassword(<span class="string">&quot;root&quot;</span>)</span><br><span class="line">	</span><br><span class="line">	创建jdbctemplate对象</span><br><span class="line">	JdbcTEmplate jt = <span class="keyword">new</span> JdbcTEmplate();</span><br><span class="line">	jt.setDateSouce(ds);</span><br><span class="line">	jt.execute(<span class="string">&quot;sql语句&quot;</span>)</span><br><span class="line">	</span><br><span class="line">	原始的jdbc</span><br><span class="line">	</span><br><span class="line">	结合spring配置</span><br><span class="line">	配置 在 bean.xml</span><br><span class="line">	&lt;bean id=<span class="string">&quot;jdbcTemplate&quot;</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;org.springframe.jdbc.core.Jdbctemplate&quot;</span>&gt;</span><br><span class="line">		&lt;property name=<span class="string">&quot;dataSource&quot;</span> ref=<span class="string">&quot;dataSource&quot;</span>&gt;&lt;property&gt;</span><br><span class="line">	&lt;/bean&gt;</span><br><span class="line">	&lt;bean id=<span class="string">&quot;datasource&quot;</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;rg.springframe.jdbc.datasource.DriverManagerDatesource&quot;</span>&gt;</span><br><span class="line">		 &lt;property name=<span class="string">&quot;driverClassName&quot;</span> value=<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>&gt;&lt;property&gt;</span><br><span class="line">		 &lt;property name=<span class="string">&quot;url&quot;</span> value=<span class="string">&quot;&quot;</span>&gt;&lt;property&gt;</span><br><span class="line">		 &lt;property name=<span class="string">&quot;username&quot;</span> value=<span class="string">&quot;&quot;</span>&gt;&lt;property&gt;</span><br><span class="line">		 &lt;property name=<span class="string">&quot;password&quot;</span> value=<span class="string">&quot;&quot;</span>&gt;&lt;property&gt;</span><br><span class="line">	&lt;/bean&gt;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	主执行函数</span><br><span class="line">		Application ac = <span class="keyword">new</span> ClasspathXmlApplicationContext(<span class="string">&quot;bean.xml&quot;</span>)</span><br><span class="line">		JdbcTemplate jt = ac.getbean(<span class="string">&quot;jdcetemplate&quot;</span>,JdbcTemplate.class)</span><br><span class="line">		jt.execute(<span class="string">&quot;sql&quot;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="3-5事务控制"><a href="#3-5事务控制" class="headerlink" title="3.5事务控制"></a>3.5事务控制</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">在aop</span><br><span class="line">&lt;aop:aspect&gt;里面	</span><br><span class="line">	前置	开启事务 </span><br><span class="line">	后置	提交事务</span><br><span class="line">    异常	回滚事务</span><br><span class="line">    最终	释放连接</span><br><span class="line">    </span><br><span class="line"> 上述 xml版本</span><br><span class="line"> spring自己封装的事务控制</span><br><span class="line"> txjar包</span><br><span class="line"> xml中声明式事务控制</span><br><span class="line"> 	<span class="number">1.</span>配置事务管理器</span><br><span class="line"> 	&lt;bean id=<span class="string">&quot;tansction&quot;</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;org.framework.jdbc.datasource.DateSourceTranscationManager&quot;</span>&gt;</span><br><span class="line"> 	&lt;property name=<span class="string">&quot;datasource&quot;</span> ref=<span class="string">&quot;datasource&quot;</span>&gt;</span><br><span class="line"> 	<span class="number">2.</span>配置事务的通知</span><br><span class="line"> 	&lt;tx:advice transaction-manager =<span class="string">&quot;transactionmanager&quot;</span> id=<span class="string">&quot;txadvice&quot;</span>&gt;</span><br><span class="line"> 	<span class="number">3.</span>配置通用切入点表达式aop</span><br><span class="line"> 		pt1</span><br><span class="line"> 	<span class="number">4.</span>建立事务通知和切入点的关系</span><br><span class="line"> 		&lt;aop:advise ref=“txadvice” point-cut=<span class="string">&quot;pt1&quot;</span>&gt;</span><br><span class="line"> 	<span class="number">5.</span>配置事务的属性</span><br><span class="line"> 		在tx:advice内</span><br><span class="line"> 		&lt;tx:attribute name=<span class="string">&quot;*&quot;</span>  除了查询</span><br><span class="line">        isolation=<span class="string">&quot;事务隔离级别&quot;</span></span><br><span class="line">        no-rollvack-<span class="keyword">for</span>=<span class="string">&quot;指定一个异常，产生异常事务回滚，产生其他异常不会滚&quot;</span> 默认值都回滚</span><br><span class="line">        propagation=<span class="string">&quot;事务传播&quot;</span></span><br><span class="line">        read-only=<span class="string">&quot;事务是否只读&quot;</span></span><br><span class="line">        rollback-<span class="keyword">for</span>=<span class="string">&quot;指定一个异常，产生异常事务不回滚，其他事务不会滚&quot;</span> 默认值回滚</span><br><span class="line">        timeout=<span class="string">&quot;事务超时时间&quot;</span> 默认值永不超市&gt;</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">     注解事务控制</span><br><span class="line">     	</span><br></pre></td></tr></table></figure>

<h1 id="4-springmvc"><a href="#4-springmvc" class="headerlink" title="4.springmvc"></a>4.springmvc</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">表现层  		业务层 			持久层 </span><br><span class="line">springmvc		spring			mybatis</span><br><span class="line"></span><br><span class="line">MVC模型	</span><br><span class="line">	model 模型  		javabean</span><br><span class="line">	view视图  		jsp</span><br><span class="line">	controller 控制器  servlet</span><br><span class="line">	</span><br><span class="line">	请求驱动的轻量级web层框架，通过一套注解，成为一个简单的类成为请求的控制器，不需要实现接口，同时还支持restful编程风格</span><br><span class="line">	核心控制器 servlet     			 	struts2 核心的  filter</span><br><span class="line">	基于方法设计 							基于类设计</span><br><span class="line">	JSTL效率高,简洁,jsr303 ajax方便		 OGNL表达式</span><br></pre></td></tr></table></figure>

<h2 id="4-1开始配置"><a href="#4-1开始配置" class="headerlink" title="4.1开始配置"></a>4.1开始配置</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line">    <span class="comment">//锁定版本</span></span><br><span class="line">    <span class="number">1.</span>配置pom.xml</span><br><span class="line">    &lt;spring.version&gt;5.0.2.RELEASE&lt;/spring.version&gt;</span><br><span class="line">    </span><br><span class="line">    &lt;dependencies&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">          &lt;groupId&gt;junit&lt;/groupId&gt;</span><br><span class="line">          &lt;artifactId&gt;junit&lt;/artifactId&gt;</span><br><span class="line">          &lt;version&gt;4.11&lt;/version&gt;</span><br><span class="line">          &lt;scope&gt;test&lt;/scope&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">          &lt;groupId&gt;org.springframework&lt;/groupId&gt;</span><br><span class="line">          &lt;artifactId&gt;spring-context&lt;/artifactId&gt;</span><br><span class="line">          &lt;version&gt;$&#123;spring.version&#125;&lt;/version&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">          &lt;groupId&gt;org.springframework&lt;/groupId&gt;</span><br><span class="line">          &lt;artifactId&gt;spring-web&lt;/artifactId&gt;</span><br><span class="line">          &lt;version&gt;$&#123;spring.version&#125;&lt;/version&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">          &lt;groupId&gt;org.springframework&lt;/groupId&gt;</span><br><span class="line">          &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt;</span><br><span class="line">          &lt;version&gt;$&#123;spring.version&#125;&lt;/version&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">          &lt;groupId&gt;javax.servlet&lt;/groupId&gt;</span><br><span class="line">          &lt;artifactId&gt;servlet-api&lt;/artifactId&gt;</span><br><span class="line">          &lt;version&gt;2.5&lt;/version&gt;</span><br><span class="line">          &lt;scope&gt;provided&lt;/scope&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">          &lt;groupId&gt;javax.servlet.jsp&lt;/groupId&gt;</span><br><span class="line">          &lt;artifactId&gt;jsp-api&lt;/artifactId&gt;</span><br><span class="line">          &lt;version&gt;2.0&lt;/version&gt;</span><br><span class="line">          &lt;scope&gt;provided&lt;/scope&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line">  &lt;/dependencies&gt;</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  	<span class="number">2.</span>配置web.xml</span><br><span class="line">  	&lt;!--配置控制器--&gt;</span><br><span class="line">  &lt;!--配置控制器--&gt;</span><br><span class="line">  &lt;servlet&gt;</span><br><span class="line">    &lt;servlet-name&gt;dispatcherServlet&lt;/servlet-name&gt;</span><br><span class="line">    &lt;servlet-<span class="class"><span class="keyword">class</span>&gt;<span class="title">org</span>.<span class="title">springframework</span>.<span class="title">web</span>.<span class="title">servlet</span>.<span class="title">DispatcherServlet</span>&lt;/<span class="title">servlet</span>-<span class="title">class</span>&gt;</span></span><br><span class="line"><span class="class">    &lt;<span class="title">init</span>-<span class="title">param</span>&gt;</span></span><br><span class="line"><span class="class">      &lt;!--初始化--&gt;</span></span><br><span class="line"><span class="class">      &lt;<span class="title">param</span>-<span class="title">name</span>&gt;<span class="title">contextConfigLocation</span>&lt;/<span class="title">param</span>-<span class="title">name</span>&gt;</span></span><br><span class="line">      &lt;param-value&gt;classpath:SpringMVC.xml&lt;/param-value&gt;</span><br><span class="line">    &lt;/init-param&gt;</span><br><span class="line">    &lt;!--启动服务器创建--&gt;</span><br><span class="line">    &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;</span><br><span class="line">  &lt;/servlet&gt;</span><br><span class="line">  &lt;servlet-mapping&gt;</span><br><span class="line">    &lt;servlet-name&gt;dispatcherServlet&lt;/servlet-name&gt;</span><br><span class="line">    &lt;url-pattern&gt;/&lt;/url-pattern&gt;</span><br><span class="line">  &lt;/servlet-mapping&gt;</span><br><span class="line">  </span><br><span class="line">  	<span class="number">3.</span>配置springmvc.xml</span><br><span class="line">  		&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span><br><span class="line">&lt;beans xmlns=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span><br><span class="line">       xmlns:xsi=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="line">       xmlns:context=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span><br><span class="line">       xmlns:mvc=<span class="string">&quot;http://www.springframework.org/schema/mvc&quot;</span></span><br><span class="line">       xsi:schemaLocation=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span><br><span class="line"><span class="string">    http://www.springframework.org/schema/beans/spring-beans.xsd</span></span><br><span class="line"><span class="string">    http://www.springframework.org/schema/context</span></span><br><span class="line"><span class="string">    http://www.springframework.org/schema/context/spring-context.xsd</span></span><br><span class="line"><span class="string">    http://www.springframework.org/schema/mvc</span></span><br><span class="line"><span class="string">    http://www.springframework.org/schema/mvc/spring-mvc.xsd&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!--开启注解扫描--&gt;</span><br><span class="line">    &lt;context:component-scan base-<span class="keyword">package</span>=<span class="string">&quot;com.it&quot;</span>/&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!--视图解析器--&gt;</span><br><span class="line">    &lt;bean id=<span class="string">&quot;internalResourceViewResolver&quot;</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;</span>&gt;</span><br><span class="line">        &lt;property name=&quot;prefix&quot; value=&quot;/WEB-INF/pages/&quot;&gt;&lt;/property&gt;</span><br><span class="line">        &lt;property name=&quot;suffix&quot; value=&quot;.jsp&quot;&gt;&lt;/property&gt;</span><br><span class="line">    &lt;/bean&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!--开启mvc框架注解支持--&gt;自动加载处理器映射器  处理器适配器</span><br><span class="line">    &lt;mvc:annotation-driven&gt;&lt;/mvc:annotation-driven&gt;</span><br><span class="line">&lt;/beans&gt;</span><br><span class="line">	</span><br><span class="line">	<span class="number">4.</span>写控制器</span><br><span class="line"></span><br><span class="line">                <span class="comment">//控制器</span></span><br><span class="line">        <span class="meta">@Controller</span></span><br><span class="line">        <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> </span>&#123;</span><br><span class="line">            <span class="meta">@RequestMapping(path = &quot;/hello&quot;)</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> String <span class="title">sayHello</span><span class="params">()</span></span>&#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;HelloMVC&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">  	<span class="number">5.</span>跳转</span><br><span class="line">  		&lt;a href=&quot;hello&quot;&gt;入门程序跳转&lt;/a&gt;</span><br><span class="line">  	<span class="number">6.</span>配置tomacat服务器</span><br><span class="line">  		记得把路径加到 deployment</span><br></pre></td></tr></table></figure>

<h2 id="4-2处理流程"><a href="#4-2处理流程" class="headerlink" title="4.2处理流程"></a>4.2处理流程</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>request</span><br><span class="line"><span class="number">2.</span>前端控制器  DispatcherServlet</span><br><span class="line"><span class="number">3.</span>处理器映射器  HaddlerMapping,返回一个执行链到前端控制器，返回执行方法</span><br><span class="line"><span class="number">4.</span>处理器适配器  HandlerAdapter 去执行 </span><br><span class="line"><span class="number">5.</span>执行  执行方法</span><br><span class="line"><span class="number">6.</span>返回一个Modelview到处理器适配器 到 前端控制器</span><br><span class="line"><span class="number">7.</span>视图解析器 返回view到前端控制器</span><br><span class="line"><span class="number">8.</span>前端控制器 找视图</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="4-3RequestMapping"><a href="#4-3RequestMapping" class="headerlink" title="4.3RequestMapping"></a>4.3RequestMapping</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">放在类上和方法上</span><br><span class="line">	分模块处理  user/    类上面写代表一个模块</span><br><span class="line">		下面 写  /submit    /login    方法上面写注解 requestmapping</span><br><span class="line">		</span><br><span class="line">	属性	path    和  value  都可以映射成功   value可以省略</span><br><span class="line">		method=&#123;RequestMethod.POst&#125;  枚举类  只能是 post请求</span><br><span class="line">        params 指定请求参数限制条件 </span><br><span class="line">        params=&#123;<span class="string">&quot;username&quot;</span>&#125;  必须有属性</span><br><span class="line">        headers:用于指定限制请求头  headers = &#123;<span class="string">&quot;Accept&quot;</span>&#125;  包含这个头</span><br></pre></td></tr></table></figure>

<h2 id="4-4请求参数的绑定"><a href="#4-4请求参数的绑定" class="headerlink" title="4.4请求参数的绑定"></a>4.4请求参数的绑定</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">sayHello</span><span class="params">(String username)</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;HelloMVC&quot;</span>);</span><br><span class="line">        System.out.println(username);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    接受请求参数</span><br><span class="line">    封装bean</span><br><span class="line">     <span class="function"><span class="keyword">public</span> String <span class="title">sayHello</span><span class="params">(Account account)</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;HelloMVC&quot;</span>);</span><br><span class="line">        System.out.println(account);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    封装多层对象</span><br><span class="line">    	&lt;a href=&quot;hello?username=hehe&amp;user.uname=ceshilei&amp;user.uword=111&quot;&gt;入门程序跳转&lt;/a&gt;</span><br><span class="line">    	<span class="keyword">private</span> User user;</span><br><span class="line">    	user类实现tostring方法 和setget方法</span><br><span class="line">    	</span><br><span class="line">    	</span><br><span class="line">    	post请求中文乱码</span><br><span class="line">    		过滤器拦截设置乱码</span><br><span class="line">    		  &lt;!--配置过滤器--&gt;</span><br><span class="line">              &lt;filter&gt;</span><br><span class="line">                &lt;filter-name&gt;characterEncodingFilter&lt;/filter-name&gt;</span><br><span class="line">                &lt;filter-<span class="class"><span class="keyword">class</span>&gt;<span class="title">org</span>.<span class="title">springframework</span>.<span class="title">web</span>.<span class="title">filter</span>.<span class="title">CharacterEncodingFilter</span>&lt;/<span class="title">filter</span>-<span class="title">class</span>&gt;</span></span><br><span class="line"><span class="class">                &lt;!--初始化拦截配置--&gt;</span></span><br><span class="line"><span class="class">                &lt;<span class="title">init</span>-<span class="title">param</span>&gt;</span></span><br><span class="line"><span class="class">                  &lt;<span class="title">param</span>-<span class="title">name</span>&gt;<span class="title">encoding</span>&lt;/<span class="title">param</span>-<span class="title">name</span>&gt;</span></span><br><span class="line"><span class="class">                  &lt;<span class="title">param</span>-<span class="title">value</span>&gt;<span class="title">UTF</span>-8&lt;/<span class="title">param</span>-<span class="title">value</span>&gt;</span></span><br><span class="line"><span class="class">                &lt;/<span class="title">init</span>-<span class="title">param</span>&gt;</span></span><br><span class="line"><span class="class">              &lt;/<span class="title">filter</span>&gt;</span></span><br><span class="line"><span class="class">              &lt;<span class="title">filter</span>-<span class="title">mapping</span>&gt;</span></span><br><span class="line"><span class="class">                &lt;<span class="title">filter</span>-<span class="title">name</span>&gt;<span class="title">characterEncodingFilter</span>&lt;/<span class="title">filter</span>-<span class="title">name</span>&gt;</span></span><br><span class="line"><span class="class">                &lt;<span class="title">url</span>-<span class="title">pattern</span>&gt;/*&lt;/<span class="title">url</span>-<span class="title">pattern</span>&gt;</span></span><br><span class="line"><span class="class">              &lt;/<span class="title">filter</span>-<span class="title">mapping</span>&gt;</span></span><br><span class="line"><span class="class">              </span></span><br><span class="line"><span class="class">              </span></span><br><span class="line"><span class="class">          集合对象处理</span></span><br><span class="line"><span class="class">          前端</span></span><br><span class="line"><span class="class">          	&lt;<span class="title">form</span> <span class="title">action</span></span>=<span class="string">&quot;hello&quot;</span> method=<span class="string">&quot;post&quot;</span>&gt;</span><br><span class="line">                姓名&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;username&quot;</span>&gt;&lt;br&gt;</span><br><span class="line">                密码&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;password&quot;</span>&gt;&lt;br&gt;</span><br><span class="line">                用户姓名&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;list[0].uname&quot;</span>&gt;&lt;br&gt;</span><br><span class="line">                用户密码&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;list[0].uword&quot;</span>&gt;&lt;br&gt;</span><br><span class="line">                用户<span class="number">2</span>姓名&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;map[0].uname&quot;</span>&gt;&lt;br&gt;</span><br><span class="line">                用户<span class="number">2</span>密码&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;map[0].uword&quot;</span>&gt;&lt;br&gt;</span><br><span class="line">                &lt;input type=<span class="string">&quot;submit&quot;</span>&gt;&lt;br&gt;</span><br><span class="line">            &lt;/form&gt;</span><br><span class="line">           后端</span><br><span class="line">           	    <span class="keyword">private</span> List&lt;User&gt; list;</span><br><span class="line">   				 <span class="keyword">private</span> Map&lt;String,User&gt; map;</span><br><span class="line">   				 生成getset方法 tostring方法</span><br><span class="line">   				 </span><br><span class="line">   			打印</span><br><span class="line">   				 	<span class="function"><span class="keyword">public</span> String <span class="title">sayHello</span><span class="params">(Account account)</span></span>&#123;</span><br><span class="line">                        System.out.println(<span class="string">&quot;HelloMVC&quot;</span>);</span><br><span class="line">                        System.out.println(account);</span><br><span class="line">                        <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">                    &#125;</span><br></pre></td></tr></table></figure>

<h2 id="4-5自定义类型转化器"><a href="#4-5自定义类型转化器" class="headerlink" title="4.5自定义类型转化器"></a>4.5自定义类型转化器</h2><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">mvc框架内部自动进行 数据转化 所以  String-&gt;&gt;Interger</span><br><span class="line"></span><br><span class="line">例如 日期  <span class="number">2002</span>/<span class="number">11</span>/<span class="number">11</span>可以自动转化为日期</span><br><span class="line">			<span class="number">2002</span>-<span class="number">11</span>-<span class="number">11</span> 不能自动转化</span><br><span class="line"><span class="number">1.</span>定义一个类，实现converter接口，该接口有两个泛型 第一个泛型写你要转的类，第二个泛型写要转化到的类</span><br><span class="line">	<span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StringToDate</span> <span class="keyword">implements</span> <span class="title">Converter</span>&lt;<span class="title">String</span>, <span class="title">Date</span>&gt; </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="comment">/*s指的是传进来的代码*/</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Date <span class="title">convert</span><span class="params">(String s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(s == <span class="keyword">null</span>)&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">&quot;请你传入参数&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        DateFormat df = <span class="keyword">new</span> SimpleDateFormat(<span class="string">&quot;yyyy-MM-dd&quot;</span>);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> df.parse(s);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">&quot;数据类型转化出错&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="number">2.</span>配置自定义类型转化器</span><br><span class="line">	&lt;!--开启mvc框架注解支持--&gt;</span><br><span class="line">    &lt;mvc:annotation-driven conversion-service=&quot;conversionService&quot;&gt;&lt;/mvc:annotation-driven&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!--配置自定义转化器--&gt;</span><br><span class="line">    &lt;bean id=<span class="string">&quot;conversionService&quot;</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;org.springframework.context.support.ConversionServiceFactoryBean&quot;</span>&gt;</span><br><span class="line">        &lt;property name=<span class="string">&quot;converters&quot;</span>&gt;</span><br><span class="line">            &lt;set&gt;</span><br><span class="line">                &lt;bean class=&quot;com.it.utils.StringToDate&quot;&gt;&lt;/bean&gt;</span><br><span class="line">            &lt;/set&gt;</span><br><span class="line">        &lt;/property&gt;</span><br><span class="line">    &lt;/bean&gt;</span><br></pre></td></tr></table></figure>

<h2 id="4-6在控制器中拿到servlet-Api"><a href="#4-6在控制器中拿到servlet-Api" class="headerlink" title="4.6在控制器中拿到servlet Api"></a>4.6在控制器中拿到servlet Api</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">直接在请求的方法里面加  HttpServletRequest req, HttpServletReSponse res</span><br><span class="line">		HttpSession session = req.getsession();</span><br><span class="line">		session.getServletContext(); 获取域对象</span><br></pre></td></tr></table></figure>

<h2 id="4-7常用注解"><a href="#4-7常用注解" class="headerlink" title="4.7常用注解"></a>4.7常用注解</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">RequestParam</span><br><span class="line">		把请求中指定名称的参数给控制器中的形参赋值  用来指定名称对不上时候来赋值</span><br><span class="line">		比如  请求 key为  name  接受为 username</span><br><span class="line">		在请求控制器的参数 前面 写 <span class="meta">@RequestParam(name=&quot;name&quot;)</span> String username</span><br><span class="line">RequsetBody</span><br><span class="line">		用于获取请求体的内容，get请求方式不适用，get没有请求体，后面处理json有用</span><br><span class="line">		在请求控制器的参数 前面 写 (<span class="meta">@RequestBody</span> String body)</span><br><span class="line">PathVarible</span><br><span class="line">		用于绑定url中的占位符  /delete/&#123;id&#125;  支持restful 风格</span><br><span class="line">			restful风格好处</span><br><span class="line">					请求地址一样，根据请求方式执行不同的函数  /user</span><br><span class="line">					请求方式和地址一样  /user/<span class="number">10</span>   /user/&#123;id&#125;</span><br><span class="line">					很容易缓存</span><br><span class="line">					</span><br><span class="line">			<span class="meta">@PathVarible</span> String body</span><br><span class="line">HiddenHttpMethodFilter</span><br><span class="line">		过滤器  也是 restful风格的</span><br><span class="line">RequestHeader</span><br><span class="line">		用于获取请求消息的值 (<span class="meta">@RequestHeader(value=&quot;Accept&quot;)</span> String body)</span><br><span class="line">CookieValue</span><br><span class="line">		获取cookie的值(value=<span class="string">&quot;SessionId&quot;</span> String cookievalue)</span><br><span class="line">ModelAttribute</span><br><span class="line">		出现在方法上面，表示当前方法会在控制器的方法执行之前执行它</span><br><span class="line">		出现在参数上面，获取指定的数据给参数赋值</span><br><span class="line">		带返回值</span><br><span class="line">			控制器执行方法会拿到你方法的返回值</span><br><span class="line">		不带返回值</span><br><span class="line">			参数传Map&lt;String,User&gt; map</span><br><span class="line">			数据存到map集合当中，</span><br><span class="line">			在控制器方法参数中加 <span class="meta">@ModelAttribute(&quot;abc&quot;)</span></span><br><span class="line">		应用场景</span><br><span class="line">			提交表单有三个值，但是你只提交两个值，我们为剩下一个值赋值</span><br><span class="line">SessionAttributes</span><br><span class="line">		作用在类上面</span><br><span class="line">		<span class="meta">@SessionAttributes(value=&quot;msg&quot;)</span></span><br><span class="line">		<span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">method</span></span>&#123;</span><br><span class="line">            </span><br><span class="line">		&#125;</span><br><span class="line">		多次执行控制器方法之间的参数共享</span><br><span class="line">		<span class="function"><span class="keyword">public</span> String <span class="title">aabb</span><span class="params">(Model model)</span></span>&#123;</span><br><span class="line">            model.setAttribute(<span class="string">&quot;msg&quot;</span>,<span class="string">&quot;meimei&quot;</span>);</span><br><span class="line">            存到了  requset域对象</span><br><span class="line">		&#125;</span><br><span class="line">		获取  model.get(<span class="string">&quot;msg&quot;</span>)</span><br><span class="line">		删除</span><br><span class="line">		<span class="function"><span class="keyword">public</span> String <span class="title">del</span><span class="params">(SessionStatus status)</span></span>&#123;</span><br><span class="line">            status.setComplete()</span><br><span class="line">		&#125;</span><br></pre></td></tr></table></figure>

<h2 id="4-8创建项目"><a href="#4-8创建项目" class="headerlink" title="4.8创建项目"></a>4.8创建项目</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">archetypeCatalog=internal  加上不然是一个空项目</span><br></pre></td></tr></table></figure>

<h2 id="4-9相应数据"><a href="#4-9相应数据" class="headerlink" title="4.9相应数据"></a>4.9相应数据</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">testString</span><span class="params">(Model model)</span></span>&#123;</span><br><span class="line">        User user = <span class="keyword">new</span> User();</span><br><span class="line">        user.setUsername(<span class="string">&quot;妹妹&quot;</span>);</span><br><span class="line">        user.setAge(<span class="number">18</span>);</span><br><span class="line">        user.setPassword(<span class="string">&quot;123&quot;</span>);</span><br><span class="line">        model.addAttribute(<span class="string">&quot;user&quot;</span>,user);</span><br><span class="line">        System.out.println(<span class="string">&quot;执行了&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">   <span class="comment">//请求转发</span></span><br><span class="line">        request.getRequestDispather(<span class="string">&quot;/WEB-INfo/pages/success.jsp请求路劲&quot;</span>).forward(request.response)</span><br><span class="line">   <span class="comment">//没有返回值  默认值请求路径 url.jsp</span></span><br><span class="line">   </span><br><span class="line">返回值是MODelANDView对象</span><br><span class="line">	对象调整具体的jsp视图</span><br><span class="line">		 ModelAndView mv = <span class="keyword">new</span> ModelAndView();</span><br><span class="line">        <span class="comment">//添加数据</span></span><br><span class="line">        mv.addObject(<span class="string">&quot;user&quot;</span>,user);</span><br><span class="line">        <span class="comment">//设置跳转的页面</span></span><br><span class="line">        mv.setViewName(<span class="string">&quot;success&quot;</span>);</span><br><span class="line">    <span class="comment">//请求转发，不使用视图解析器</span></span><br><span class="line">    	<span class="keyword">return</span> <span class="string">&quot;forward:/WEB-INF/pages/success.jsp&quot;</span></span><br><span class="line">    	重定向<span class="comment">//不适用视图解析器</span></span><br><span class="line">    	<span class="keyword">return</span> <span class="string">&quot;redirect:/index.jsp&quot;</span></span><br></pre></td></tr></table></figure>

<h2 id="4-10响应-JSON数据"><a href="#4-10响应-JSON数据" class="headerlink" title="4.10响应 JSON数据"></a>4.10响应 JSON数据</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">ResponseBody响应数据</span><br><span class="line">	<span class="number">1.</span>搭建异步</span><br><span class="line">	<span class="number">2.</span>静态资源不拦截</span><br><span class="line">		 &lt;!--告诉不拦截静态资源--&gt;</span><br><span class="line">    &lt;mvc:<span class="keyword">default</span>-servlet-handler/&gt;</span><br><span class="line">    <span class="number">3.</span>发送请求</span><br><span class="line">    	$.ajax(&#123;</span><br><span class="line">                url: <span class="string">&#x27;user/test&#x27;</span>,</span><br><span class="line">                contentType: <span class="string">&#x27;application/json;charset=UTF-8&#x27;</span>,</span><br><span class="line">                data: <span class="string">&#x27;&#123;&quot;username&quot;:&quot;张三&quot;,&quot;password&quot;:&quot;123456&quot;,&quot;age&quot;:30&#125;&#x27;</span>,</span><br><span class="line">                dataType: <span class="string">&#x27;json&#x27;</span>,</span><br><span class="line">                type: <span class="string">&#x27;post&#x27;</span>,</span><br><span class="line">                success:(data)=&gt;&#123;</span><br><span class="line">                    alert(data);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">     <span class="number">3.</span>导入jackson 坐标</span><br><span class="line">                    &lt;dependency&gt;</span><br><span class="line">                  &lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt;</span><br><span class="line">                  &lt;artifactId&gt;jackson-core&lt;/artifactId&gt;</span><br><span class="line">                  &lt;version&gt;2.9.0&lt;/version&gt;</span><br><span class="line">                &lt;/dependency&gt;</span><br><span class="line">                &lt;dependency&gt;</span><br><span class="line">                  &lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt;</span><br><span class="line">                  &lt;artifactId&gt;jackson-annotations&lt;/artifactId&gt;</span><br><span class="line">                  &lt;version&gt;2.9.0&lt;/version&gt;</span><br><span class="line">                &lt;/dependency&gt;</span><br><span class="line">                &lt;dependency&gt;</span><br><span class="line">                  &lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt;</span><br><span class="line">                  &lt;artifactId&gt;jackson-databind&lt;/artifactId&gt;</span><br><span class="line">                  &lt;version&gt;2.9.0&lt;/version&gt;</span><br><span class="line">                &lt;/dependency&gt;</span><br><span class="line">     <span class="number">4.</span>接受并且存入javabean</span><br><span class="line">     		springmvc自动封装到集合里面</span><br><span class="line">     		<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testString</span><span class="params">(<span class="meta">@RequestBody</span> User user)</span></span>&#123;</span><br><span class="line">             </span><br><span class="line">                System.out.println(<span class="string">&quot;ajax执行了&quot;</span>);</span><br><span class="line">                System.out.println(user);</span><br><span class="line">            &#125;</span><br><span class="line">     <span class="number">5.</span>响应数据</span><br><span class="line">              <span class="keyword">public</span> <span class="meta">@ResponseBody</span> <span class="function">User <span class="title">testString</span><span class="params">(<span class="meta">@RequestBody</span> User user)</span></span>&#123;</span><br><span class="line">                <span class="comment">//响应数据</span></span><br><span class="line">                System.out.println(<span class="string">&quot;ajax执行了&quot;</span>);</span><br><span class="line">                user.setUsername(<span class="string">&quot;hahha&quot;</span>);</span><br><span class="line">                user.setAge(<span class="number">40</span>);</span><br><span class="line">                <span class="keyword">return</span> user;</span><br><span class="line">            &#125;</span><br></pre></td></tr></table></figure>

<h2 id="4-11文件上传"><a href="#4-11文件上传" class="headerlink" title="4.11文件上传"></a>4.11文件上传</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">第三方组件  jar包</span><br><span class="line">	<span class="number">1.</span>导入jar包</span><br><span class="line">		commons-fileupload</span><br><span class="line">		commons-io</span><br><span class="line">	<span class="number">2.</span>&lt;input type=<span class="string">&quot;file&quot;</span> name=<span class="string">&quot;upload&quot;</span>&gt;&lt;br&gt;</span><br><span class="line">		注意名称必须和方法参数相同</span><br><span class="line">	<span class="number">3.</span>配置文件解析器</span><br><span class="line">	<span class="number">4.</span>具体流程</span><br><span class="line">		 <span class="function"><span class="keyword">public</span> String <span class="title">testString</span><span class="params">(HttpServletRequest request, MultipartFile upload)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;开始上传&quot;</span>);</span><br><span class="line">        <span class="comment">/*配置上传路径*/</span></span><br><span class="line">        String path = request.getSession().getServletContext().getRealPath(<span class="string">&quot;/upload/&quot;</span>);</span><br><span class="line">        <span class="comment">//判断路径是否存在</span></span><br><span class="line">        File file = <span class="keyword">new</span> File(path);</span><br><span class="line">        <span class="keyword">if</span> (!file.exists())&#123;</span><br><span class="line">            file.mkdirs();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//说明上传文件项</span></span><br><span class="line">        String filename = upload.getOriginalFilename();</span><br><span class="line">        String uuid = UUID.randomUUID().toString().replace(<span class="string">&quot;-&quot;</span>,<span class="string">&quot;&quot;</span>);</span><br><span class="line">        filename = uuid + <span class="string">&quot;_&quot;</span> +filename;</span><br><span class="line">        <span class="comment">//完成</span></span><br><span class="line">        upload.transferTo(<span class="keyword">new</span> File(path,filename));</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;success&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="number">5.</span>上传成功</span><br><span class="line">    	D:\server\apache-tomcat-<span class="number">8.5</span><span class="number">.53</span>\webapps\ROOT\upload</span><br></pre></td></tr></table></figure>

<h2 id="4-12跨服务器上传"><a href="#4-12跨服务器上传" class="headerlink" title="4.12跨服务器上传"></a>4.12跨服务器上传</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>应用服务器  负责部署应用</span><br><span class="line"><span class="number">2.</span>数据库服务器 运行数据库</span><br><span class="line"><span class="number">3.</span>缓存和消息服务器 负责处理大并发访问的缓存和消息</span><br><span class="line"><span class="number">4.</span>文件服务器 负责存储用户上传文件的服务器</span><br><span class="line"></span><br><span class="line">	流程	</span><br><span class="line">			<span class="number">1.</span>jar包  sun公司</span><br><span class="line">					com.sun.jersey</span><br><span class="line">					jersey-core</span><br><span class="line">					<span class="number">1.18</span><span class="number">.1</span></span><br><span class="line">					com.sun.jersy</span><br><span class="line">					jersey-client</span><br><span class="line">					<span class="number">1.18</span><span class="number">.1</span></span><br><span class="line">			<span class="number">2.</span>准备一个图片服务器</span><br><span class="line">				端口设置 uploads文件夹</span><br><span class="line">			<span class="number">3.</span></span><br><span class="line">			System.out.println(<span class="string">&quot;开始上传&quot;</span>);</span><br><span class="line">        <span class="comment">/*定义服务器上传路径*/</span></span><br><span class="line">      	String path = <span class="string">&quot;http://localhost:9090/uploads&quot;</span></span><br><span class="line">        <span class="comment">//说明上传文件项</span></span><br><span class="line">        String filename = upload.getOriginalFilename();</span><br><span class="line">        String uuid = UUID.randomUUID().toString().replace(<span class="string">&quot;-&quot;</span>,<span class="string">&quot;&quot;</span>);</span><br><span class="line">        filename = uuid + <span class="string">&quot;_&quot;</span> +filename;</span><br><span class="line">        <span class="comment">//完成</span></span><br><span class="line">       <span class="comment">// 1.创建客户端对象</span></span><br><span class="line">        Client cl = Client.create();</span><br><span class="line">        <span class="comment">//2.连接图片服务器</span></span><br><span class="line">        WebReSourec webresource = cl.resource(path+filename );</span><br><span class="line">        webresource.put(upload.getBytes())</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h2 id="4-13异常处理"><a href="#4-13异常处理" class="headerlink" title="4.13异常处理"></a>4.13异常处理</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">MVC处理异常  </span><br><span class="line">		浏览器---&gt;前端控制器---&gt;web --&gt; service --&gt; dao</span><br><span class="line">		后面有异常 往上抛</span><br><span class="line">		</span><br><span class="line">		异常组件处理器 导入jar包</span><br><span class="line">		<span class="number">2.</span>编写自定义异常类</span><br><span class="line">              <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EXP</span> <span class="keyword">extends</span> <span class="title">Exception</span> </span>&#123;</span><br><span class="line">                    <span class="comment">//存储提示信息</span></span><br><span class="line">                    <span class="keyword">private</span> String message;</span><br><span class="line"></span><br><span class="line">                    <span class="function"><span class="keyword">public</span> <span class="title">EXP</span><span class="params">(String message)</span> </span>&#123;</span><br><span class="line">                        <span class="keyword">this</span>.message = message;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="meta">@Override</span></span><br><span class="line">                    <span class="function"><span class="keyword">public</span> String <span class="title">getMessage</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                        <span class="keyword">return</span> message;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMessage</span><span class="params">(String message)</span> </span>&#123;</span><br><span class="line">                        <span class="keyword">this</span>.message = message;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                    <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="keyword">int</span> a =<span class="number">10</span> / <span class="number">0</span>;</span><br><span class="line">                &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                    <span class="comment">//向上抛出自定义异常</span></span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> EXP(<span class="string">&quot;查询用户异常&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">		<span class="number">2.</span>编写异常处理器</span><br><span class="line">			<span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">excepresolve</span> <span class="keyword">implements</span> <span class="title">HandlerExceptionResolver</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">resolveException</span><span class="params">(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse, Object o, Exception e)</span> </span>&#123;</span><br><span class="line">               <span class="comment">//获取异常对象</span></span><br><span class="line">                EXP ee = <span class="keyword">null</span>;</span><br><span class="line">                <span class="keyword">if</span>(ee <span class="keyword">instanceof</span> EXP)&#123;</span><br><span class="line">                    ee = (EXP)e;</span><br><span class="line">                &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                    ee = <span class="keyword">new</span> EXP(<span class="string">&quot;系统正在维护&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">//ModelAndView对象</span></span><br><span class="line">                ModelAndView mv = <span class="keyword">new</span> ModelAndView();</span><br><span class="line">                mv.addObject(<span class="string">&quot;errormsg&quot;</span>,e.getMessage());</span><br><span class="line">                mv.setViewName(<span class="string">&quot;error&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">		<span class="number">3.</span>配置异常处理器</span><br><span class="line">			&lt;bean id=<span class="string">&quot;exp&quot;</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;com.it.exception.EXP&quot;</span>&gt;</span><br><span class="line">    		&lt;/bean&gt;</span><br><span class="line">		</span><br><span class="line">		</span><br></pre></td></tr></table></figure>

<h2 id="4-14拦截器"><a href="#4-14拦截器" class="headerlink" title="4.14拦截器"></a>4.14拦截器</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">类似于之前过滤器</span><br><span class="line">		对处理器进行预处理和后处理</span><br><span class="line">		<span class="number">1.</span>编写拦截器类  实现HandlerIntercepter接口</span><br><span class="line">			导入方法</span><br><span class="line">				prehandle</span><br><span class="line">		<span class="number">2.</span>配置拦截器</span><br><span class="line">		&lt;mvc:interceptors&gt;</span><br><span class="line">			&lt;mvc:interceptor&gt;</span><br><span class="line">				你要拦截的方法<span class="comment">//</span></span><br><span class="line">				&lt;mvc:mapping path=“/”&gt;</span><br><span class="line">				<span class="comment">//不要拦截的方法</span></span><br><span class="line">				&lt;mvc:exclude-mapping path=<span class="string">&quot;&quot;</span>&gt;</span><br><span class="line">				<span class="comment">//配置拦截器对象</span></span><br><span class="line">				&lt;bean <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;&quot;</span>&gt;</span><br></pre></td></tr></table></figure>

<h1 id="5-SSM框架整合"><a href="#5-SSM框架整合" class="headerlink" title="5.SSM框架整合"></a>5.SSM框架整合</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><span class="line">配置文件  加注解的方式</span><br><span class="line">		坐标</span><br><span class="line">			  &lt;dependencies&gt;</span><br><span class="line">    &lt;dependency&gt;</span><br><span class="line">      &lt;groupId&gt;junit&lt;/groupId&gt;</span><br><span class="line">      &lt;artifactId&gt;junit&lt;/artifactId&gt;</span><br><span class="line">      &lt;version&gt;4.11&lt;/version&gt;</span><br><span class="line">      &lt;scope&gt;test&lt;/scope&gt;</span><br><span class="line">    &lt;/dependency&gt;</span><br><span class="line">    &lt;!--springMvc--&gt;</span><br><span class="line">    &lt;dependency&gt;</span><br><span class="line">      &lt;groupId&gt;org.springframework&lt;/groupId&gt;</span><br><span class="line">      &lt;artifactId&gt;spring-context&lt;/artifactId&gt;</span><br><span class="line">      &lt;version&gt;$&#123;spring.version&#125;&lt;/version&gt;</span><br><span class="line">    &lt;/dependency&gt;</span><br><span class="line">    &lt;dependency&gt;</span><br><span class="line">      &lt;groupId&gt;org.springframework&lt;/groupId&gt;</span><br><span class="line">      &lt;artifactId&gt;spring-web&lt;/artifactId&gt;</span><br><span class="line">      &lt;version&gt;$&#123;spring.version&#125;&lt;/version&gt;</span><br><span class="line">    &lt;/dependency&gt;</span><br><span class="line">    &lt;dependency&gt;</span><br><span class="line">      &lt;groupId&gt;org.springframework&lt;/groupId&gt;</span><br><span class="line">      &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt;</span><br><span class="line">      &lt;version&gt;$&#123;spring.version&#125;&lt;/version&gt;</span><br><span class="line">    &lt;/dependency&gt;</span><br><span class="line">    &lt;dependency&gt;</span><br><span class="line">      &lt;groupId&gt;javax.servlet&lt;/groupId&gt;</span><br><span class="line">      &lt;artifactId&gt;servlet-api&lt;/artifactId&gt;</span><br><span class="line">      &lt;version&gt;2.5&lt;/version&gt;</span><br><span class="line">      &lt;scope&gt;provided&lt;/scope&gt;</span><br><span class="line">    &lt;/dependency&gt;</span><br><span class="line">    &lt;dependency&gt;</span><br><span class="line">      &lt;groupId&gt;javax.servlet.jsp&lt;/groupId&gt;</span><br><span class="line">      &lt;artifactId&gt;jsp-api&lt;/artifactId&gt;</span><br><span class="line">      &lt;version&gt;2.0&lt;/version&gt;</span><br><span class="line">      &lt;scope&gt;provided&lt;/scope&gt;</span><br><span class="line">    &lt;/dependency&gt;</span><br><span class="line">    &lt;!--mybatis--&gt;</span><br><span class="line">    &lt;dependency&gt;</span><br><span class="line">      &lt;groupId&gt;org.mybatis&lt;/groupId&gt;</span><br><span class="line">      &lt;artifactId&gt;mybatis&lt;/artifactId&gt;</span><br><span class="line">      &lt;version&gt;3.4.5&lt;/version&gt;</span><br><span class="line">    &lt;/dependency&gt;</span><br><span class="line">    &lt;dependency&gt;</span><br><span class="line">      &lt;groupId&gt;org.mybatis&lt;/groupId&gt;</span><br><span class="line">      &lt;artifactId&gt;mybatis-spring&lt;/artifactId&gt;</span><br><span class="line">      &lt;version&gt;1.3.0&lt;/version&gt;</span><br><span class="line">    &lt;/dependency&gt;</span><br><span class="line">    &lt;dependency&gt;</span><br><span class="line">      &lt;groupId&gt;c3p0&lt;/groupId&gt;</span><br><span class="line">      &lt;artifactId&gt;c3p0&lt;/artifactId&gt;</span><br><span class="line">      &lt;version&gt;0.9.1.2&lt;/version&gt;</span><br><span class="line">      &lt;scope&gt;compile&lt;/scope&gt;</span><br><span class="line">    &lt;/dependency&gt;</span><br><span class="line">    &lt;dependency&gt;</span><br><span class="line">      &lt;groupId&gt;mysql&lt;/groupId&gt;</span><br><span class="line">      &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;</span><br><span class="line">      &lt;version&gt;5.1.6&lt;/version&gt;</span><br><span class="line">    &lt;/dependency&gt;</span><br><span class="line">    &lt;dependency&gt;</span><br><span class="line">      &lt;groupId&gt;log4j&lt;/groupId&gt;</span><br><span class="line">      &lt;artifactId&gt;log4j&lt;/artifactId&gt;</span><br><span class="line">      &lt;version&gt;1.2.12&lt;/version&gt;</span><br><span class="line">    &lt;/dependency&gt;</span><br><span class="line">    &lt;!--spring--&gt;</span><br><span class="line">    &lt;dependency&gt;</span><br><span class="line">      &lt;groupId&gt;org.springframework&lt;/groupId&gt;</span><br><span class="line">      &lt;artifactId&gt;spring-context&lt;/artifactId&gt;</span><br><span class="line">      &lt;version&gt;$&#123;spring.version&#125;&lt;/version&gt;</span><br><span class="line">    &lt;/dependency&gt;</span><br><span class="line">    &lt;dependency&gt;</span><br><span class="line">      &lt;groupId&gt;org.springframework&lt;/groupId&gt;</span><br><span class="line">      &lt;artifactId&gt;spring-aop&lt;/artifactId&gt;</span><br><span class="line">      &lt;version&gt;$&#123;spring.version&#125;&lt;/version&gt;</span><br><span class="line">    &lt;/dependency&gt;</span><br><span class="line">    &lt;dependency&gt;</span><br><span class="line">      &lt;groupId&gt;org.springframework&lt;/groupId&gt;</span><br><span class="line">      &lt;artifactId&gt;spring-web&lt;/artifactId&gt;</span><br><span class="line">      &lt;version&gt;$&#123;spring.version&#125;&lt;/version&gt;</span><br><span class="line">    &lt;/dependency&gt;</span><br><span class="line">    &lt;dependency&gt;</span><br><span class="line">      &lt;groupId&gt;org.springframework&lt;/groupId&gt;</span><br><span class="line">      &lt;artifactId&gt;spring-test&lt;/artifactId&gt;</span><br><span class="line">      &lt;version&gt;$&#123;spring.version&#125;&lt;/version&gt;</span><br><span class="line">    &lt;/dependency&gt;</span><br><span class="line">    &lt;dependency&gt;</span><br><span class="line">      &lt;groupId&gt;org.springframework&lt;/groupId&gt;</span><br><span class="line">      &lt;artifactId&gt;spring-tx&lt;/artifactId&gt;</span><br><span class="line">      &lt;version&gt;$&#123;spring.version&#125;&lt;/version&gt;</span><br><span class="line">    &lt;/dependency&gt;</span><br><span class="line">    &lt;dependency&gt;</span><br><span class="line">      &lt;groupId&gt;org.springframework&lt;/groupId&gt;</span><br><span class="line">      &lt;artifactId&gt;spring-jdbc&lt;/artifactId&gt;</span><br><span class="line">      &lt;version&gt;$&#123;spring.version&#125;&lt;/version&gt;</span><br><span class="line">    &lt;/dependency&gt;</span><br><span class="line">    &lt;dependency&gt;</span><br><span class="line">      &lt;groupId&gt;org.springframework&lt;/groupId&gt;</span><br><span class="line">      &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt;</span><br><span class="line">      &lt;version&gt;$&#123;spring.version&#125;&lt;/version&gt;</span><br><span class="line">    &lt;/dependency&gt;</span><br><span class="line">    &lt;dependency&gt;</span><br><span class="line">      &lt;groupId&gt;javax.servlet&lt;/groupId&gt;</span><br><span class="line">      &lt;artifactId&gt;servlet-api&lt;/artifactId&gt;</span><br><span class="line">      &lt;version&gt;2.5&lt;/version&gt;</span><br><span class="line">      &lt;scope&gt;provided&lt;/scope&gt;</span><br><span class="line">    &lt;/dependency&gt;</span><br><span class="line">    &lt;dependency&gt;</span><br><span class="line">      &lt;groupId&gt;javax.servlet.jsp&lt;/groupId&gt;</span><br><span class="line">      &lt;artifactId&gt;jsp-api&lt;/artifactId&gt;</span><br><span class="line">      &lt;version&gt;2.0&lt;/version&gt;</span><br><span class="line">      &lt;scope&gt;provided&lt;/scope&gt;</span><br><span class="line">    &lt;/dependency&gt;</span><br><span class="line">    &lt;dependency&gt;</span><br><span class="line">      &lt;groupId&gt;jstl&lt;/groupId&gt;</span><br><span class="line">      &lt;artifactId&gt;jstl&lt;/artifactId&gt;</span><br><span class="line">      &lt;version&gt;1.2&lt;/version&gt;</span><br><span class="line">      &lt;scope&gt;provided&lt;/scope&gt;</span><br><span class="line">    &lt;/dependency&gt;</span><br><span class="line">  &lt;/dependencies&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="5-1-搭建spring"><a href="#5-1-搭建spring" class="headerlink" title="5.1.搭建spring"></a>5.1.搭建spring</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>xml</span><br><span class="line">	&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span><br><span class="line">    &lt;beans xmlns=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span><br><span class="line">           xmlns:xsi=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="line">           xmlns:context=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span><br><span class="line">           xmlns:aop=<span class="string">&quot;http://www.springframework.org/schema/aop&quot;</span></span><br><span class="line">           xmlns:tx=<span class="string">&quot;http://www.springframework.org/schema/tx&quot;</span></span><br><span class="line">           xsi:schemaLocation=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span><br><span class="line"><span class="string">        http://www.springframework.org/schema/beans/spring-beans.xsd</span></span><br><span class="line"><span class="string">        http://www.springframework.org/schema/context</span></span><br><span class="line"><span class="string">        http://www.springframework.org/schema/context/spring-context.xsd</span></span><br><span class="line"><span class="string">        http://www.springframework.org/schema/aop</span></span><br><span class="line"><span class="string">        http://www.springframework.org/schema/aop/spring-aop.xsd</span></span><br><span class="line"><span class="string">        http://www.springframework.org/schema/tx</span></span><br><span class="line"><span class="string">        http://www.springframework.org/schema/tx/spring-tx.xsd&quot;</span>&gt;</span><br><span class="line">        &lt;!--开启注解扫描  只希望处理 dao和service--&gt;</span><br><span class="line">        &lt;context:component-scan base-<span class="keyword">package</span>=<span class="string">&quot;com.it&quot;</span>&gt;</span><br><span class="line">            &lt;!--配置那些注解不扫描--&gt;</span><br><span class="line">            &lt;context:exclude-filter type=<span class="string">&quot;annotation&quot;</span> expression=<span class="string">&quot;org.springframework.stereotype.Controller&quot;</span>/&gt;</span><br><span class="line">        &lt;/context:component-scan&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;/beans&gt;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    测试</span><br><span class="line">    	 <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">            <span class="comment">//加载spring得配置文件</span></span><br><span class="line">            ApplicationContext ac = <span class="keyword">new</span></span><br><span class="line">                    ClassPathXmlApplicationContext</span><br><span class="line">                    (<span class="string">&quot;classpath:applicationContext.xml&quot;</span>);</span><br><span class="line">            <span class="comment">/*获取对象*/</span></span><br><span class="line">            AccountService as = (AccountService) ac.getBean(<span class="string">&quot;accountService&quot;</span>);</span><br><span class="line">            <span class="comment">//调用方法</span></span><br><span class="line">            as.findAll();</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>

<h2 id="5-2springmvc整合"><a href="#5-2springmvc整合" class="headerlink" title="5.2springmvc整合"></a>5.2springmvc整合</h2><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">web.xml</span><br><span class="line">	&lt;!DOCTYPE web-app PUBLIC</span><br><span class="line"> <span class="string">&quot;-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN&quot;</span></span><br><span class="line"> <span class="string">&quot;http://java.sun.com/dtd/web-app_2_3.dtd&quot;</span> &gt;</span><br><span class="line"></span><br><span class="line">    &lt;web-app&gt;</span><br><span class="line">      &lt;display-name&gt;Archetype Created Web Application&lt;/display-name&gt;</span><br><span class="line">      &lt;!--前端控制器--&gt;</span><br><span class="line">      &lt;servlet&gt;</span><br><span class="line">        &lt;servlet-name&gt;dispatcherServlet&lt;/servlet-name&gt;</span><br><span class="line">        &lt;servlet-<span class="class"><span class="keyword">class</span>&gt;<span class="title">org</span>.<span class="title">springframework</span>.<span class="title">web</span>.<span class="title">servlet</span>.<span class="title">DispatcherServlet</span>&lt;/<span class="title">servlet</span>-<span class="title">class</span>&gt;</span></span><br><span class="line"><span class="class">        &lt;!--加载<span class="title">springmvc</span>.<span class="title">xml</span>--&gt;</span></span><br><span class="line"><span class="class">        &lt;<span class="title">init</span>-<span class="title">param</span>&gt;</span></span><br><span class="line"><span class="class">          &lt;<span class="title">param</span>-<span class="title">name</span>&gt;<span class="title">contextConfigLocation</span>&lt;/<span class="title">param</span>-<span class="title">name</span>&gt;</span></span><br><span class="line">          &lt;param-value&gt;classpath:springmvc.xml&lt;/param-value&gt;</span><br><span class="line">        &lt;/init-param&gt;</span><br><span class="line">        &lt;!--启动服务器创建参数--&gt;</span><br><span class="line">        &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;</span><br><span class="line">      &lt;/servlet&gt;</span><br><span class="line">      &lt;servlet-mapping&gt;</span><br><span class="line">        &lt;servlet-name&gt;dispatcherServlet&lt;/servlet-name&gt;</span><br><span class="line">        &lt;url-pattern&gt;/&lt;/url-pattern&gt;</span><br><span class="line">      &lt;/servlet-mapping&gt;</span><br><span class="line">      &lt;!--解决中文乱码过滤器--&gt;</span><br><span class="line">      &lt;filter&gt;</span><br><span class="line">        &lt;filter-name&gt;characterEncodingFilter&lt;/filter-name&gt;</span><br><span class="line">        &lt;filter-<span class="class"><span class="keyword">class</span>&gt;<span class="title">org</span>.<span class="title">springframework</span>.<span class="title">web</span>.<span class="title">filter</span>.<span class="title">CharacterEncodingFilter</span>&lt;/<span class="title">filter</span>-<span class="title">class</span>&gt;</span></span><br><span class="line"><span class="class">        &lt;<span class="title">init</span>-<span class="title">param</span>&gt;</span></span><br><span class="line"><span class="class">          &lt;<span class="title">param</span>-<span class="title">name</span>&gt;<span class="title">encoding</span>&lt;/<span class="title">param</span>-<span class="title">name</span>&gt;</span></span><br><span class="line"><span class="class">          &lt;<span class="title">param</span>-<span class="title">value</span>&gt;<span class="title">UTF</span>-8&lt;/<span class="title">param</span>-<span class="title">value</span>&gt;</span></span><br><span class="line"><span class="class">        &lt;/<span class="title">init</span>-<span class="title">param</span>&gt;  </span></span><br><span class="line"><span class="class">      &lt;/<span class="title">filter</span>&gt;</span></span><br><span class="line"><span class="class">      &lt;<span class="title">filter</span>-<span class="title">mapping</span>&gt;</span></span><br><span class="line"><span class="class">        &lt;<span class="title">filter</span>-<span class="title">name</span>&gt;<span class="title">characterEncodingFilter</span>&lt;/<span class="title">filter</span>-<span class="title">name</span>&gt;</span></span><br><span class="line"><span class="class">        &lt;<span class="title">url</span>-<span class="title">pattern</span>&gt;/*&lt;/<span class="title">url</span>-<span class="title">pattern</span>&gt;</span></span><br><span class="line"><span class="class">      &lt;/<span class="title">filter</span>-<span class="title">mapping</span>&gt;</span></span><br><span class="line"><span class="class">    &lt;/<span class="title">web</span>-<span class="title">app</span>&gt;</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">springmvc</span>.<span class="title">xml</span></span></span><br><span class="line"><span class="class">            &lt;?<span class="title">xml</span> <span class="title">version</span></span>=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span><br><span class="line">        &lt;beans xmlns=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span><br><span class="line">               xmlns:xsi=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="line">               xmlns:context=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span><br><span class="line">               xmlns:mvc=<span class="string">&quot;http://www.springframework.org/schema/mvc&quot;</span></span><br><span class="line">               xsi:schemaLocation=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span><br><span class="line"><span class="string">            http://www.springframework.org/schema/beans/spring-beans.xsd</span></span><br><span class="line"><span class="string">            http://www.springframework.org/schema/context</span></span><br><span class="line"><span class="string">            http://www.springframework.org/schema/context/spring-context.xsd</span></span><br><span class="line"><span class="string">            http://www.springframework.org/schema/mvc</span></span><br><span class="line"><span class="string">            http://www.springframework.org/schema/mvc/spring-mvc.xsd&quot;</span>&gt;</span><br><span class="line">            &lt;!--开启注解扫描--&gt;</span><br><span class="line">            &lt;context:component-scan base-<span class="keyword">package</span>=<span class="string">&quot;com.it&quot;</span>&gt;</span><br><span class="line">                &lt;context:include-filter type=<span class="string">&quot;annotation&quot;</span> expression=<span class="string">&quot;org.springframework.stereotype.Controller&quot;</span>/&gt;</span><br><span class="line">            &lt;/context:component-scan&gt;</span><br><span class="line">            &lt;!--视图解析器--&gt;</span><br><span class="line">            &lt;bean id=<span class="string">&quot;internalResourceViewResolver&quot;</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;</span>&gt;</span><br><span class="line">                &lt;property name=&quot;prefix&quot; value=&quot;/WEB-INF/pages/&quot;&gt;&lt;/property&gt;</span><br><span class="line">                &lt;property name=&quot;suffix&quot; value=&quot;.jsp&quot;&gt;&lt;/property&gt;</span><br><span class="line">            &lt;/bean&gt;</span><br><span class="line">            &lt;!--不过滤静态资源--&gt;</span><br><span class="line">            &lt;mvc:<span class="keyword">default</span>-servlet-handler/&gt;</span><br><span class="line">            &lt;!--开启springMvc注解支持--&gt;</span><br><span class="line">            &lt;mvc:annotation-driven&gt;&lt;/mvc:annotation-driven&gt;</span><br><span class="line">        &lt;/beans&gt;</span><br></pre></td></tr></table></figure>

<h2 id="5-3spring整合springmvc方法"><a href="#5-3spring整合springmvc方法" class="headerlink" title="5.3spring整合springmvc方法"></a>5.3spring整合springmvc方法</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">启动服务器  加载spring得配置文件  然后依赖注入</span><br><span class="line"></span><br><span class="line">ServletContext对象 在服务器启动得时候创建 ，服务器关闭才销毁</span><br><span class="line">		监听器 可以监听域对象得创建和销毁</span><br><span class="line">				监听器去加载spring得配置文件</span><br><span class="line">				创建web工厂，存储ServletContext对象</span><br><span class="line">				</span><br><span class="line">				</span><br><span class="line">	在 webapp</span><br><span class="line">		 &lt;!--配置spring 得监听器--&gt;</span><br><span class="line">          &lt;!--默认只加载web-inf目录下面得 spring.xml 配置文件--&gt;</span><br><span class="line">          &lt;listener&gt;</span><br><span class="line">            &lt;listener-<span class="class"><span class="keyword">class</span>&gt;<span class="title">org</span>.<span class="title">springframework</span>.<span class="title">web</span>.<span class="title">context</span>.<span class="title">ContextLoaderListener</span>&lt;/<span class="title">listener</span>-<span class="title">class</span>&gt;</span></span><br><span class="line"><span class="class">          &lt;/<span class="title">listener</span>&gt;</span></span><br><span class="line"><span class="class">          &lt;!--设置配置文件路径--&gt;</span></span><br><span class="line"><span class="class">          &lt;<span class="title">context</span>-<span class="title">param</span>&gt;</span></span><br><span class="line"><span class="class">            &lt;<span class="title">param</span>-<span class="title">name</span>&gt;<span class="title">contextConfigLocation</span>&lt;/<span class="title">param</span>-<span class="title">name</span>&gt;</span></span><br><span class="line">            &lt;param-value&gt;classpath:applicationContext.xml&lt;/param-value&gt;</span><br><span class="line">          &lt;/context-param&gt;</span><br><span class="line">          </span><br><span class="line">      在控制器</span><br><span class="line">      		<span class="meta">@Controller</span></span><br><span class="line">                    <span class="meta">@RequestMapping(&quot;/account&quot;)</span></span><br><span class="line">                    <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccountController</span> </span>&#123;</span><br><span class="line">                        <span class="meta">@Autowired</span></span><br><span class="line">                        <span class="keyword">private</span> AccountService accountService;</span><br><span class="line">                        <span class="meta">@RequestMapping(&quot;testFindAll&quot;)</span></span><br><span class="line">                        <span class="function"><span class="keyword">public</span> String <span class="title">findAll</span><span class="params">()</span></span>&#123;</span><br><span class="line">                            System.out.println(<span class="string">&quot;表现层查询所有账户信息&quot;</span>);</span><br><span class="line">                            accountService.findAll();</span><br><span class="line">                            <span class="keyword">return</span> <span class="string">&quot;list&quot;</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br></pre></td></tr></table></figure>

<h2 id="5-4-spring整合mybatis框架"><a href="#5-4-spring整合mybatis框架" class="headerlink" title="5.4 spring整合mybatis框架"></a>5.4 spring整合mybatis框架</h2><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">代理对象</span><br><span class="line">	&lt;!--spring去整合mybatis框架--&gt;</span><br><span class="line">    &lt;!--配置连接池c3p0--&gt;</span><br><span class="line">    &lt;bean id=<span class="string">&quot;dataSource&quot;</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;com.mchange.v2.c3p0.ComboPooledDataSource&quot;</span>&gt;</span><br><span class="line">        &lt;property name=&quot;driverClass&quot; value=&quot;com.mysql.jdbc.Driver&quot;&gt;&lt;/property&gt;</span><br><span class="line">        &lt;property name=&quot;jdbcUrl&quot; value=&quot;jdbc:mysql:///ssm?useUnicode=true&amp;amp;characterEncoding=UTF-8&quot;&gt;&lt;/property&gt;</span><br><span class="line">        &lt;property name=&quot;user&quot; value=&quot;root&quot;&gt;&lt;/property&gt;</span><br><span class="line">        &lt;property name=&quot;password&quot; value=&quot;root&quot;&gt;&lt;/property&gt;</span><br><span class="line">    &lt;/bean&gt;</span><br><span class="line">    &lt;!--配置sqlsessionfactory--&gt;</span><br><span class="line">    &lt;bean id=<span class="string">&quot;sqlSessionFactory&quot;</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;org.mybatis.spring.SqlSessionFactoryBean&quot;</span>&gt;</span><br><span class="line">        &lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot;&gt;&lt;/property&gt;</span><br><span class="line">    &lt;/bean&gt;</span><br><span class="line">    &lt;!--配置接口所在的包--&gt;</span><br><span class="line">    &lt;bean id=<span class="string">&quot;mapperScannerConfigurer&quot;</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;org.mybatis.spring.mapper.MapperScannerConfigurer&quot;</span>&gt;</span><br><span class="line">        &lt;property name=&quot;basePackage&quot; value=&quot;com.it.dao&quot;&gt;&lt;/property&gt;</span><br><span class="line">    &lt;/bean&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">写道  spring.xml里面  不要 sqlmap.xml</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">保存  提交事务 </span><br><span class="line">		&lt;!--声明事务管理--&gt;</span><br><span class="line">            &lt;!--配置事务管理器--&gt;</span><br><span class="line">            &lt;bean id=<span class="string">&quot;transactionManager&quot;</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;</span>&gt;</span><br><span class="line">                &lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot;&gt;&lt;/property&gt;</span><br><span class="line">            &lt;/bean&gt;</span><br><span class="line">            &lt;!--配置事务通知--&gt;</span><br><span class="line">            &lt;tx:advice id=<span class="string">&quot;txadvice&quot;</span> transaction-manager=<span class="string">&quot;transactionManager&quot;</span>&gt;</span><br><span class="line">                &lt;tx:attributes&gt;</span><br><span class="line">                    &lt;tx:method name=<span class="string">&quot;find*&quot;</span> read-only=<span class="string">&quot;true&quot;</span>/&gt;</span><br><span class="line">                    &lt;tx:method name=&quot;*&quot; isolation=&quot;DEFAULT&quot;&gt;&lt;/tx:method&gt;</span><br><span class="line">                &lt;/tx:attributes&gt;</span><br><span class="line">            &lt;/tx:advice&gt;</span><br><span class="line">            &lt;!--配置aop增强--&gt;</span><br><span class="line">            &lt;aop:config&gt;</span><br><span class="line">                &lt;aop:advisor advice-ref=&quot;txadvice&quot; pointcut=&quot;execution(* com.it.service.impl.*AccountServiceImpl.*(..))&quot;&gt;&lt;/aop:advisor&gt;</span><br><span class="line">            &lt;/aop:config&gt;</span><br></pre></td></tr></table></figure>

<h2 id="5-5-restful风格"><a href="#5-5-restful风格" class="headerlink" title="5.5 restful风格"></a>5.5 restful风格</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--rest风格uri 将post请求转化--&gt;</span><br><span class="line"> &lt;filter&gt;</span><br><span class="line">   &lt;filter-name&gt;HiddenHttpMethodFilter&lt;/filter-name&gt;</span><br><span class="line">   &lt;filter-<span class="class"><span class="keyword">class</span>&gt;<span class="title">org</span>.<span class="title">springframework</span>.<span class="title">web</span>.<span class="title">filter</span>.<span class="title">HiddenHttpMethodFilter</span>&lt;/<span class="title">filter</span>-<span class="title">class</span>&gt;</span></span><br><span class="line"><span class="class"> &lt;/<span class="title">filter</span>&gt;</span></span><br><span class="line"><span class="class"> &lt;<span class="title">filter</span>-<span class="title">mapping</span>&gt;</span></span><br><span class="line"><span class="class">   &lt;<span class="title">filter</span>-<span class="title">name</span>&gt;<span class="title">HiddenHttpMethodFilter</span>&lt;/<span class="title">filter</span>-<span class="title">name</span>&gt;</span></span><br><span class="line"><span class="class">   &lt;<span class="title">url</span>-<span class="title">pattern</span>&gt;/*&lt;/<span class="title">url</span>-<span class="title">pattern</span>&gt;</span></span><br><span class="line"><span class="class"> &lt;/<span class="title">filter</span>-<span class="title">mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="5-6逆向工程"><a href="#5-6逆向工程" class="headerlink" title="5.6逆向工程"></a>5.6逆向工程</h2><p>根据数据库生成bean以及对应的mapper</p>
<p>​        引入 </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- https:<span class="comment">//mvnrepository.com/artifact/org.mybatis.generator/mybatis-generator-core --&gt;</span></span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">  &lt;groupId&gt;org.mybatis.generator&lt;/groupId&gt;</span><br><span class="line">  &lt;artifactId&gt;mybatis-generator-core&lt;/artifactId&gt;</span><br><span class="line">  &lt;version&gt;1.3.5&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">逆向工程测试文件</span><br><span class="line">	List&lt;String&gt; warnings = <span class="keyword">new</span> ArrayList&lt;String&gt;();</span><br><span class="line">        <span class="keyword">boolean</span> overwrite = <span class="keyword">true</span>;</span><br><span class="line">        File configFile = <span class="keyword">new</span> File(<span class="string">&quot;mbg.xml&quot;</span>);</span><br><span class="line">        ConfigurationParser cp = <span class="keyword">new</span> ConfigurationParser(warnings);</span><br><span class="line">        Configuration config = cp.parseConfiguration(configFile);</span><br><span class="line">        DefaultShellCallback callback = <span class="keyword">new</span> DefaultShellCallback(overwrite);</span><br><span class="line">        MyBatisGenerator myBatisGenerator = <span class="keyword">new</span> MyBatisGenerator(config, callback, warnings);</span><br><span class="line">        myBatisGenerator.generate(<span class="keyword">null</span>);</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">   pom.xml配置</span><br><span class="line">   		&lt;plugin&gt;</span><br><span class="line">                &lt;groupId&gt;org.mybatis.generator&lt;/groupId&gt;</span><br><span class="line">                &lt;artifactId&gt;mybatis-generator-maven-plugin&lt;/artifactId&gt;</span><br><span class="line">                &lt;version&gt;1.3.2&lt;/version&gt;</span><br><span class="line">                &lt;configuration&gt;</span><br><span class="line">                    &lt;verbose&gt;true&lt;/verbose&gt;</span><br><span class="line">                    &lt;overwrite&gt;true&lt;/overwrite&gt;</span><br><span class="line">                &lt;/configuration&gt;</span><br><span class="line">            &lt;/plugin&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="6-springboot"><a href="#6-springboot" class="headerlink" title="6.springboot"></a>6.springboot</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">微服务  一组小型服务，可以通过http方式沟通</span><br><span class="line"></span><br><span class="line">把功能元素放到一个服务器中&#x2F;</span><br><span class="line"></span><br><span class="line">&lt;version&gt;4.13&lt;&#x2F;version&gt;</span><br><span class="line">RUNWith爆红解决</span><br></pre></td></tr></table></figure>

<h2 id="6-1快速创建"><a href="#6-1快速创建" class="headerlink" title="6.1快速创建"></a>6.1快速创建</h2><h3 id="6-1-导入包"><a href="#6-1-导入包" class="headerlink" title="6.1.导入包"></a>6.1.导入包</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--导入springboot--&gt;</span><br><span class="line">    &lt;parent&gt;</span><br><span class="line">        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;</span><br><span class="line">        &lt;version&gt;1.5.9.RELEASE&lt;/version&gt;</span><br><span class="line">    &lt;/parent&gt;</span><br><span class="line">    <span class="comment">//父项目 真正的管理spring boot里面所有的依赖</span></span><br><span class="line">    &lt;dependencies&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line">    &lt;/dependencies&gt;</span><br><span class="line">    <span class="comment">//这个依赖 帮我们导入web模块正常需要运行需要的场景模块</span></span><br><span class="line">    springboot将所有的功能场景都抽取出来 ，成为starter 只需要在项目中引入就可以将所有的依赖导入进来</span><br></pre></td></tr></table></figure>

<h3 id="6-2编写主方法"><a href="#6-2编写主方法" class="headerlink" title="6.2编写主方法"></a>6.2编写主方法</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">helloworld</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">/*让springboot启动起来*/</span></span><br><span class="line">        SpringApplication.run(helloworld.class,args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="6-3Controller"><a href="#6-3Controller" class="headerlink" title="6.3Controller"></a>6.3Controller</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;hello&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Hello World!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="6-4部署"><a href="#6-4部署" class="headerlink" title="6.4部署"></a>6.4部署</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">导入maven 插件</span><br><span class="line">	&lt;build&gt;</span><br><span class="line">        &lt;plugins&gt;</span><br><span class="line">            &lt;plugin&gt;</span><br><span class="line">                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;</span><br><span class="line">            &lt;/plugin&gt;</span><br><span class="line">        &lt;/plugins&gt;</span><br><span class="line">    &lt;/build&gt;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    之后使用 java -jar spring名字   部署完成</span><br></pre></td></tr></table></figure>

<h2 id="6-2快速创建"><a href="#6-2快速创建" class="headerlink" title="6.2快速创建"></a>6.2快速创建</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*restful风格*/</span></span><br><span class="line"><span class="comment">//@ResponseBody</span></span><br><span class="line"><span class="comment">//@Controller</span></span><br><span class="line"><span class="comment">/*合体*/</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">hello</span> </span>&#123;</span><br><span class="line">    <span class="comment">//@ResponseBody</span></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/helloquick&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">hello1</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;hello world quick!!是谁&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="6-3springboot配置"><a href="#6-3springboot配置" class="headerlink" title="6.3springboot配置"></a>6.3springboot配置</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">application.properties</span><br><span class="line">application.yml</span><br><span class="line"></span><br><span class="line">		修改springboot修改的默认值  <span class="number">18693943425</span></span><br><span class="line">YAML配置全程</span><br></pre></td></tr></table></figure>

<h3 id="6-3-1YAML语法"><a href="#6-3-1YAML语法" class="headerlink" title="6.3.1YAML语法"></a>6.3.1YAML语法</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">key: value:   表示一对键值对</span><br><span class="line"></span><br><span class="line">例如  区分大小写</span><br><span class="line">	server:</span><br><span class="line">		port: <span class="number">8081</span></span><br><span class="line">		path: /hello</span><br><span class="line">	值得写法</span><br><span class="line">    	值得写法  </span><br><span class="line">    		字面量   直接来写  字符串默认不用加上单引号双引号 </span><br><span class="line">    				“”不会转义特殊字符</span><br><span class="line">    				‘’会转义特殊字符</span><br><span class="line">    		对象,MAP  键值对</span><br><span class="line">    			friends:</span><br><span class="line">    				lastName: zhangsan</span><br><span class="line">    				age: <span class="number">20</span></span><br><span class="line">    			写在一行</span><br><span class="line">    				friends: &#123; lastname:zhangsan,age:<span class="number">18</span> &#125;</span><br><span class="line">    		数组 LIst Set</span><br><span class="line">            	用 - 表示数组中得元素</span><br><span class="line">            	pets:</span><br><span class="line">            		-cat</span><br><span class="line">            		-dog</span><br><span class="line">            		-pig</span><br><span class="line">            		行内元素</span><br><span class="line">            		pets:[cat,dog,dog]</span><br><span class="line">    将配置文件中的映射</span><br><span class="line">    	导入配置依赖</span><br><span class="line">    	&lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;spring-boot-configuration-processor&lt;/artifactId&gt;</span><br><span class="line">            &lt;optional&gt;true&lt;/optional&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line">        </span><br><span class="line">        person:</span><br><span class="line">            lastName: zhangsan</span><br><span class="line">            age: <span class="number">18</span></span><br><span class="line">            boss: <span class="keyword">false</span></span><br><span class="line">            birth: <span class="number">2017</span>/<span class="number">12</span>/<span class="number">12</span></span><br><span class="line">            maps: &#123;k1: <span class="number">11</span>,k2: <span class="number">12</span>&#125;</span><br><span class="line">            lists:</span><br><span class="line">              - lisi</span><br><span class="line">              - zhaoliu</span><br><span class="line">            dog:</span><br><span class="line">              name: 小狗</span><br><span class="line">              age: <span class="number">2</span></span><br><span class="line">              </span><br><span class="line">            <span class="meta">@Component</span></span><br><span class="line">			<span class="meta">@ConfigurationProperties(prefix = &quot;person&quot;)</span></span><br><span class="line">			<span class="comment">//只有spring容器组件中的才能容器提供的功能</span></span><br><span class="line">			runwith爆红  加 version  <span class="number">2.13</span></span><br></pre></td></tr></table></figure>

<h3 id="6-3-2在properties配置"><a href="#6-3-2在properties配置" class="headerlink" title="6.3.2在properties配置"></a>6.3.2在properties配置</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">person.age=<span class="number">18</span></span><br><span class="line">person.birth=<span class="number">2018</span>/<span class="number">19</span>/<span class="number">12</span></span><br><span class="line">person.boss=<span class="keyword">false</span></span><br><span class="line">person.dog.name=dog</span><br><span class="line">person.last-name=你是</span><br><span class="line">person.lists=a,b,c</span><br><span class="line">person.dog.age=<span class="number">15</span></span><br><span class="line">person.maps.k1=<span class="number">13</span></span><br><span class="line">person.maps.k5=<span class="number">15</span></span><br></pre></td></tr></table></figure>

<h3 id="6-3-3value注解"><a href="#6-3-3value注解" class="headerlink" title="6.3.3value注解"></a>6.3.3value注解</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">单个注入</span><br><span class="line">	<span class="meta">@value(&#x27;$&#123;person.lastName&#125;&#x27;)</span></span><br><span class="line">	<span class="meta">@value(&#x27;#&#123;11*2&#125;&#x27;)</span></span><br><span class="line">	支持SPEL表达式</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	相比前者支持jsr303数据校验  后者不支持校验</span><br><span class="line">	<span class="meta">@Validated</span>放在类上面</span><br><span class="line">		<span class="meta">@Email</span>放在成员变量上面  启动校验</span><br></pre></td></tr></table></figure>

<h3 id="6-3-4-propertySource和-ImportResource"><a href="#6-3-4-propertySource和-ImportResource" class="headerlink" title="6.3.4@propertySource和@ImportResource"></a>6.3.4@propertySource和@ImportResource</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@propertySource(value = &#123;&#x27;classpath:文件路劲&#x27;&#125;)</span>   加载指定配置文件</span><br><span class="line"><span class="meta">@ImportResource(location = &#123;&#x27;classpath:beans.xml&#x27;&#125;)</span></span><br><span class="line">	导入spring的配置文件，让配置文件里面的内容生效</span><br><span class="line">	例如导入 spring配置文件中的 bean生效 用这个注解</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@ConfigerationProperties()</span>  默认全局配置文件中获取</span><br><span class="line"></span><br><span class="line">spring推荐的方式</span><br><span class="line">		<span class="number">1.</span>推荐使用 配置类  </span><br><span class="line">				<span class="meta">@Configuration</span> 指定当前类是一个配置类，替代配置文件</span><br><span class="line">					<span class="meta">@Bean</span>  <span class="comment">//将方法的返回值添加到容器中 默认的id就是方法名字</span></span><br><span class="line">                    <span class="function"><span class="keyword">public</span> helloService <span class="title">hello</span><span class="params">()</span></span>&#123;</span><br><span class="line">                        <span class="keyword">return</span> <span class="keyword">new</span> helloService();</span><br><span class="line">                    &#125;</span><br></pre></td></tr></table></figure>

<h3 id="6-3-5配置文件占位符"><a href="#6-3-5配置文件占位符" class="headerlink" title="6.3.5配置文件占位符"></a>6.3.5配置文件占位符</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">随机数 和  获取之前的值</span><br><span class="line">		person.age=$&#123;random.<span class="keyword">int</span>&#125;</span><br><span class="line">        person.birth=<span class="number">2018</span>/<span class="number">19</span>/<span class="number">12</span></span><br><span class="line">        person.boss=<span class="keyword">false</span></span><br><span class="line">        person.dog.name=$&#123;person.last-name&#125;_dog</span><br><span class="line">        person.last-name=张三萨达撒$&#123;random.uuid&#125;</span><br><span class="line">        </span><br><span class="line">        默认值</span><br><span class="line">        	 person.dog.name=$&#123;person.last-name：的撒大&#125;_dog</span><br></pre></td></tr></table></figure>

<h3 id="6-3-6profile和配置文件加载位置"><a href="#6-3-6profile和配置文件加载位置" class="headerlink" title="6.3.6profile和配置文件加载位置"></a>6.3.6profile和配置文件加载位置</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">是对spring不同环境提供不同配置的文档，可以通过激活环境等方式来切换环境</span><br><span class="line">	文件名可以是  </span><br><span class="line">	application-dev.properties    开发环境</span><br><span class="line">	application-prod.properties		生产环境</span><br><span class="line">	</span><br><span class="line">	默认使用 application.properties的配置</span><br><span class="line">		在里面激活其他文件</span><br><span class="line">			spring.profiles.active=dev</span><br><span class="line">            </span><br><span class="line">            </span><br><span class="line">    yml</span><br><span class="line">   		里面用文档块分开</span><br><span class="line">   				spring:</span><br><span class="line">   					profiles:</span><br><span class="line">   						active: dev</span><br><span class="line">   				---</span><br><span class="line">   				spring:</span><br><span class="line">   					profiles: dev</span><br><span class="line">   				---</span><br><span class="line">   				spring:</span><br><span class="line">   					profiles: app</span><br><span class="line">   					</span><br><span class="line">   		打包的时候可以在后面  --spring.profiles.active=dev</span><br><span class="line">   		</span><br><span class="line">   		</span><br><span class="line">   配置文件加载位置</span><br><span class="line">   	file:./config</span><br><span class="line">   	file:./</span><br><span class="line">   	classpath:/config/</span><br><span class="line">   	classpath:/</span><br><span class="line">   		优先级从高到底</span><br><span class="line">   		</span><br><span class="line">   		互补配置</span><br><span class="line">   		</span><br><span class="line">   		还可以使用spring.config.location=G:/application.properties</span><br><span class="line">   		也是互补配置</span><br><span class="line">   		命令行也可以  使用命令指定配置文件</span><br><span class="line">   		</span><br><span class="line">   		</span><br><span class="line">   	外部配置加载顺序</span><br><span class="line">   		<span class="number">1.</span>命令行参数</span><br><span class="line">   		<span class="number">2.</span>jar包外部的application-&#123;profile&#125;.properties</span><br><span class="line">   		<span class="number">3.</span>jar包内部的application-&#123;profile&#125;.properties</span><br><span class="line">   		<span class="number">4.</span>jar包外部的application.properties</span><br><span class="line">   		<span class="number">5.</span>jar包内部的application.properties</span><br><span class="line">   		</span><br><span class="line">   		启用debug=<span class="keyword">true</span>  打印自动配置类报告</span><br></pre></td></tr></table></figure>

<h2 id="6-4springboot日志"><a href="#6-4springboot日志" class="headerlink" title="6.4springboot日志"></a>6.4springboot日志</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">日志门面  JCL SLF4j   jboss </span><br><span class="line">日志实现	log4j   JUL   log4j2   logback</span><br><span class="line"></span><br><span class="line">选用  </span><br><span class="line">	SLF4j门面</span><br><span class="line">	logback实现</span><br><span class="line">	</span><br><span class="line">	springboot默认选用  SLF4j门面 选择SLF4j 和  logback，底层spring选用JCL</span><br><span class="line">	</span><br><span class="line">	以后开发调用日志抽象层的方法，不调用是实现类</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	统一使用  日志记录   都使用 SLF4j门面logback实现</span><br><span class="line">		springboot在底层也是使用适配器转化为  SLF4j</span><br><span class="line">		springboot能自动适配所有日志，而且底层使用SLF4J + logback得方式记录日志，引入其他框架得时候，只需要把这个以来的日志排除掉</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">		 <span class="comment">//记录器</span></span><br><span class="line">        Logger logger = LoggerFactory.getLogger(getClass());</span><br><span class="line">        <span class="comment">//日志得级别由低到高，日志只会打印以下得级别</span></span><br><span class="line">        logger.trace(<span class="string">&quot;这是trace日志&quot;</span>);</span><br><span class="line">        logger.debug(<span class="string">&quot;这是debug日志&quot;</span>);</span><br><span class="line">        logger.info(<span class="string">&quot;输入info日志&quot;</span>);</span><br><span class="line">        <span class="comment">//默认是info日志</span></span><br><span class="line">        logger.warn(<span class="string">&quot;这是warn日志&quot;</span>);</span><br><span class="line">        logger.error(<span class="string">&quot;这是error日志,捕获异常&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        logging.level.com.it = trace修改在application.properties</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">        指定目录</span><br><span class="line">        	logging.level.com.it = trace</span><br><span class="line">            #指定生成目录</span><br><span class="line">            #logging.file.path=</span><br><span class="line">            #当前项目下生成springboot.log日志</span><br><span class="line">            #也可以指定完整得路径</span><br><span class="line">            logging.file.name=C:/Users/Administrator/Desktop/spring.log</span><br><span class="line">            </span><br><span class="line">            也可以修改日志输出格式</span><br><span class="line">            </span><br><span class="line">        指定配置</span><br><span class="line">        	给类路劲下面放上每个日志框架的自己得配置文件即可，springboot就不使用默认配置</span><br><span class="line">        	logback.xml</span><br></pre></td></tr></table></figure>

<h2 id="6-5-Springboot-web开发"><a href="#6-5-Springboot-web开发" class="headerlink" title="6.5 Springboot-web开发"></a>6.5 Springboot-web开发</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>选中模块</span><br><span class="line"><span class="number">2.</span>在配置文件中配置少量配置</span><br><span class="line"><span class="number">3.</span>编写业务</span><br><span class="line"></span><br><span class="line">########################自动配置原理</span><br><span class="line">		xxxAutoConfigruation  帮我们容器中自动配置组件</span><br><span class="line">		xxxproperties    封装配置文件得内容</span><br><span class="line">			</span><br></pre></td></tr></table></figure>

<h3 id="6-5-1对静态资源得映射规则"><a href="#6-5-1对静态资源得映射规则" class="headerlink" title="6.5.1对静态资源得映射规则"></a>6.5.1对静态资源得映射规则</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>所有  /webjars<span class="comment">/**  都去resources/webjars  找资源  </span></span><br><span class="line"><span class="comment">		以jar包得方式引入资源</span></span><br><span class="line"><span class="comment">		访问得时候写webjars资源名称</span></span><br><span class="line"><span class="comment">		</span></span><br><span class="line"><span class="comment">		例如</span></span><br><span class="line"><span class="comment">			http://localhost:8080/webjars/jquery/3.4.1/jquery.js</span></span><br><span class="line"><span class="comment">			&lt;!--引入jquery坐标--&gt;</span></span><br><span class="line"><span class="comment">                &lt;dependency&gt;</span></span><br><span class="line"><span class="comment">                    &lt;groupId&gt;org.webjars&lt;/groupId&gt;</span></span><br><span class="line"><span class="comment">                    &lt;artifactId&gt;jquery&lt;/artifactId&gt;</span></span><br><span class="line"><span class="comment">                    &lt;version&gt;3.4.1&lt;/version&gt;</span></span><br><span class="line"><span class="comment">                &lt;/dependency&gt;</span></span><br><span class="line"><span class="comment">                </span></span><br><span class="line"><span class="comment">             !访问当前项目得任何资源</span></span><br><span class="line"><span class="comment">             	“classpath:/META-INF/resources/”</span></span><br><span class="line"><span class="comment">             	“classpath:/resources/”</span></span><br><span class="line"><span class="comment">             	“classpath:/static/”</span></span><br><span class="line"><span class="comment">             	&quot;classpath:/public/&quot;</span></span><br><span class="line"><span class="comment">             	/   当前项目根路径</span></span><br><span class="line"><span class="comment">             	maven重新导入访问</span></span><br><span class="line"><span class="comment">             	</span></span><br><span class="line"><span class="comment">             欢迎页面静态资源文件下得  html页面</span></span><br><span class="line"><span class="comment">             		放到  public</span></span><br><span class="line"><span class="comment">             		ctrl + f5   删除文件重新下载 刷新</span></span><br></pre></td></tr></table></figure>

<h3 id="6-5-2-引入thymeleaf模板引擎"><a href="#6-5-2-引入thymeleaf模板引擎" class="headerlink" title="6.5.2 引入thymeleaf模板引擎"></a>6.5.2 引入thymeleaf模板引擎</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">解决不能使用 jsp得问题</span><br><span class="line">		&lt;!--引入模板引擎--&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;spring-boot-starter-thymeleaf&lt;/artifactId&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line">        </span><br><span class="line">        语法</span><br><span class="line">        	默认前后缀</span><br><span class="line">        		<span class="string">&quot;classpath:/templates/&quot;</span></span><br><span class="line">        		<span class="string">&quot;.html&quot;</span></span><br><span class="line">        		</span><br><span class="line">        操作 </span><br><span class="line">        	<span class="number">1.</span>导入名称空间</span><br><span class="line">        		&lt;html lang=<span class="string">&quot;en&quot;</span> xmlns:th=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span><br><span class="line">        	<span class="number">2.</span>语法</span><br><span class="line">        		<span class="number">1.</span>th:text=<span class="string">&quot;&quot;</span>  						将 div里面得值设置</span><br><span class="line">        		2.th:id || th:class   th:任意属性  	  来替换原生属性</span><br><span class="line">        		<span class="number">3.</span>th:insert ||  th:replace   		插入公共片段</span><br><span class="line">        		<span class="number">4.</span>th:each   		遍历</span><br><span class="line">        		<span class="number">5.</span>th:<span class="keyword">if</span>     		条件判断</span><br><span class="line">        		<span class="number">6.</span>th:object  		设置变量</span><br><span class="line">        		<span class="number">7.</span>th:attr    		属性修改支持增加</span><br><span class="line">        		<span class="number">8.</span>th:fragment  		声明片段</span><br><span class="line">        		<span class="number">9.</span>th:remove   		移除</span><br><span class="line">        	<span class="number">3.</span>表达式</span><br><span class="line">        		$&#123;&#125;   </span><br><span class="line">        				用来获取变量值 调用方法  </span><br><span class="line">        				$&#123;#local,parma,session&#125; 内置基本对象</span><br><span class="line">                        内置一些工具对象</span><br><span class="line">        		#&#123;&#125;	  	获取国际化内容</span><br><span class="line">        		*&#123;&#125;		选择表达式  和$&#123;&#125;共功能一样 新增 去除的$&#123;user&#125;对象直接获取属性 #&#123;name&#125;</span><br><span class="line">        		@&#123;&#125;		定义url得 @&#123;/name(orderID)=$&#123;user.id&#125;&#125;</span><br><span class="line">        		~&#123;&#125;		片段引用表达式</span><br><span class="line">        		</span><br><span class="line">        		没有操作   _  </span><br><span class="line">        		[[$&#123;item&#125;]]  行内取出元素</span><br></pre></td></tr></table></figure>

<h3 id="6-5-2扩展springmvc"><a href="#6-5-2扩展springmvc" class="headerlink" title="6.5.2扩展springmvc"></a>6.5.2扩展springmvc</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">编写一个  配置类</span><br><span class="line"> 拦截器过时WebMvcConfigurerAdapter，换</span><br><span class="line"> 		<span class="number">1.</span><span class="meta">@Configuration</span></span><br><span class="line">            <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WebMvcConfg</span> <span class="keyword">implements</span> <span class="title">WebMvcConfigurer</span> </span>&#123;</span><br><span class="line">              <span class="comment">//省略</span></span><br><span class="line">            &#125;</span><br><span class="line">        <span class="number">2.</span><span class="meta">@Configuration</span></span><br><span class="line">            <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WebMvcConfg</span> <span class="keyword">extends</span> <span class="title">WebMvcConfigurationSupport</span> </span>&#123;</span><br><span class="line">            <span class="comment">//省略</span></span><br><span class="line">            &#125;</span><br><span class="line">		<span class="meta">@Cinfiguration</span></span><br><span class="line">		</span><br><span class="line">		    <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addResourceHandlers</span><span class="params">(ResourceHandlerRegistry registry)</span> </span>&#123;</span><br><span class="line">                registry.addResourceHandler(<span class="string">&quot;/**&quot;</span>).addResourceLocations(<span class="string">&quot;classpath:/templates/&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addViewControllers</span><span class="params">(ViewControllerRegistry registry)</span> </span>&#123;</span><br><span class="line">                <span class="comment">//super.addViewControllers(registry);</span></span><br><span class="line">                <span class="comment">/*将这个请求映射到success*/</span></span><br><span class="line">                registry.addViewController(<span class="string">&quot;/it&quot;</span>).setViewName(<span class="string">&quot;success&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="meta">@enablewebmvc</span> 全部自动配置  全面接管</span><br></pre></td></tr></table></figure>

<h2 id="6-6项目"><a href="#6-6项目" class="headerlink" title="6.6项目"></a>6.6项目</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>首页展示 </span><br><span class="line">		两种方法 <span class="meta">@requestmapping(&#123;&#x27;/&#x27;,&#x27;index.html&#x27;&#125;)</span></span><br><span class="line">				还有一种</span><br><span class="line">					内部类在配置类中间写 加上<span class="meta">@bean</span> 将组件注册在容器里面</span><br><span class="line">					路劲用模板引擎替换</span><br><span class="line"><span class="number">2.</span>国际化</span><br><span class="line">		新建三种国家化配置文件</span><br><span class="line">		spring.messages.basename=il8n/login </span><br><span class="line">		spring.messages.basename=i18n.login管理</span><br><span class="line">		去页面获取值</span><br><span class="line">		点击改变就自己去写一个区域信息解析器</span><br><span class="line">		LOcaleResolver  接口 实现  重写两个方法</span><br><span class="line"><span class="number">3.</span>登陆和拦截器</span><br><span class="line">		th:action=<span class="string">&quot;@&#123;/user/login&#125;“</span></span><br><span class="line"><span class="string">		设置控制器</span></span><br><span class="line"><span class="string">				 @PostMapping(value = &quot;</span>/user/login<span class="string">&quot;)</span></span><br><span class="line"><span class="string">                //@RequestMapping(value = &quot;</span>/user/login<span class="string">&quot;,method = RequestMethod.POST)</span></span><br><span class="line"><span class="string">                public String login(@RequestParam(&quot;</span>username<span class="string">&quot;) String username,</span></span><br><span class="line"><span class="string">                                    @RequestParam(&quot;</span>password<span class="string">&quot;) String password,</span></span><br><span class="line"><span class="string">                                    Map&lt;String,Object&gt; map)&#123;</span></span><br><span class="line"><span class="string">                    if (!StringUtils.isEmpty(username) &amp;&amp; &quot;</span><span class="number">123456</span><span class="string">&quot;.equals(password))&#123;</span></span><br><span class="line"><span class="string">                        return &quot;</span>dashboard<span class="string">&quot;;</span></span><br><span class="line"><span class="string">                    &#125;else &#123;</span></span><br><span class="line"><span class="string">                        map.put(&quot;</span>message<span class="string">&quot;,&quot;</span>用户名密码错误<span class="string">&quot;);</span></span><br><span class="line"><span class="string">                        return &quot;</span>index.html<span class="string">&quot;;</span></span><br><span class="line"><span class="string">                    &#125;</span></span><br><span class="line"><span class="string">                &#125;</span></span><br><span class="line"><span class="string">                </span></span><br><span class="line"><span class="string">                #禁用缓存</span></span><br><span class="line"><span class="string">				spring.thymeleaf.cache=false</span></span><br><span class="line"><span class="string">				</span></span><br><span class="line"><span class="string">				登陆错误消息显示</span></span><br><span class="line"><span class="string">		拦截器登陆检查</span></span><br><span class="line"><span class="string">		public class interceptor implements HandlerInterceptor &#123;</span></span><br><span class="line"><span class="string">    @Override</span></span><br><span class="line"><span class="string">    public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception &#123;</span></span><br><span class="line"><span class="string">        Object user = request.getSession().getAttribute(&quot;</span>loginUser<span class="string">&quot;);</span></span><br><span class="line"><span class="string">        if(user == null)&#123;</span></span><br><span class="line"><span class="string">            request.setAttribute(&quot;</span>msg<span class="string">&quot;,&quot;</span>没有权限请先登录<span class="string">&quot;);</span></span><br><span class="line"><span class="string">            request.getRequestDispatcher(&quot;</span>/index.html<span class="string">&quot;).forward(request,response);</span></span><br><span class="line"><span class="string">            return false;</span></span><br><span class="line"><span class="string">        &#125;else &#123;</span></span><br><span class="line"><span class="string">            return true;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    注册拦截器</span></span><br><span class="line"><span class="string">    	registry.addInterceptor(new LOginhandlerInterceptor()).addPathPatterns(&quot;</span><span class="comment">/**&quot;).excludePathPatterns(&quot;index.html&quot;,&quot;/&quot;);  拦截所有请求  排除登陆请求</span></span><br><span class="line"><span class="comment">    			拦截任意请求</span></span><br><span class="line"><span class="comment">   4.RESTFUL  CRUD</span></span><br><span class="line"><span class="comment">   	路劲得格式  URI ：/资源名称/资源标识  HTTP请求方式区分CRUD操作</span></span><br><span class="line"><span class="comment">   		</span></span><br></pre></td></tr></table></figure>

<h2 id="6-7错误处理"><a href="#6-7错误处理" class="headerlink" title="6.7错误处理"></a>6.7错误处理</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">返回一个错误得默认页面</span><br><span class="line">	</span><br><span class="line">	如果是其他客户端，默认响应一个 json数据</span><br><span class="line">	原理 可以参照ErrorMvcAutoConfiguration；错误处理得自动配置</span><br><span class="line">		定制错误得页面</span><br><span class="line">		定制错误得json数据</span><br><span class="line">		</span><br><span class="line">		给容器添加以下组件</span><br><span class="line">			<span class="number">1.</span>DefaultErrorAttributeS:帮我们在页面共享信息</span><br><span class="line">			<span class="number">2.</span>BasicErrorController 处理默认error请求,手机json，浏览器会是一个错误页面</span><br><span class="line">			<span class="number">3.</span>ErrorPAgeCustomizer  系统出现错误来到error请求进行处理 </span><br><span class="line">			<span class="number">4.</span>DefaultErrorViewResolver</span><br><span class="line">			</span><br><span class="line">			一旦出现4xx,5xx <span class="number">3</span>生效 定制错误得响应规则；</span><br><span class="line">				有模板引擎得情况下，error/状态码</span><br><span class="line">					获取时间戳，状态码，提示错误，异常消息，errors jsr303校验都在这里</span><br><span class="line">				没有模板，去静态资源下面找</span><br><span class="line">					</span><br><span class="line">			异常处理器  </span><br><span class="line">				<span class="meta">@ControllerAdvice</span></span><br><span class="line">				<span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyExceptionHandler</span></span>&#123;</span><br><span class="line">					<span class="comment">//浏览器和客户端返回的都是json</span></span><br><span class="line">                    <span class="meta">@ExceptionHandler(Exception.class)</span></span><br><span class="line">                    <span class="function"><span class="keyword">public</span> String <span class="title">handleException</span><span class="params">(Exception e)</span></span>&#123;</span><br><span class="line">                        转发到 error</span><br><span class="line">                    &#125;</span><br><span class="line">				&#125;</span><br></pre></td></tr></table></figure>

<h2 id="6-8-配置嵌入式Servlet容器"><a href="#6-8-配置嵌入式Servlet容器" class="headerlink" title="6.8. 配置嵌入式Servlet容器"></a>6.8. 配置嵌入式Servlet容器</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Springboot默认使用 嵌入式Servlet容器(Tomcat);</span><br><span class="line">	问题：</span><br><span class="line">		<span class="number">1.</span>如何定制修改servlet的相关配置</span><br><span class="line">			<span class="number">1.</span>properties</span><br><span class="line">            	server.port=<span class="number">8081</span></span><br><span class="line">				server.context-path=/crud</span><br><span class="line">				<span class="comment">//通用信息设置</span></span><br><span class="line">				server.xxx</span><br><span class="line">				<span class="comment">//tomcat的设置</span></span><br><span class="line">				server.tomcat.uri-encoding=UTF-<span class="number">8</span></span><br><span class="line">			<span class="number">2.</span>定制EmbeddedServletContainerCustomizer</span><br><span class="line">				定制嵌入式的servlet容器相关的</span><br><span class="line">				被WebServerFactoryCustomizer替代了</span><br><span class="line">		<span class="number">2.</span>能不能切换其他的servlet容器</span><br></pre></td></tr></table></figure>

<h2 id="6-9注册Servlet的三大组件"><a href="#6-9注册Servlet的三大组件" class="headerlink" title="6.9注册Servlet的三大组件"></a>6.9注册Servlet的三大组件</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">springboot中没有web.xml</span><br><span class="line">	Servlet  ServletRegistrationBean</span><br><span class="line">		写一个servlet</span><br><span class="line">			<span class="number">1.</span><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Myservlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">                    <span class="keyword">super</span>.doGet(req, resp);</span><br><span class="line">                    resp.getWriter().write(<span class="string">&quot;hellodsadasdsada!&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="number">2.</span>注册</span><br><span class="line">	Filter   FilterRegistrationBean</span><br><span class="line">		    <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain)</span> <span class="keyword">throws</span> IOException, ServletException </span>&#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;myFilter process....&quot;</span>);</span><br><span class="line">                filterChain.doFilter(servletRequest,servletResponse);</span><br><span class="line">            &#125;</span><br><span class="line">	Listener	ServletListenerRegistrationBean</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	在组件中注册：</span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyservletConfig</span> </span>&#123;</span><br><span class="line">    <span class="comment">//注册三大组件</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ServletRegistrationBean <span class="title">myserver</span><span class="params">()</span></span>&#123;</span><br><span class="line">        ServletRegistrationBean&lt;Servlet&gt; servletServletRegistrationBean</span><br><span class="line">                = <span class="keyword">new</span> ServletRegistrationBean&lt;&gt;(<span class="keyword">new</span> Myservlet(),<span class="string">&quot;/myservlet&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> servletServletRegistrationBean;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//注册filter</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> FilterRegistrationBean <span class="title">myfilter</span><span class="params">()</span></span>&#123;</span><br><span class="line">        FilterRegistrationBean&lt;Filter&gt; filterFilterRegistrationBean = <span class="keyword">new</span> FilterRegistrationBean&lt;&gt;();</span><br><span class="line">        filterFilterRegistrationBean.setFilter(<span class="keyword">new</span> MyFilter());</span><br><span class="line">        filterFilterRegistrationBean.setUrlPatterns(Arrays.asList(<span class="string">&quot;/hello&quot;</span>,<span class="string">&quot;/myservlet&quot;</span>));</span><br><span class="line">        <span class="keyword">return</span> filterFilterRegistrationBean;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//注册Listener</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ServletListenerRegistrationBean <span class="title">mylistener</span><span class="params">()</span></span>&#123;</span><br><span class="line">        ServletListenerRegistrationBean&lt;MyLsitener&gt; myLsitenerServletRegistrationBean = <span class="keyword">new</span> ServletListenerRegistrationBean&lt;MyLsitener&gt;(<span class="keyword">new</span> MyLsitener());</span><br><span class="line">        <span class="keyword">return</span> myLsitenerServletRegistrationBean;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">默认拦截 / 可以修改</span><br></pre></td></tr></table></figure>

<h2 id="6-10切换其他嵌入式servlet容器"><a href="#6-10切换其他嵌入式servlet容器" class="headerlink" title="6.10切换其他嵌入式servlet容器"></a>6.10切换其他嵌入式servlet容器</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Jetty （长连接应用适合聊天）</span><br><span class="line">UnderTow  (不支持jsp)</span><br><span class="line">tomcat(默认使用)</span><br><span class="line"></span><br><span class="line">		</span><br><span class="line">springboot支持切换</span><br><span class="line">		首先排除tomcat容器</span><br><span class="line">			exclusions</span><br><span class="line">		引入其他的servlet容器</span><br></pre></td></tr></table></figure>

<h2 id="6-11外置的servlet容器"><a href="#6-11外置的servlet容器" class="headerlink" title="6.11外置的servlet容器"></a>6.11外置的servlet容器</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">嵌入式 servlet的</span><br><span class="line">	优点</span><br><span class="line">		简单，便捷  不用需要安装 tomcat</span><br><span class="line">	缺点</span><br><span class="line">		不能使用jsp，优化定制比较复杂</span><br><span class="line">		</span><br><span class="line">外置的servlet容器</span><br><span class="line">		应用是  以 war包的方式打包</span><br><span class="line">		选择 war包，创建项目得时候</span><br></pre></td></tr></table></figure>



<h1 id="8-Springboot与数据访问"><a href="#8-Springboot与数据访问" class="headerlink" title="8.Springboot与数据访问"></a>8.Springboot与数据访问</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">对于数据访问层，无论是 SQL还是 NOSQL 默认采用整合spring Data的方式进行统一处理，</span><br><span class="line">测试相关 SQL相关，NoSQL再缓存，消息，检索等章节测试  </span><br><span class="line">		JDBC  MYbatis  Jpa</span><br><span class="line">		</span><br><span class="line">		自定义数据源</span><br><span class="line">		使用</span><br></pre></td></tr></table></figure>

<h2 id="8-1数据源类型执行sql原生jdbc"><a href="#8-1数据源类型执行sql原生jdbc" class="headerlink" title="8.1数据源类型执行sql原生jdbc"></a>8.1数据源类型执行sql原生jdbc</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">DataSourceInitiaalizer:ApplicationListerner</span><br><span class="line">	可以使用</span><br><span class="line">		schema</span><br><span class="line">			指定sql文件位置</span><br></pre></td></tr></table></figure>

<h2 id="8-2整合mybatis"><a href="#8-2整合mybatis" class="headerlink" title="8.2整合mybatis"></a>8.2整合mybatis</h2><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;org.mybatis.spring.boot&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;mybatis-spring-boot-starter&lt;/artifactId&gt;</span><br><span class="line">            &lt;version&gt;2.1.2&lt;/version&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br></pre></td></tr></table></figure>

<h2 id="8-3SpringData"><a href="#8-3SpringData" class="headerlink" title="8.3SpringData"></a>8.3SpringData</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">简化数据访问操作</span><br><span class="line">	<span class="number">1.</span>统一数据访问的api</span><br><span class="line"></span><br><span class="line">	<span class="number">2.</span>统一的repository统一接口</span><br><span class="line">	</span><br><span class="line">	<span class="number">3.</span>Jpa和SpringData   </span><br></pre></td></tr></table></figure>

<h3 id="8-3-1整合api"><a href="#8-3-1整合api" class="headerlink" title="8.3.1整合api"></a>8.3.1整合api</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>编写一个实体类和数据表进行映射</span><br><span class="line">	Entity   告诉这是一个实体类</span><br><span class="line">	<span class="meta">@Table(name = &quot;tbl_user&quot;)</span>  和数据表对应的类 指定和那个数据表对应</span><br><span class="line">	<span class="meta">@id</span>   标注这是一个主键</span><br><span class="line">	<span class="meta">@Column()</span> 这是和数据表对应的一个列  省略的话就是属性</span><br><span class="line"><span class="number">2.</span>编写Dao接口操作实体类对应的数据表</span><br><span class="line">	继承 Reporsitory  泛型写 实体类型和主键的类型</span><br><span class="line"><span class="number">3.</span>基本的配置</span><br><span class="line">	yml</span><br><span class="line">	jpa:</span><br><span class="line">	  hibernate:</span><br><span class="line">	  	ddl-auto: update</span><br><span class="line">	  show-sql: <span class="keyword">true</span>	</span><br></pre></td></tr></table></figure>

<h1 id="9-SpringBoot-与-缓存"><a href="#9-SpringBoot-与-缓存" class="headerlink" title="9.SpringBoot 与 缓存"></a>9.SpringBoot 与 缓存</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">JSR-<span class="number">107</span>  五个核心接口 cacheingprovider cachaeManager cache  entry  expiry</span><br><span class="line">Spring缓存抽象  简化缓存  ，可以使用 Jsr-<span class="number">107</span>的注解</span><br><span class="line">整合redis</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="9-1ConcurrentMapCacheManage"><a href="#9-1ConcurrentMapCacheManage" class="headerlink" title="9.1ConcurrentMapCacheManage"></a>9.1ConcurrentMapCacheManage</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>搭建环境</span><br><span class="line">	导入数据库文件</span><br><span class="line">	创建javabean对象</span><br><span class="line">	整合mybatis</span><br><span class="line">		<span class="number">1.</span>配置数据源</span><br><span class="line">		<span class="number">2.</span>注解版本的mybatis  扫描mapper  声明mapper类</span><br><span class="line">		<span class="meta">@MapperScan(&quot;com.cache.springcache.mapper&quot;)</span></span><br><span class="line">		<span class="meta">@SpringBootApplication</span></span><br><span class="line">		</span><br><span class="line">		<span class="meta">@Component</span></span><br><span class="line">		<span class="meta">@Mapper</span></span><br><span class="line">		</span><br><span class="line">		体验缓存</span><br><span class="line">			<span class="number">1.</span>开启基于注解的缓存		<span class="meta">@EnableCaching</span></span><br><span class="line">			<span class="number">2.</span>标注缓存注解即可</span><br><span class="line">				<span class="meta">@cacheable</span>  根据方法的请求参数对结果进行缓存</span><br><span class="line">					CahceManager 管理多个cache组件, 指定缓存管理器，</span><br><span class="line">					对结果进行缓存，以后要是相同的数据，直接从缓存中获取</span><br><span class="line">					cachenames/values 指定缓存名字，可以指定多个缓存</span><br><span class="line">					key  缓存数据时候用的key:指定  默认是方法参数的值 <span class="number">1</span> <span class="number">2</span> <span class="number">3</span></span><br><span class="line">							支持SPEL表达式   指定要放行的key具体的值</span><br><span class="line">					condition  指定符合条件下的 才能被缓存</span><br><span class="line">							condition = <span class="string">&quot;#id&gt;0&quot;</span></span><br><span class="line">					unless  和condition相反  unless = <span class="string">&quot;#result == null&quot;</span></span><br><span class="line">					sync  指定异步</span><br><span class="line">				<span class="meta">@cahceEvict</span>  清除缓存</span><br><span class="line">					删除某个数据，清除缓存数据</span><br><span class="line">					<span class="meta">@CacheEvict(value = &quot;emp&quot; key = &quot;#id&quot;)</span></span><br><span class="line">					allEntries = <span class="keyword">true</span>  缓存都删除不指定key</span><br><span class="line">					beforeInvocation = <span class="keyword">false</span>  缓存的清除是否在方法之前执行</span><br><span class="line">						<span class="keyword">false</span> 之后  默认数据</span><br><span class="line">				<span class="meta">@cacheput</span>  保证方法被调用，希望结果被缓存</span><br><span class="line">					更新缓存数据，例如修改了数据库的某个数据，同时更新数据</span><br><span class="line">					<span class="number">1.</span>先调用目标方法</span><br><span class="line">					<span class="number">2.</span>将目标方法缓存起来</span><br><span class="line">				数据多了，进行多个配置</span><br><span class="line">				<span class="meta">@Caching</span> (</span><br><span class="line">					cacheable = &#123;</span><br><span class="line">                        <span class="meta">@Cacheable()</span></span><br><span class="line">					&#125;,</span><br><span class="line">					put = &#123;</span><br><span class="line">                        <span class="meta">@CachePut()</span></span><br><span class="line">					&#125;</span><br><span class="line">				)</span><br><span class="line">					注意只要加了 Cache就一定会执行这个方法</span><br><span class="line">				<span class="meta">@CacheConfig(value = &quot;emp&quot;)</span></span><br><span class="line">					加到类上面，这个类里面的方法都缓存为同一个名字</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="9-2redis"><a href="#9-2redis" class="headerlink" title="9.2redis"></a>9.2redis</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">实际开发中  使用缓存中间件  redis ,ehcache, memcached</span><br><span class="line">整合redis 作为缓存</span><br><span class="line">是一个开源的，内存中的数据结构存储系统，它可以作为数据库，缓存，消息中间件，支持多种数据结构</span><br><span class="line"></span><br><span class="line">安装redis</span><br><span class="line">		docker pull redis</span><br><span class="line">		docker run -d --name myredis -p <span class="number">6379</span>:<span class="number">6379</span> redis --requirepass <span class="string">&quot;mypassword&quot;</span></span><br><span class="line"></span><br><span class="line">整合redis缓存</span><br><span class="line">	&lt;!--引入redis--&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;spring-boot-starter-data-redis&lt;/artifactId&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line">配置文件</span><br><span class="line">	spring.redis.host=<span class="number">47.101</span><span class="number">.212</span><span class="number">.62</span></span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">    StringRedisTemplate stringRedisTemplate;</span><br><span class="line">    	操作字符串</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    RedisTemplate redisTemplate;</span><br><span class="line">    	操作字符串</span><br><span class="line">语法</span><br><span class="line">	* redis常见五大类</span><br><span class="line">    * String List Set Hash ZSet</span><br><span class="line">    </span><br><span class="line">     <span class="comment">/*保存数据redis*/</span></span><br><span class="line">        stringRedisTemplate.opsForValue().append(<span class="string">&quot;msg&quot;</span>,<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">     <span class="comment">/*redis读取数据*/</span></span><br><span class="line">        String msg = stringRedisTemplate.opsForValue().get(<span class="string">&quot;msg&quot;</span>);</span><br><span class="line">        System.out.println(msg);</span><br><span class="line">  默认如果保存对象，使用jdk序列化对象，序列化后的数据保存在redis中</span><br><span class="line">  切换系列化对象  配置类</span><br><span class="line">  <span class="number">1.</span></span><br><span class="line">  	<span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">redisConfig</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> RedisTemplate&lt;Object, Employee&gt; <span class="title">empredisTemplate</span><span class="params">(RedisConnectionFactory 	redisConnectionFactory)</span> <span class="keyword">throws</span> UnknownHostException </span>&#123;</span><br><span class="line">        RedisTemplate&lt;Object, Employee&gt; template = <span class="keyword">new</span> RedisTemplate();</span><br><span class="line">        template.setConnectionFactory(redisConnectionFactory);</span><br><span class="line">        Jackson2JsonRedisSerializer&lt;Employee&gt; serializer = <span class="keyword">new</span>  Jackson2JsonRedisSerializer&lt;Employee&gt;(Employee.class);</span><br><span class="line">        template.setDefaultSerializer(serializer);</span><br><span class="line">        <span class="keyword">return</span> template;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">	<span class="number">2.</span></span><br><span class="line">	<span class="comment">/*自动注入</span></span><br><span class="line"><span class="comment">    * */</span></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    RedisTemplate&lt;Object,Employee&gt; employeeRedisTemplate;</span><br><span class="line">    <span class="number">3.</span></span><br><span class="line">     <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Test3</span><span class="params">()</span></span>&#123;</span><br><span class="line">        Employee employee = employeeMapper.getEmpById(<span class="number">1</span>);</span><br><span class="line">        employeeRedisTemplate.opsForValue().set(<span class="string">&quot;emp-01&quot;</span>,employee);</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        * 1.将redis以json的方法保存</span></span><br><span class="line"><span class="comment">        * 自己将对象转化为json</span></span><br><span class="line"><span class="comment">        * redisTemplate默认的序列化规则</span></span><br><span class="line"><span class="comment">        * */</span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h3 id="9-2-1测试缓存"><a href="#9-2-1测试缓存" class="headerlink" title="9.2.1测试缓存"></a>9.2.1测试缓存</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">原理 缓存管理器</span><br><span class="line">默认保存数据 特别是  kv都是对象时候  用序列化来保存的</span><br><span class="line"></span><br><span class="line">保存为json<span class="string">&#x27;</span></span><br><span class="line"><span class="string">	自定义cacheManager</span></span><br></pre></td></tr></table></figure>

<h1 id="10-消息队列"><a href="#10-消息队列" class="headerlink" title="10.消息队列"></a>10.消息队列</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">中间件</span><br><span class="line">	可以通过消息服务中间件来提升系统异步通信，扩展解耦能力</span><br><span class="line">	</span><br><span class="line">	两个概念</span><br><span class="line">	消息代理  消息中间间服务器，服务器把消息传送到目的地</span><br><span class="line">	</span><br><span class="line">	目的地</span><br><span class="line">	队列 点对点消息通信</span><br><span class="line">		消息只有唯一的发送者和接受者，但是不一定只有一个接收者</span><br><span class="line">	主题 发布，订阅 消息通信 </span><br><span class="line">		发布者发送消息到主题，多个接收者订阅这个主题，那么消息就会同时收到</span><br><span class="line">		</span><br><span class="line"></span><br><span class="line">	JMS  java消息服务</span><br><span class="line">		基于jvm消息代理的规范，ActiveMQ,HornetMQ是  JMS实现</span><br><span class="line">	AMQP</span><br><span class="line">		高级消息队列协议  兼容 JMS</span><br><span class="line">		RabbitMQ</span><br><span class="line">	</span><br></pre></td></tr></table></figure>

<h2 id="10-1RabbitMQ"><a href="#10-1RabbitMQ" class="headerlink" title="10.1RabbitMQ"></a>10.1RabbitMQ</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">message</span><br><span class="line">	消息，由消息头，消息体构成，消息体不透明，消息头包括路由键 routing-key,priority,delivery-mode等</span><br><span class="line">publisher</span><br><span class="line">	消息的生产者，也是一个向交换器发布消息的客户端应用程序</span><br><span class="line">Exchange</span><br><span class="line">	交换器，用来接受生产者发送的消息并且将这些消息	路由给服务器队列</span><br><span class="line">	</span><br><span class="line">	概念</span><br><span class="line">		Queue	队列</span><br><span class="line">		Binding  绑定</span><br><span class="line">		Connect	 网络连接</span><br><span class="line">		Channel  信道</span><br><span class="line">		Consumer 消费者</span><br><span class="line">		Virtual Host 虚拟主机</span><br><span class="line">		broker  表示消息队列服务器主体</span><br><span class="line">		</span><br><span class="line">		Direct Exchange   匹配单播模式</span><br><span class="line">		Fanout Exchange   广播模式速度最快</span><br><span class="line">		Topic Exchange	  多个消息匹配一个队列</span><br></pre></td></tr></table></figure>

<h2 id="10-2安装使用"><a href="#10-2安装使用" class="headerlink" title="10.2安装使用"></a>10.2安装使用</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">docker pull rabbitmq:<span class="number">3</span>-management</span><br><span class="line">docker run -d -p <span class="number">5672</span>:<span class="number">5672</span> -p <span class="number">15672</span>:<span class="number">15672</span> --name myrabbit 5537c2a8f7c5</span><br><span class="line"></span><br><span class="line">默认账号密码  guest   guest</span><br><span class="line"><span class="comment">//中国镜像</span></span><br><span class="line">docker pull registry.docker-cn.com/library/ubuntu:<span class="number">16.04</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Direct Exchange   匹配单播模式    点对点   key值对应</span><br><span class="line">Fanout Exchange   广播模式速度最快   全部发出去  全部收到</span><br><span class="line">Topic Exchange	  多个消息匹配一个队列  任意匹配一个就可以收到</span><br><span class="line"></span><br><span class="line">配置</span><br><span class="line">spring.rabbitmq.host=<span class="number">47.101</span><span class="number">.212</span><span class="number">.62</span></span><br><span class="line">spring.rabbitmq.username=guest</span><br><span class="line">spring.rabbitmq.password=guest</span><br><span class="line">spring.rabbitmq.port=<span class="number">5672</span></span><br><span class="line"></span><br><span class="line">测试</span><br><span class="line">	 <span class="comment">//rabbitTemplate.send(exchange,routekey,message);</span></span><br><span class="line">	 <span class="comment">//发送***********有问题</span></span><br><span class="line">	  Map&lt;String,Object&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        map.put(<span class="string">&quot;msg&quot;</span>,<span class="string">&quot;第一个消息&quot;</span>);</span><br><span class="line">        map.put(<span class="string">&quot;data&quot;</span>, Arrays.asList(<span class="string">&quot;helloword&quot;</span>,<span class="number">123</span>,<span class="keyword">true</span>));</span><br><span class="line">        rabbitTemplate.convertAndSend(<span class="string">&quot;exchange.dircet&quot;</span>,<span class="string">&quot;atguigu.news&quot;</span>,map)</span><br><span class="line">     <span class="comment">//接受</span></span><br><span class="line">     	Object o = rabbitTemplate.receiveAndConvert(<span class="string">&quot;atguigu.news&quot;</span>);</span><br><span class="line">        System.out.println(o);</span><br><span class="line">        </span><br><span class="line">      <span class="comment">//配置自动转化   json</span></span><br><span class="line">      <span class="meta">@Configuration</span></span><br><span class="line">        <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyRabbitmq</span> </span>&#123;</span><br><span class="line">            <span class="meta">@Bean</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> MessageConverter <span class="title">messageConverter</span><span class="params">()</span></span>&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> Jackson2JsonMessageConverter();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        </span><br></pre></td></tr></table></figure>

<h2 id="10-3监听"><a href="#10-3监听" class="headerlink" title="10.3监听"></a>10.3监听</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@EnableRabbit</span>  开启注解  在  springboot启动项目</span><br><span class="line"><span class="comment">//业务层</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BookService</span> </span>&#123;</span><br><span class="line">    <span class="comment">//如果收到消息  将会触发</span></span><br><span class="line">    <span class="meta">@RabbitListener(queues = &quot;atguigu.news&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">receive</span><span class="params">(Book book)</span></span>&#123;</span><br><span class="line">        System.out.println(book);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="10-4程序中创建交换器和路由AmqpAdmin"><a href="#10-4程序中创建交换器和路由AmqpAdmin" class="headerlink" title="10.4程序中创建交换器和路由AmqpAdmin"></a>10.4程序中创建交换器和路由AmqpAdmin</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">创建和删除队列  exchange  , bind等</span><br><span class="line"></span><br><span class="line"> <span class="meta">@Autowired</span></span><br><span class="line">    AmqpAdmin amqpAdmin;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">createExchange</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//amqpAdmin.declareExchange(new DirectExchange(&quot;amqpadmin.exchange&quot;));</span></span><br><span class="line">        <span class="comment">//amqpAdmin.declareQueue(new Queue(&quot;adqpadmin.queue&quot;));</span></span><br><span class="line">        amqpAdmin.declareBinding(<span class="keyword">new</span> Binding(<span class="string">&quot;adqpadmin.queue&quot;</span>, Binding.DestinationType.QUEUE,<span class="string">&quot;amqpadmin.exchange&quot;</span>,<span class="string">&quot;amqp.haha&quot;</span>,<span class="keyword">null</span>));</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h1 id="11-springboot检索"><a href="#11-springboot检索" class="headerlink" title="11.springboot检索"></a>11.springboot检索</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line">javaElasticSearch检索  分布式搜索服务，提供restful服务，底层基于Lucene</span><br><span class="line">docker pull registry.docker-cn.com/library/elasticsearch</span><br><span class="line"></span><br><span class="line">配置阿里云docker镜像加速</span><br><span class="line">sudo mkdir -p /etc/docker</span><br><span class="line">sudo tee /etc/docker/daemon.json &lt;&lt;-<span class="string">&#x27;EOF&#x27;</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;registry-mirrors&quot;</span>: [<span class="string">&quot;https://rxamftpx.mirror.aliyuncs.com&quot;</span>]</span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br><span class="line">sudo systemctl daemon-reload</span><br><span class="line">sudo systemctl restart docker</span><br><span class="line"></span><br><span class="line">访问  ：<span class="number">9200</span> 端口在浏览器</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">存储员工数据</span><br><span class="line">	PUT /megacorp/employee/<span class="number">1</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">&quot;first_name&quot;</span> : <span class="string">&quot;John&quot;</span>,</span><br><span class="line">            <span class="string">&quot;last_name&quot;</span> :  <span class="string">&quot;Smith&quot;</span>,</span><br><span class="line">            <span class="string">&quot;age&quot;</span> :        <span class="number">25</span>,</span><br><span class="line">            <span class="string">&quot;about&quot;</span> :      <span class="string">&quot;I love to go rock climbing&quot;</span>,</span><br><span class="line">            <span class="string">&quot;interests&quot;</span>: [ <span class="string">&quot;sports&quot;</span>, <span class="string">&quot;music&quot;</span> ]</span><br><span class="line">        &#125;</span><br><span class="line">获取员工数据</span><br><span class="line">	GEt /megacorp/employee/<span class="number">1</span></span><br><span class="line">	</span><br><span class="line">删除</span><br><span class="line">	Delete /megacorp/employee/<span class="number">1</span></span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">搜索所有员工</span><br><span class="line"></span><br><span class="line">	GET /megacorp/employee/_search</span><br><span class="line"></span><br><span class="line">尝试下搜索姓氏为 ``Smith`` 的雇员</span><br><span class="line">	GET /megacorp/employee/_search?q=last_name:Smith</span><br><span class="line"></span><br><span class="line">使用查询表达式搜索</span><br><span class="line">	GET /megacorp/employee/_search</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">&quot;query&quot;</span> : &#123;</span><br><span class="line">                <span class="string">&quot;match&quot;</span> : &#123;</span><br><span class="line">                    <span class="string">&quot;last_name&quot;</span> : <span class="string">&quot;Smith&quot;</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">复杂的搜素</span><br><span class="line">	GET /megacorp/employee/_search</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">&quot;query&quot;</span> : &#123;</span><br><span class="line">                <span class="string">&quot;bool&quot;</span>: &#123;</span><br><span class="line">                    <span class="string">&quot;must&quot;</span>: &#123;</span><br><span class="line">                        <span class="string">&quot;match&quot;</span> : &#123;</span><br><span class="line">                            <span class="string">&quot;last_name&quot;</span> : <span class="string">&quot;smith&quot;</span> </span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;,</span><br><span class="line">                    <span class="string">&quot;filter&quot;</span>: &#123;</span><br><span class="line">                        <span class="string">&quot;range&quot;</span> : &#123;</span><br><span class="line">                            <span class="string">&quot;age&quot;</span> : &#123; <span class="string">&quot;gt&quot;</span> : <span class="number">30</span> &#125; </span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"> 全文搜素</span><br><span class="line"> 	GET /megacorp/employee/_search</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">&quot;query&quot;</span> : &#123;</span><br><span class="line">                <span class="string">&quot;match&quot;</span> : &#123;</span><br><span class="line">                    <span class="string">&quot;about&quot;</span> : <span class="string">&quot;rock climbing&quot;</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">  短语搜素 完整匹配</span><br><span class="line">  	GET /megacorp/employee/_search</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">&quot;query&quot;</span> : &#123;</span><br><span class="line">                <span class="string">&quot;match_phrase&quot;</span> : &#123;</span><br><span class="line">                    <span class="string">&quot;about&quot;</span> : <span class="string">&quot;rock climbing&quot;</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">   高亮搜索</span><br><span class="line">   	GET /megacorp/employee/_search</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">&quot;query&quot;</span> : &#123;</span><br><span class="line">                <span class="string">&quot;match_phrase&quot;</span> : &#123;</span><br><span class="line">                    <span class="string">&quot;about&quot;</span> : <span class="string">&quot;rock climbing&quot;</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="string">&quot;highlight&quot;</span>: &#123;</span><br><span class="line">                <span class="string">&quot;fields&quot;</span> : &#123;</span><br><span class="line">                    <span class="string">&quot;about&quot;</span> : &#123;&#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>

<h2 id="11-1springboot整合"><a href="#11-1springboot整合" class="headerlink" title="11.1springboot整合"></a>11.1springboot整合</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">springboot默认使用springdata来操作  ElasticSearch</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Autowired</span></span><br><span class="line">    BookRepository bookRepository;</span><br><span class="line"></span><br><span class="line">仓库</span><br><span class="line">	<span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">BookRepository</span> <span class="keyword">extends</span> <span class="title">ElasticsearchRepository</span>&lt;<span class="title">Book</span>,<span class="title">Integer</span>&gt; </span>&#123;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">Bean  实体类</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">contextLoads</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Book book = <span class="keyword">new</span> Book();</span><br><span class="line">        book.setId(<span class="number">1</span>);</span><br><span class="line">        book.setAuthor(<span class="string">&quot;吴承恩&quot;</span>);</span><br><span class="line">        book.setBookName(<span class="string">&quot;西游记&quot;</span>);</span><br><span class="line">        bookRepository.index(book);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h1 id="12-springboot-异步任务"><a href="#12-springboot-异步任务" class="headerlink" title="12.springboot 异步任务"></a>12.springboot 异步任务</h1><p>快速体验</p>
<p>​    正常情况</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">hello</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        Thread.sleep(<span class="number">3000</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    System.out.println(<span class="string">&quot;处理数据中！！&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">开启异步注解</span><br><span class="line">	<span class="meta">@Async</span> 放在运行方法上面</span><br><span class="line">        <span class="comment">//开启异步注解</span></span><br><span class="line">    <span class="meta">@EnableAsync</span></span><br><span class="line">    <span class="meta">@SpringBootApplication</span></span><br></pre></td></tr></table></figure>

<h2 id="12-1定时任务"><a href="#12-1定时任务" class="headerlink" title="12.1定时任务"></a>12.1定时任务</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@EnableScheduling</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span>  开启定时任务</span><br><span class="line"></span><br><span class="line"><span class="comment">// second,minutes,hour,day of month,month,day of week</span></span><br><span class="line">    <span class="meta">@Scheduled(cron = &quot;0 * * * * MON-SAT&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">hello</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;启动&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    指定什么时候启动</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//没4秒执行一次</span></span><br><span class="line">     <span class="meta">@Scheduled(cron = &quot;0/4 * * * * MON-SAT&quot;)</span></span><br></pre></td></tr></table></figure>

<h2 id="12-2邮件任务"><a href="#12-2邮件任务" class="headerlink" title="12.2邮件任务"></a>12.2邮件任务</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">   &lt;!--引入邮件任务--&gt;</span><br><span class="line">      &lt;dependency&gt;</span><br><span class="line">          &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">          &lt;artifactId&gt;spring-boot-starter-mail&lt;/artifactId&gt;</span><br><span class="line">      &lt;/dependency&gt;</span><br><span class="line">      </span><br><span class="line">    关闭qq邮箱服务</span><br><span class="line">    配置</span><br><span class="line">    	spring.mail.username=<span class="number">1092283755</span><span class="meta">@qq</span>.com</span><br><span class="line">spring.mail.password=eqldanvdgggcfhhc</span><br><span class="line">spring.mail.host=smtp.qq.com</span><br><span class="line">spring.mail.properties.mail.smtp.ssl.enable=<span class="keyword">true</span></span><br><span class="line">测试类</span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">  JavaMailSenderImpl mailSender;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Test</span></span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">contextLoads</span><span class="params">()</span> </span>&#123;</span><br><span class="line">      SimpleMailMessage message = <span class="keyword">new</span> SimpleMailMessage();</span><br><span class="line">      <span class="comment">//设置邮件信息</span></span><br><span class="line">      message.setSubject(<span class="string">&quot;通知&quot;</span>);</span><br><span class="line">      message.setText(<span class="string">&quot;今晚7.30开会&quot;</span>);</span><br><span class="line">      message.setTo(<span class="string">&quot;ryhweo@163.com&quot;</span>);</span><br><span class="line">      message.setFrom(<span class="string">&quot;1092283755@qq.com&quot;</span>);</span><br><span class="line">      mailSender.send(message);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  发送附件图片</span><br><span class="line">  	MimeMessage mimeMessage = mailSender.createMimeMessage();</span><br><span class="line">      <span class="comment">//设置邮件信息</span></span><br><span class="line">      MimeMessageHelper mimeMessageHelper = <span class="keyword">new</span> MimeMessageHelper(mimeMessage, <span class="keyword">true</span>);</span><br><span class="line">      mimeMessageHelper.setText(<span class="string">&quot;今晚7.30开会&quot;</span>);</span><br><span class="line">      mimeMessageHelper.setTo(<span class="string">&quot;ryhweo@163.com&quot;</span>);</span><br><span class="line">      mimeMessageHelper.setFrom(<span class="string">&quot;1092283755@qq.com&quot;</span>);</span><br><span class="line">      mimeMessageHelper.setSubject(<span class="string">&quot;通知2&quot;</span>);</span><br><span class="line">      mimeMessageHelper.addAttachment(<span class="string">&quot;1.jpg&quot;</span>,<span class="keyword">new</span> File(<span class="string">&quot;C:\\Users\\Administrator\\Desktop\\太阳池.jpg&quot;</span>));</span><br><span class="line">      mailSender.send(mimeMessage);</span><br></pre></td></tr></table></figure>

<h1 id="13-springboot和安全"><a href="#13-springboot和安全" class="headerlink" title="13.springboot和安全"></a>13.springboot和安全</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">shiro</span><br><span class="line">springsecurity</span><br></pre></td></tr></table></figure>

<h2 id="13-1认证和授权"><a href="#13-1认证和授权" class="headerlink" title="13.1认证和授权"></a>13.1认证和授权</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>引入springsecurity模块</span><br><span class="line">	&lt;!--引入springsecurity--&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line"><span class="number">2.</span>编写一个配置类</span><br><span class="line">    <span class="meta">@EnableWebSecurity</span></span><br><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MysecurityConfig</span> <span class="keyword">extends</span> <span class="title">WebSecurityConfigurerAdapter</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="number">3.</span>编写权限</span><br><span class="line">	http.authorizeRequests().antMatchers(<span class="string">&quot;/&quot;</span>).permitAll()</span><br><span class="line">                .antMatchers(<span class="string">&quot;/level1/**&quot;</span>).hasRole(<span class="string">&quot;Vip1&quot;</span>)</span><br><span class="line">                .antMatchers(<span class="string">&quot;/level2/**&quot;</span>).hasRole(<span class="string">&quot;Vip2&quot;</span>)</span><br><span class="line">                .antMatchers(<span class="string">&quot;/level3/**&quot;</span>).hasRole(<span class="string">&quot;Vip3&quot;</span>);</span><br><span class="line"><span class="number">4.</span>登录页</span><br><span class="line">	开启自动配置的登录功能</span><br><span class="line">	<span class="comment">//如果没有权限来到登陆页面</span></span><br><span class="line">        http.formLogin();</span><br><span class="line"><span class="number">5.</span>分配授权</span><br><span class="line">	<span class="comment">//super.configure(auth);</span></span><br><span class="line">         auth.inMemoryAuthentication().passwordEncoder(<span class="keyword">new</span> BCryptPasswordEncoder()).withUser(<span class="string">&quot;zhangsan&quot;</span>).password(<span class="keyword">new</span> BCryptPasswordEncoder().encode(<span class="string">&quot;123&quot;</span>)).roles(<span class="string">&quot;Vip1&quot;</span>,<span class="string">&quot;Vip2&quot;</span>)</span><br><span class="line">                .and()</span><br><span class="line">                .withUser(<span class="string">&quot;lisi&quot;</span>).password(<span class="keyword">new</span> BCryptPasswordEncoder().encode(<span class="string">&quot;123&quot;</span>)).roles(<span class="string">&quot;Vip2&quot;</span>,<span class="string">&quot;Vip3&quot;</span>)</span><br><span class="line">                .and()</span><br><span class="line">                .withUser(<span class="string">&quot;wangwu&quot;</span>).password(<span class="keyword">new</span> BCryptPasswordEncoder().encode(<span class="string">&quot;123&quot;</span>)).roles(<span class="string">&quot;Vip1&quot;</span>,<span class="string">&quot;Vip3&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="14-分布式dubbo-zookeeper"><a href="#14-分布式dubbo-zookeeper" class="headerlink" title="14.分布式dubbo+zookeeper"></a>14.分布式dubbo+zookeeper</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">zookeeper  注册中心</span><br><span class="line">dubbo 	分布式服务框架</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">安装 zookeeper </span><br><span class="line">	docker pull zookeeper</span><br><span class="line">	<span class="number">1.</span>引入dubbo和zookeeper</span><br><span class="line">		&lt;!--引入dubbo--&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;com.alibaba.boot&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;dubbo-spring-boot-starter&lt;/artifactId&gt;</span><br><span class="line">            &lt;version&gt;0.1.0&lt;/version&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line">        &lt;!--引入zookeeper客户端工具--&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;com.github.sgroschupf&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;zkclient&lt;/artifactId&gt;</span><br><span class="line">            &lt;version&gt;0.1&lt;/version&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line">     <span class="number">2.</span>配置dubbo的扫描包和相关注册中心</span><br><span class="line">     	dubbo.application.name=provider_ticket</span><br><span class="line">		dubbo.registry.address=zookeeper:<span class="comment">//47.101.212.62:2181</span></span><br><span class="line">		dubbo.scan.base-packages=com.it.Service</span><br><span class="line">     <span class="number">3.</span>使用<span class="meta">@service</span> 发布服务</span><br><span class="line">     <span class="meta">@Component</span></span><br><span class="line">	<span class="meta">@Service</span></span><br><span class="line">	<span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TicketServiceImpl</span> <span class="keyword">implements</span> <span class="title">TicketService</span></span>&#123;</span><br></pre></td></tr></table></figure>

<h1 id="15-springboot和springcloud"><a href="#15-springboot和springcloud" class="headerlink" title="15.springboot和springcloud"></a>15.springboot和springcloud</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Eureka  服务发现</span><br><span class="line">Ribbon 客户端负载均衡</span><br><span class="line">Hystrix 断路器</span><br><span class="line">ZUUL 服务网关</span><br><span class="line">springcloud 分布式配置</span><br></pre></td></tr></table></figure>

<h2 id="15-1配置"><a href="#15-1配置" class="headerlink" title="15.1配置"></a>15.1配置</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">配置 eureka</span><br><span class="line">server:</span><br><span class="line">  port: <span class="number">8761</span></span><br><span class="line">eureka:</span><br><span class="line">  instance:</span><br><span class="line">    hostname: eureka-server #实例的主机名字</span><br><span class="line">  client:</span><br><span class="line">    register-with-eureka: false #不把自己注册</span><br><span class="line">    fetch-registry: false #不从eureka上获取服务注册信息</span><br><span class="line">    service-url:</span><br><span class="line">      defaultZone: http:<span class="comment">//localhost:8761/eureka/</span></span><br><span class="line">      </span><br><span class="line">      开启服务</span><br><span class="line">      <span class="meta">@EnableEurekaServer</span></span><br><span class="line">   </span><br><span class="line">  配置提供者</span><br><span class="line">server:</span><br><span class="line">  port: <span class="number">8001</span></span><br><span class="line">spring:</span><br><span class="line">  application:</span><br><span class="line">    name: provider-ticket</span><br><span class="line">eureka:</span><br><span class="line">  instance:</span><br><span class="line">    prefer-ip-address: true #注册服务使用服务的ip</span><br><span class="line">  client:</span><br><span class="line">    service-url:</span><br><span class="line">      defaultZone: http:<span class="comment">//localhost:8761/eureka/</span></span><br><span class="line">      </span><br><span class="line">   配置消费者</span><br><span class="line">server:</span><br><span class="line">  port: <span class="number">8200</span></span><br><span class="line">spring:</span><br><span class="line">  application:</span><br><span class="line">    name: consumer</span><br><span class="line">eureka:</span><br><span class="line">  instance:</span><br><span class="line">    prefer-ip-address: true #注册服务使用服务的ip</span><br><span class="line">  client:</span><br><span class="line">    service-url:</span><br><span class="line">      defaultZone: http:<span class="comment">//localhost:8761/eureka/</span></span><br><span class="line">      </span><br><span class="line">  开启发现服务功能</span><br><span class="line">  <span class="meta">@EnableDiscoveryClient</span></span><br><span class="line">  controller  写   <span class="function">RestTemplate    <span class="title">getforobject</span><span class="params">(<span class="string">&quot;http://PROVIDER-TICKET/tivket&quot;</span>,String.class)</span></span></span><br></pre></td></tr></table></figure>

<h2 id="17-java发请求和转化json"><a href="#17-java发请求和转化json" class="headerlink" title="17.java发请求和转化json"></a>17.java发请求和转化json</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">转化json<span class="string">&#x27;</span></span><br><span class="line"><span class="string">	 JSONObject json = JSONObject.parseObject(forObject);</span></span><br><span class="line"><span class="string">	 &lt;dependency&gt;</span></span><br><span class="line"><span class="string">            &lt;groupId&gt;com.alibaba&lt;/groupId&gt;</span></span><br><span class="line"><span class="string">            &lt;artifactId&gt;fastjson&lt;/artifactId&gt;</span></span><br><span class="line"><span class="string">            &lt;version&gt;1.2.9&lt;/version&gt;</span></span><br><span class="line"><span class="string">        &lt;/dependency&gt;</span></span><br><span class="line"><span class="string">发请求</span></span><br><span class="line"><span class="string">	 public ArrayList&lt;Object&gt; today(String cityname)&#123;</span></span><br><span class="line"><span class="string">        //配置代理发送请求</span></span><br><span class="line"><span class="string">        System.out.println(cityname);</span></span><br><span class="line"><span class="string">        ArrayList&lt;Object&gt; obj = new ArrayList&lt;&gt;();</span></span><br><span class="line"><span class="string">        obj.add(client(cityname));</span></span><br><span class="line"><span class="string">        System.out.println(obj);</span></span><br><span class="line"><span class="string">        return obj;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    public Object client(String cityname)&#123;</span></span><br><span class="line"><span class="string">        //url</span></span><br><span class="line"><span class="string">        String uri = &quot;http://v.juhe.cn/weather/index&quot;;</span></span><br><span class="line"><span class="string">        //key</span></span><br><span class="line"><span class="string">        String key = &quot;26a341912ab49adbcf14685a286031a2&quot;;</span></span><br><span class="line"><span class="string">        //map</span></span><br><span class="line"><span class="string">        Map&lt;String,String&gt; map = new HashMap&lt;&gt;();</span></span><br><span class="line"><span class="string">        //params</span></span><br><span class="line"><span class="string">        map.put(&quot;cityname&quot;,cityname);</span></span><br><span class="line"><span class="string">        map.put(&quot;key&quot;,key);</span></span><br><span class="line"><span class="string">        RestTemplate client = new RestTemplate();</span></span><br><span class="line"><span class="string">        String forObject = client.getForObject(uri+&quot;?cityname=&#123;cityname&#125;&amp;key=&#123;key&#125;&quot;,</span></span><br><span class="line"><span class="string">                String.class,map);</span></span><br><span class="line"><span class="string">        JSONObject json = JSONObject.parseObject(forObject);</span></span><br><span class="line"><span class="string">        //响应头信息</span></span><br><span class="line"><span class="string">        //  执行HTTP请求</span></span><br><span class="line"><span class="string">        return json;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br></pre></td></tr></table></figure>

<h1 id="18-https请求和转发"><a href="#18-https请求和转发" class="headerlink" title="18.https请求和转发"></a>18.https请求和转发</h1><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">生成密钥</span><br><span class="line">keytool -genkey -alias android.keystore -keyalg RSA -validity 20000 -keystore android.keystore </span><br><span class="line">密码 123456</span><br><span class="line"></span><br><span class="line">keytool -genkey -alias tomcat -keyalg RSA -keystore tomcat.keystore</span><br><span class="line">放到根目录下面</span><br><span class="line">配置文件</span><br><span class="line">server.ssl.key-store=tomcat.keystore</span><br><span class="line">#密钥库密码</span><br><span class="line">server.ssl.key-store-password=123456</span><br><span class="line">server.ssl.keyStoreType=JKS</span><br><span class="line">server.ssl.keyAlias:tomcat</span><br><span class="line"> </span><br><span class="line">#https加密端口号 443</span><br><span class="line">server.port=443</span><br><span class="line">#SSL证书路径 一定要加上classpath:</span><br><span class="line">server.ssl.key-store=classpath:520oo.jks</span><br><span class="line">#SSL证书密码</span><br><span class="line">server.ssl.key-store-password=214215109110451</span><br><span class="line">#证书类型</span><br><span class="line">server.ssl.key-store-type=JKS</span><br><span class="line">#证书别名</span><br><span class="line">server.ssl.key-alias=alias</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">阿里巴巴官网下载证书</span><br><span class="line">用命令转化</span><br><span class="line">回车，会提示你输入三次密码，建议三次都是输入密码文本的密码，成功后会再文件夹下生成domains.jks文件</span><br><span class="line">keytool -importkeystore -srckeystore 你的证书名称.pfx -destkeystore domains.jks -srcstoretype PKCS12 -deststoretype JKS</span><br><span class="line"></span><br><span class="line">配置  pfx文件放到resources目录下</span><br><span class="line">server.ssl.key-store=classpath:zcz.pfx</span><br><span class="line">server.ssl.key-store-password=7QgFatf7</span><br><span class="line">server.ssl.keyStoreType=PKCS12</span><br></pre></td></tr></table></figure>

<h1 id="19sprinngboot跨域"><a href="#19sprinngboot跨域" class="headerlink" title="19sprinngboot跨域"></a>19sprinngboot跨域</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CorsConfig</span> <span class="keyword">implements</span> <span class="title">WebMvcConfigurer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addCorsMappings</span><span class="params">(CorsRegistry registry)</span> </span>&#123;</span><br><span class="line">        registry.addMapping(<span class="string">&quot;/**&quot;</span>)</span><br><span class="line">                .allowedOrigins(<span class="string">&quot;*&quot;</span>)</span><br><span class="line">                .allowedMethods(<span class="string">&quot;GET&quot;</span>, <span class="string">&quot;HEAD&quot;</span>, <span class="string">&quot;POST&quot;</span>, <span class="string">&quot;PUT&quot;</span>, <span class="string">&quot;DELETE&quot;</span>, <span class="string">&quot;OPTIONS&quot;</span>)</span><br><span class="line">                .allowCredentials(<span class="keyword">true</span>)</span><br><span class="line">                .maxAge(<span class="number">3600</span>)</span><br><span class="line">                .allowedHeaders(<span class="string">&quot;*&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="number">2.</span>过滤器</span><br><span class="line"><span class="meta">@WebFilter(filterName = &quot;CorsFilter &quot;)</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CorsFilter</span> <span class="keyword">implements</span> <span class="title">Filter</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest req, ServletResponse res, FilterChain chain)</span> <span class="keyword">throws</span> IOException, ServletException </span>&#123;</span><br><span class="line">        HttpServletResponse response = (HttpServletResponse) res;</span><br><span class="line">        response.setHeader(<span class="string">&quot;Access-Control-Allow-Origin&quot;</span>,<span class="string">&quot;*&quot;</span>);</span><br><span class="line">        response.setHeader(<span class="string">&quot;Access-Control-Allow-Credentials&quot;</span>, <span class="string">&quot;true&quot;</span>);</span><br><span class="line">        response.setHeader(<span class="string">&quot;Access-Control-Allow-Methods&quot;</span>, <span class="string">&quot;POST, GET, PATCH, DELETE, PUT&quot;</span>);</span><br><span class="line">        response.setHeader(<span class="string">&quot;Access-Control-Max-Age&quot;</span>, <span class="string">&quot;3600&quot;</span>);</span><br><span class="line">        response.setHeader(<span class="string">&quot;Access-Control-Allow-Headers&quot;</span>, <span class="string">&quot;Origin, X-Requested-With, Content-Type, Accept&quot;</span>);</span><br><span class="line">        chain.doFilter(req, res);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="number">3.</span>注解</span><br><span class="line">	<span class="meta">@CrossOrigin(origins = &quot;*&quot;,maxAge = 3600)</span></span><br></pre></td></tr></table></figure>

<h1 id="20-springboot返回时间类型"><a href="#20-springboot返回时间类型" class="headerlink" title="20.springboot返回时间类型"></a>20.springboot返回时间类型</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@JsonFormat(pattern=&quot;yyyy-MM-dd HH:mm:ss&quot;, timezone=&quot;GMT+8&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Date time;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"> 全局配置</span><br><span class="line"> 	spring:</span><br><span class="line">　　	jackson:</span><br><span class="line"> 		date-format: yyyy-MM-dd HH:mm:ss</span><br><span class="line"> 		time-zone: GMT+<span class="number">8</span></span><br></pre></td></tr></table></figure>

<h1 id="21-java实现qq轰炸"><a href="#21-java实现qq轰炸" class="headerlink" title="21.java实现qq轰炸"></a>21.java实现qq轰炸</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.awt.AWTException;</span><br><span class="line"><span class="keyword">import</span> java.awt.Robot;</span><br><span class="line"><span class="keyword">import</span> java.awt.Toolkit;</span><br><span class="line"><span class="keyword">import</span> java.awt.datatransfer.Clipboard;</span><br><span class="line"><span class="keyword">import</span> java.awt.datatransfer.StringSelection;</span><br><span class="line"><span class="keyword">import</span> java.awt.datatransfer.Transferable;</span><br><span class="line"><span class="keyword">import</span> java.awt.event.KeyEvent;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Springdemo1Application</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> AWTException </span>&#123;</span><br><span class="line">        SpringApplicationBuilder builder = <span class="keyword">new</span> SpringApplicationBuilder(Springdemo1Application.class);</span><br><span class="line">        <span class="comment">//SpringApplication.run(SystemctlApplication.class, args);</span></span><br><span class="line">        builder.headless(<span class="keyword">false</span>)</span><br><span class="line">                <span class="comment">// .web(WebApplicationType.NONE)</span></span><br><span class="line">                <span class="comment">// .bannerMode(Banner.Mode.OFF)</span></span><br><span class="line">                .run(args);</span><br><span class="line">        String sentence = <span class="string">&quot;从前有座山,山里有座庙,庙里有个老和尚和小和尚,和尚对小和尚说：&quot;</span>;<span class="comment">// 定义要发送的话</span></span><br><span class="line">        Robot robot = <span class="keyword">new</span> Robot();<span class="comment">// 创建Robot对象</span></span><br><span class="line">        robot.delay(<span class="number">3000</span>);<span class="comment">// 延迟三秒，主要是为了预留出打开窗口的时间，括号内的单位为毫秒</span></span><br><span class="line">        Clipboard clip = Toolkit.getDefaultToolkit().getSystemClipboard();</span><br><span class="line">        String[] authors = sentence.split(<span class="string">&quot;[,]&quot;</span>);<span class="comment">// 字符串根据,分割</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">50</span>; j++) &#123;<span class="comment">//循环次数</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; authors.length; i++) &#123;</span><br><span class="line">                String sentencet = authors[i];</span><br><span class="line">                Transferable tText = <span class="keyword">new</span> StringSelection(sentencet);</span><br><span class="line">                clip.setContents(tText, <span class="keyword">null</span>);</span><br><span class="line">                <span class="comment">// for (int j = 1; j &lt;= 1; j++) &#123;</span></span><br><span class="line">                <span class="comment">// 以下两行按下了ctrl+v，完成粘贴功能</span></span><br><span class="line">                robot.keyPress(KeyEvent.VK_CONTROL);</span><br><span class="line">                robot.keyPress(KeyEvent.VK_V);</span><br><span class="line"></span><br><span class="line">                robot.keyRelease(KeyEvent.VK_CONTROL);<span class="comment">// 释放ctrl按键，像ctrl，退格键，删除键这样的功能性按键，在按下后一定要释放，不然会出问题。crtl如果按住没有释放，在按其他字母按键是，敲出来的回事ctrl的快捷键。</span></span><br><span class="line">                robot.delay(<span class="number">100</span>);<span class="comment">// 延迟一秒再发送，不然会一次性全发布出去，因为电脑的处理速度很快，每次粘贴发送的速度几乎是一瞬间，所以给人的感觉就是一次性发送了全部。这个时间可以自己改，想几秒发送一条都可以</span></span><br><span class="line">                robot.keyPress(KeyEvent.VK_ENTER);<span class="comment">// 回车</span></span><br><span class="line">                <span class="comment">// &#125;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="22-实现jwt"><a href="#22-实现jwt" class="headerlink" title="22.实现jwt"></a>22.实现jwt</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>引入依赖</span><br><span class="line">		&lt;dependency&gt;</span><br><span class="line">              &lt;groupId&gt;com.auth0&lt;/groupId&gt;</span><br><span class="line">              &lt;artifactId&gt;java-jwt&lt;/artifactId&gt;</span><br><span class="line">              &lt;version&gt;3.4.0&lt;/version&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line"><span class="number">2.</span>token注解配置</span><br><span class="line">	<span class="comment">//用来跳过验证的 PassToken</span></span><br><span class="line">	<span class="meta">@Target(&#123;ElementType.METHOD, ElementType.TYPE&#125;)</span></span><br><span class="line">	<span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line">	<span class="keyword">public</span> <span class="meta">@interface</span> PassToken &#123;</span><br><span class="line">    	<span class="function"><span class="keyword">boolean</span> <span class="title">required</span><span class="params">()</span> <span class="keyword">default</span> <span class="keyword">true</span></span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//用于登录后才能操作</span></span><br><span class="line">	<span class="meta">@Target(&#123;ElementType.METHOD, ElementType.TYPE&#125;)</span></span><br><span class="line">    <span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="meta">@interface</span> UserLoginToken &#123;</span><br><span class="line">        <span class="function"><span class="keyword">boolean</span> <span class="title">required</span><span class="params">()</span> <span class="keyword">default</span> <span class="keyword">true</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="number">3.</span>新建一个拦截器配置 用于拦截前端请求 实现   WebMvcConfigurer </span><br><span class="line">    <span class="meta">@Configuration</span></span><br><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WebConfig</span> <span class="keyword">implements</span> <span class="title">WebMvcConfigurer</span> </span>&#123;</span><br><span class="line">        <span class="meta">@Autowired</span></span><br><span class="line">        AuthenticationInterceptor authenticationInterceptor;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addInterceptors</span><span class="params">(InterceptorRegistry registry)</span> </span>&#123;</span><br><span class="line">            registry.addInterceptor(authenticationInterceptor)</span><br><span class="line">                    .addPathPatterns(<span class="string">&quot;/**&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="comment">//    @Bean</span></span><br><span class="line">    <span class="comment">//    public AuthenticationInterceptor authenticationInterceptor() &#123;</span></span><br><span class="line">    <span class="comment">//        return new AuthenticationInterceptor();</span></span><br><span class="line">    <span class="comment">//    &#125;</span></span><br><span class="line">    &#125;</span><br><span class="line"> <span class="number">4.</span>新建一个 AuthenticationInterceptor  实现HandlerInterceptor接口  实现拦截还是放通的逻辑</span><br><span class="line"> <span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AuthenticationInterceptor</span> <span class="keyword">implements</span> <span class="title">HandlerInterceptor</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    UserService userService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">preHandle</span><span class="params">(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse, Object object)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        String token = httpServletRequest.getHeader(<span class="string">&quot;token&quot;</span>);<span class="comment">// 从 http 请求头中取出 token</span></span><br><span class="line">        <span class="comment">// 如果不是映射到方法直接通过</span></span><br><span class="line">        <span class="keyword">if</span> (!(object <span class="keyword">instanceof</span> HandlerMethod)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        HandlerMethod handlerMethod = (HandlerMethod) object;</span><br><span class="line">        Method method = handlerMethod.getMethod();</span><br><span class="line">        <span class="comment">//检查是否有passtoken注释，有则跳过认证</span></span><br><span class="line">        <span class="keyword">if</span> (method.isAnnotationPresent(PassToken.class)) &#123;</span><br><span class="line">            PassToken passToken = method.getAnnotation(PassToken.class);</span><br><span class="line">            <span class="keyword">if</span> (passToken.required()) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//检查有没有需要用户权限的注解</span></span><br><span class="line">        <span class="keyword">if</span> (method.isAnnotationPresent(UserLoginToken.class)) &#123;</span><br><span class="line">            UserLoginToken userLoginToken = method.getAnnotation(UserLoginToken.class);</span><br><span class="line">            <span class="keyword">if</span> (userLoginToken.required()) &#123;</span><br><span class="line">                <span class="comment">// 执行认证</span></span><br><span class="line">                <span class="keyword">if</span> (token == <span class="keyword">null</span>) &#123;</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">&quot;无token，请重新登录&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// 获取 token 中的 user id</span></span><br><span class="line">                String userId;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    userId = JWT.decode(token).getAudience().get(<span class="number">0</span>);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (JWTDecodeException j) &#123;</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">&quot;401&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                User user = userService.findUserById(userId);</span><br><span class="line">                <span class="keyword">if</span> (user == <span class="keyword">null</span>) &#123;</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">&quot;用户不存在，请重新登录&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// 验证 token</span></span><br><span class="line">                JWTVerifier jwtVerifier = JWT.require(Algorithm.HMAC256(user.getPassword())).build();</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    jwtVerifier.verify(token);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (JWTVerificationException e) &#123;</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">&quot;401&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">postHandle</span><span class="params">(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse, Object o, ModelAndView modelAndView)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterCompletion</span><span class="params">(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse, Object o, Exception e)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="number">5.</span>新建一个Server 用于下发Token</span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TokenService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getToken</span><span class="params">(User user)</span> </span>&#123;</span><br><span class="line">        Date start = <span class="keyword">new</span> Date();</span><br><span class="line">        <span class="keyword">long</span> currentTime = System.currentTimeMillis() + <span class="number">60</span>* <span class="number">60</span> * <span class="number">1000</span>;<span class="comment">//一小时有效时间</span></span><br><span class="line">        Date end = <span class="keyword">new</span> Date(currentTime);</span><br><span class="line">        String token = <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">        token = JWT.create().withAudience(user.getId()).withIssuedAt(start).withExpiresAt(end)</span><br><span class="line">                .sign(Algorithm.HMAC256(user.getPassword()));</span><br><span class="line">        <span class="keyword">return</span> token;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="number">6.</span>新建一个工具类 用户从token中取出用户Id</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TokenUtil</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getTokenUserId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="number">1111</span>);</span><br><span class="line">        String token = getRequest().getHeader(<span class="string">&quot;token&quot;</span>);<span class="comment">// 从 http 请求头中取出 token</span></span><br><span class="line">        String userId = JWT.decode(token).getAudience().get(<span class="number">0</span>);</span><br><span class="line">        <span class="keyword">return</span> userId;</span><br><span class="line">    &#125;</span><br><span class="line">     <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> HttpServletRequest <span class="title">getRequest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">         ServletRequestAttributes requestAttributes = (ServletRequestAttributes) RequestContextHolder</span><br><span class="line">                 .getRequestAttributes();</span><br><span class="line">         <span class="keyword">return</span> requestAttributes == <span class="keyword">null</span> ? <span class="keyword">null</span> : requestAttributes.getRequest();</span><br><span class="line">     &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="number">7.</span>新建一个简单的控制器用于验证，把token存到Session里面</span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">    UserService userService;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    TokenService tokenService;</span><br><span class="line">    <span class="meta">@GetMapping(&quot;/login&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title">login</span><span class="params">(User user, HttpServletResponse response)</span> <span class="keyword">throws</span> JSONException </span>&#123;</span><br><span class="line">        JSONObject jsonObject = <span class="keyword">new</span> JSONObject();</span><br><span class="line">        Map&lt;String,Object&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        User userForBase = <span class="keyword">new</span> User();</span><br><span class="line">        userForBase.setId(<span class="string">&quot;1&quot;</span>);</span><br><span class="line">        userForBase.setPassword(<span class="string">&quot;123&quot;</span>);</span><br><span class="line">        userForBase.setUsername(<span class="string">&quot;mrc&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!userForBase.getPassword().equals(user.getPassword())) &#123;</span><br><span class="line">            map.put(<span class="string">&quot;message&quot;</span>, <span class="string">&quot;登录失败,密码错误&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> jsonObject;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            String token = tokenService.getToken(userForBase);</span><br><span class="line">            map.put(<span class="string">&quot;token&quot;</span>, token);</span><br><span class="line">            Cookie cookie = <span class="keyword">new</span> Cookie(<span class="string">&quot;token&quot;</span>, token);</span><br><span class="line">            cookie.setPath(<span class="string">&quot;/&quot;</span>);</span><br><span class="line">            response.addCookie(cookie);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> map;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@UserLoginToken</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/getMessage&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getMessage</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 取出token中带的用户id 进行操作</span></span><br><span class="line">        TokenUtil.getTokenUserId();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;你已通过验证&quot;</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h1 id="23-实现文件的上传下载"><a href="#23-实现文件的上传下载" class="headerlink" title="23.实现文件的上传下载"></a>23.实现文件的上传下载</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UploadController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/upload&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">fileUpload</span><span class="params">(<span class="meta">@RequestParam(&quot;file&quot;)</span> MultipartFile file)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(file.isEmpty())&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;false&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        String fileName = file.getOriginalFilename();</span><br><span class="line">        <span class="keyword">int</span> size = (<span class="keyword">int</span>) file.getSize();</span><br><span class="line">        System.out.println(fileName + <span class="string">&quot;--&gt;&quot;</span> + size);</span><br><span class="line">        String path = <span class="string">&quot;D:/testupload&quot;</span> ;</span><br><span class="line">        File dest = <span class="keyword">new</span> File(path + <span class="string">&quot;/&quot;</span> + fileName);</span><br><span class="line">        <span class="keyword">if</span>(!dest.getParentFile().exists())&#123; <span class="comment">//判断文件父目录是否存在</span></span><br><span class="line">            dest.getParentFile().mkdir();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/*判断文件后缀*/</span></span><br><span class="line">        Integer last = fileName.lastIndexOf(<span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">        String dotname = fileName.substring(last+<span class="number">1</span>);</span><br><span class="line">        System.out.println(dotname);</span><br><span class="line">        <span class="comment">//创建目录</span></span><br><span class="line">        File checkexits = <span class="keyword">new</span> File(<span class="string">&quot;D:/testupload/&quot;</span>+dotname+<span class="string">&quot;/&quot;</span>);</span><br><span class="line">        System.out.println(checkexits.exists());</span><br><span class="line">        <span class="keyword">if</span>(checkexits.exists())&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;存在目录&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            checkexits.mkdir();</span><br><span class="line">        &#125;</span><br><span class="line">        File cunchu = <span class="keyword">new</span> File(<span class="string">&quot;D:/testupload/&quot;</span>+dotname+<span class="string">&quot;/&quot;</span>+fileName);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            file.transferTo(cunchu); <span class="comment">//保存文件</span></span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;true&quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IllegalStateException e) &#123;</span><br><span class="line">            <span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;false&quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            <span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;false&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">    </span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">servlet:</span><br><span class="line">  multipart:</span><br><span class="line">    max-file-size: 500MB</span><br><span class="line">    max-request-size: 500MB</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">@RequestMapping(&quot;/downloadFile&quot;)</span></span><br><span class="line"></span><br><span class="line"> <span class="function"><span class="keyword">private</span> String <span class="title">downloadFile</span><span class="params">(HttpServletResponse response)</span></span>&#123;</span><br><span class="line">         String downloadFilePath = <span class="string">&quot;/root/fileSavePath/&quot;</span>;<span class="comment">//被下载的文件在服务器中的路径,</span></span><br><span class="line">         String fileName = <span class="string">&quot;demo.xml&quot;</span>;<span class="comment">//被下载文件的名称</span></span><br><span class="line">         </span><br><span class="line">         File file = <span class="keyword">new</span> File(downloadFilePath);</span><br><span class="line">         <span class="keyword">if</span> (file.exists()) &#123;</span><br><span class="line">             response.setContentType(<span class="string">&quot;application/force-download&quot;</span>);<span class="comment">// 设置强制下载不打开            </span></span><br><span class="line">             response.addHeader(<span class="string">&quot;Content-Disposition&quot;</span>, <span class="string">&quot;attachment;fileName=&quot;</span> + fileName);</span><br><span class="line">             <span class="keyword">byte</span>[] buffer = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">             FileInputStream fis = <span class="keyword">null</span>;</span><br><span class="line">             BufferedInputStream bis = <span class="keyword">null</span>;</span><br><span class="line">             <span class="keyword">try</span> &#123;</span><br><span class="line">                 fis = <span class="keyword">new</span> FileInputStream(file);</span><br><span class="line">                 bis = <span class="keyword">new</span> BufferedInputStream(fis);</span><br><span class="line">                 OutputStream outputStream = response.getOutputStream();</span><br><span class="line">                 <span class="keyword">int</span> i = bis.read(buffer);</span><br><span class="line">                 <span class="keyword">while</span> (i != -<span class="number">1</span>) &#123;</span><br><span class="line">                     outputStream.write(buffer, <span class="number">0</span>, i);</span><br><span class="line">                     i = bis.read(buffer);</span><br><span class="line">                 &#125;</span><br><span class="line">               </span><br><span class="line">                 <span class="keyword">return</span> <span class="string">&quot;下载成功&quot;</span>;</span><br><span class="line">             &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                 e.printStackTrace();</span><br><span class="line">             &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">                 <span class="keyword">if</span> (bis != <span class="keyword">null</span>) &#123;</span><br><span class="line">                     <span class="keyword">try</span> &#123;</span><br><span class="line">                         bis.close();</span><br><span class="line">                     &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                         e.printStackTrace();</span><br><span class="line">                     &#125;</span><br><span class="line">                 &#125;</span><br><span class="line">                 <span class="keyword">if</span> (fis != <span class="keyword">null</span>) &#123;</span><br><span class="line">                     <span class="keyword">try</span> &#123;</span><br><span class="line">                         fis.close();</span><br><span class="line">                     &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                         e.printStackTrace();</span><br><span class="line">                     &#125;</span><br><span class="line">                 &#125;</span><br><span class="line">             &#125;</span><br><span class="line">         &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;下载失败&quot;</span>;    </span><br><span class="line">     &#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">               &lt;groupId&gt;commons-fileupload&lt;/groupId&gt;</span><br><span class="line">               &lt;artifactId&gt;commons-fileupload&lt;/artifactId&gt;</span><br><span class="line">               &lt;version&gt;1.3.3&lt;/version&gt;</span><br><span class="line">           &lt;/dependency&gt;</span><br></pre></td></tr></table></figure>

<h1 id="24-正则表达式"><a href="#24-正则表达式" class="headerlink" title="24.正则表达式"></a>24.正则表达式</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//定义正则表达式</span></span><br><span class="line">      String regEx = <span class="string">&quot;^((html)|(mp4)|(exe)|(zip)|(jpg)|(png))$&quot;</span>;</span><br><span class="line">      <span class="comment">//编译成为正则表达式</span></span><br><span class="line">      Pattern pattern = Pattern.compile(regEx);</span><br><span class="line">      <span class="comment">// 忽略大小写的写法</span></span><br><span class="line">      <span class="comment">// Pattern pat = Pattern.compile(regEx, Pattern.CASE_INSENSITIVE);</span></span><br><span class="line">      Matcher matcher = pattern.matcher(dotname);</span><br><span class="line">      <span class="keyword">boolean</span> rs = matcher.matches();</span><br><span class="line">      System.out.println(rs);</span><br></pre></td></tr></table></figure>

<h1 id="25-shrio"><a href="#25-shrio" class="headerlink" title="25.shrio"></a>25.shrio</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">java的安全权限框架</span><br><span class="line">认证 授权  加密 会话管理 web集成  缓存等</span><br><span class="line"></span><br><span class="line">认证</span><br><span class="line">subjects(主体)  访问系统的用户，可以是用户，程序，进行认证的都叫主体</span><br><span class="line">principal(身份信息)  是主体进行身份认证的标识，标识具有唯一性，如用户名，密码，手机号，邮箱地址等。一个主体可以有多个身份，但是必须得有一个主身份</span><br><span class="line">credential(凭证信息)  凭证信息 用户密码，指纹等等，只有主体自己知道</span><br><span class="line"></span><br><span class="line">token  令牌  身份信息 和 凭证信息</span><br><span class="line"></span><br><span class="line">授权</span><br><span class="line">Who  主体 需要访问系统的资源</span><br><span class="line">What  资源，资源类型</span><br><span class="line">How  权限和许可  权限离开资源是没有意义的  粗颗粒 资源类型 和 细颗粒的资源实例</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">三大模块</span><br><span class="line">    <span class="number">1.</span> Subject：主体，一般指用户。</span><br><span class="line">    <span class="number">2.</span> SecurityManager：安全管理器，管理所有Subject，可以配合内部安全组件。(类似于SpringMVC中的DispatcherServlet)</span><br><span class="line">    <span class="number">3.</span> Realms：用于进行权限信息的验证，一般需要自己实现。</span><br></pre></td></tr></table></figure>

<h2 id="25-1RBAC"><a href="#25-1RBAC" class="headerlink" title="25.1RBAC"></a>25.1RBAC</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">基于角色的访问控制     缺点 系统的可扩展性比较差  需要修改代码</span><br><span class="line"></span><br><span class="line">基于资源的访问控制     系统的可扩展性强</span><br><span class="line">shiro.web.enabled=<span class="keyword">false</span></span><br></pre></td></tr></table></figure>

<h2 id="25-2粗粒度和细粒度"><a href="#25-2粗粒度和细粒度" class="headerlink" title="25.2粗粒度和细粒度"></a>25.2粗粒度和细粒度</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">粗  用户具有用户管理的权限</span><br><span class="line">细  用户只允许导出自己创建的订单明细</span><br></pre></td></tr></table></figure>

<h2 id="25-3开始搭建"><a href="#25-3开始搭建" class="headerlink" title="25.3开始搭建"></a>25.3开始搭建</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">	&lt;groupId&gt;org.apache.shiro&lt;/groupId&gt;</span><br><span class="line">	&lt;artifactId&gt;shiro-spring-boot-web-starter&lt;/artifactId&gt;</span><br><span class="line">	&lt;version&gt;1.4.2&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line"><span class="number">1.</span>安全管理器依赖于  realm</span><br><span class="line"><span class="number">2.</span>自定义realm   依赖于凭证匹配器</span><br><span class="line"><span class="number">3.</span>凭证匹配器   </span><br><span class="line">		依赖于算法名称</span><br><span class="line">		散列次数</span><br><span class="line"><span class="number">1.</span>导入 jar包</span><br><span class="line">anon	无参，开放权限，可以理解为匿名用户或游客</span><br><span class="line">authc	无参，需要认证</span><br><span class="line">logout	无参，注销，执行后会直接跳转到shiroFilterFactoryBean.setLoginUrl(); 设置的 url</span><br><span class="line">authcBasic	无参，表示 httpBasic 认证</span><br><span class="line">user	无参，表示必须存在用户，当登入操作时不做检查</span><br><span class="line">ssl	无参，表示安全的URL请求，协议为 https</span><br><span class="line">perms[user]	参数可写多个，表示需要某个或某些权限才能通过，多个参数时写 perms[<span class="string">&quot;user, admin&quot;</span>]，当有多个参数时必须每个参数都通过才算通过</span><br><span class="line">roles[admin]	参数可写多个，表示是某个或某些角色才能通过，多个参数时写 roles[<span class="string">&quot;admin，user&quot;</span>]，当有多个参数时必须每个参数都通过才算通过</span><br><span class="line">rest[user]	根据请求的方法，相当于 perms[user:method]，其中 method 为 post，get，delete 等</span><br><span class="line">port[<span class="number">8081</span>]	当请求的URL端口不是<span class="number">8081</span>时，跳转到schemal:<span class="comment">//serverName:8081?queryString 其中 schmal 是协议 http 或 https 等等，serverName 是你访问的 Host，8081 是 Port 端口，queryString 是你访问的 URL 里的 ? 后面的参数</span></span><br></pre></td></tr></table></figure>

<h2 id="25-4数据库创建"><a href="#25-4数据库创建" class="headerlink" title="25.4数据库创建"></a>25.4数据库创建</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line">    <span class="keyword">private</span> String perms;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="25-5配置"><a href="#25-5配置" class="headerlink" title="25.5配置"></a>25.5配置</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shiro.web.enabled=<span class="keyword">false</span></span><br></pre></td></tr></table></figure>

<h2 id="25-6-shrioConfig-过滤请求"><a href="#25-6-shrioConfig-过滤请求" class="headerlink" title="25.6 shrioConfig 过滤请求"></a>25.6 shrioConfig 过滤请求</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ShiroConfig</span> </span>&#123;</span><br><span class="line">    <span class="comment">//创建拦截器</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    * ShiroFilterFactoryBean 为Shiro过滤器工厂类</span></span><br><span class="line"><span class="comment">    * 配置一些过滤路径</span></span><br><span class="line"><span class="comment">    *</span></span><br><span class="line"><span class="comment">    * */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ShiroFilterFactoryBean <span class="title">getShiroFilterFactoryBean</span><span class="params">(<span class="meta">@Qualifier(&quot;getSecurityManager&quot;)</span> SecurityManager securityManager)</span></span>&#123;</span><br><span class="line">        ShiroFilterFactoryBean bean = <span class="keyword">new</span> ShiroFilterFactoryBean();</span><br><span class="line">        <span class="comment">//必须设置安全管理器</span></span><br><span class="line">        bean.setSecurityManager(securityManager);</span><br><span class="line">        <span class="comment">//配置资源受限列表</span></span><br><span class="line">        <span class="comment">//配置shiro默认登录界面地址，前后端分离中登录界面跳转由端控制，后台仅返回json数据</span></span><br><span class="line">        bean.setLoginUrl(<span class="string">&quot;/unauth.action&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">//添加shiro的内置过滤器</span></span><br><span class="line">        <span class="comment">//注意过滤器配置顺序 不能颠倒</span></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        * anon 无需认证就可以访问</span></span><br><span class="line"><span class="comment">        * authc   必须认证才能访问</span></span><br><span class="line"><span class="comment">        * user    必须拥有记住我的功能才能访问</span></span><br><span class="line"><span class="comment">        * perms   必须对某个资源拥有权限才能访问</span></span><br><span class="line"><span class="comment">        * role    必须拥有角色权限才能访问</span></span><br><span class="line"><span class="comment">        * */</span></span><br><span class="line">        Map&lt;String, String&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        bean.setFilterChainDefinitionMap(map);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//授权 未授权跳转到未授权页面</span></span><br><span class="line">        map.put(<span class="string">&quot;/del&quot;</span>,<span class="string">&quot;perms[user:del]&quot;</span>);</span><br><span class="line">        map.put(<span class="string">&quot;/add&quot;</span>,<span class="string">&quot;perms[user:add]&quot;</span>);</span><br><span class="line">        <span class="comment">//自定义认证页面</span></span><br><span class="line">        <span class="comment">//无需认证</span></span><br><span class="line">        map.put(<span class="string">&quot;/login&quot;</span>,<span class="string">&quot;anon&quot;</span>);</span><br><span class="line">        <span class="comment">// 需要认证的url</span></span><br><span class="line"><span class="comment">//        map.put(&quot;/add&quot;, &quot;authc&quot;);</span></span><br><span class="line">        <span class="comment">//设置登录的请求</span></span><br><span class="line">        bean.setLoginUrl(<span class="string">&quot;/login&quot;</span>);</span><br><span class="line">        <span class="comment">//设置未授权</span></span><br><span class="line">        bean.setUnauthorizedUrl(<span class="string">&quot;/noauth&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> bean;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//创建安全管理器</span></span><br><span class="line">    <span class="comment">//SecurityManager 为shiro安全管理器，管理着所有的Subject</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> DefaultWebSecurityManager <span class="title">getSecurityManager</span><span class="params">(<span class="meta">@Qualifier(&quot;getRealm&quot;)</span> UserRealm userRealm)</span></span>&#123;</span><br><span class="line">        DefaultWebSecurityManager SecurityManager = <span class="keyword">new</span> DefaultWebSecurityManager();</span><br><span class="line">        <span class="comment">//注入realm</span></span><br><span class="line">        SecurityManager.setRealm(userRealm);</span><br><span class="line">        <span class="keyword">return</span> SecurityManager;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//创建自定义realm</span></span><br><span class="line">    <span class="comment">//引入自己实现的 ShiroRealm</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> UserRealm <span class="title">getRealm</span><span class="params">()</span></span>&#123;</span><br><span class="line">        UserRealm realm = <span class="keyword">new</span> UserRealm();</span><br><span class="line"><span class="comment">//        realm.setCredentialsMatcher(matcher());</span></span><br><span class="line">        <span class="keyword">return</span> realm;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="25-7配置Realm"><a href="#25-7配置Realm" class="headerlink" title="25.7配置Realm"></a>25.7配置Realm</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserRealm</span> <span class="keyword">extends</span> <span class="title">AuthorizingRealm</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    UserService userService;</span><br><span class="line">    <span class="comment">//授权</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> AuthorizationInfo <span class="title">doGetAuthorizationInfo</span><span class="params">(PrincipalCollection principalCollection)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;执行了授权&quot;</span>);</span><br><span class="line">        SimpleAuthorizationInfo info = <span class="keyword">new</span> SimpleAuthorizationInfo();</span><br><span class="line">        <span class="comment">//执行授权</span></span><br><span class="line">        <span class="comment">//拿到当前登录用户对象</span></span><br><span class="line">        Subject subject = SecurityUtils.getSubject();</span><br><span class="line">        <span class="comment">//获取user</span></span><br><span class="line">        System.out.println(subject.getPrincipal());</span><br><span class="line">        <span class="comment">//强制转化为user</span></span><br><span class="line">        User currentUser = (User) subject.getPrincipal();</span><br><span class="line">        <span class="comment">//设置当前用户的权限</span></span><br><span class="line">        info.addStringPermission(currentUser.getPerms());</span><br><span class="line">        <span class="keyword">return</span> info;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//认证</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> AuthenticationInfo <span class="title">doGetAuthenticationInfo</span><span class="params">(AuthenticationToken token)</span> <span class="keyword">throws</span> AuthenticationException </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;执行了认证&quot;</span>);</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        * 获取用户名密码</span></span><br><span class="line"><span class="comment">        * */</span></span><br><span class="line">        UsernamePasswordToken userToken = (UsernamePasswordToken) token;</span><br><span class="line">        <span class="comment">//链接真实数据库</span></span><br><span class="line">        User user = userService.getUser(userToken.getUsername());</span><br><span class="line">        <span class="keyword">if</span>(user == <span class="keyword">null</span>)&#123;<span class="comment">//没有这个用户</span></span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;<span class="comment">//抛出异常</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//密码加密   mD5 把密码加密   MD5 盐值加密  无法破解</span></span><br><span class="line">        <span class="comment">//密码认证shiro自己做</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> SimpleAuthenticationInfo(user,user.getPassword(),<span class="string">&quot;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="25-8-QuickStart"><a href="#25-8-QuickStart" class="headerlink" title="25.8 QuickStart"></a>25.8 QuickStart</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><span class="line">引入quickStart</span><br><span class="line"><span class="keyword">package</span> com.it.shiro.config;<span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Licensed to the Apache Software Foundation (ASF) under one</span></span><br><span class="line"><span class="comment"> * or more contributor license agreements.  See the NOTICE file</span></span><br><span class="line"><span class="comment"> * distributed with this work for additional information</span></span><br><span class="line"><span class="comment"> * regarding copyright ownership.  The ASF licenses this file</span></span><br><span class="line"><span class="comment"> * to you under the Apache License, Version 2.0 (the</span></span><br><span class="line"><span class="comment"> * &quot;License&quot;); you may not use this file except in compliance</span></span><br><span class="line"><span class="comment"> * with the License.  You may obtain a copy of the License at</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *     http://www.apache.org/licenses/LICENSE-2.0</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Unless required by applicable law or agreed to in writing,</span></span><br><span class="line"><span class="comment"> * software distributed under the License is distributed on an</span></span><br><span class="line"><span class="comment"> * &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY</span></span><br><span class="line"><span class="comment"> * KIND, either express or implied.  See the License for the</span></span><br><span class="line"><span class="comment"> * specific language governing permissions and limitations</span></span><br><span class="line"><span class="comment"> * under the License.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.SecurityUtils;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authc.*;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.config.IniSecurityManagerFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.mgt.SecurityManager;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.session.Session;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.subject.Subject;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.util.Factory;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.Logger;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.LoggerFactory;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Simple Quickstart application showing how to use Shiro&#x27;s API.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 0.9 RC2</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Quickstart</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">transient</span> Logger log = LoggerFactory.getLogger(Quickstart.class);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// The easiest way to create a Shiro SecurityManager with configured</span></span><br><span class="line">        <span class="comment">// realms, users, roles and permissions is to use the simple INI config.</span></span><br><span class="line">        <span class="comment">// We&#x27;ll do that by using a factory that can ingest a .ini file and</span></span><br><span class="line">        <span class="comment">// return a SecurityManager instance:</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// Use the shiro.ini file at the root of the classpath</span></span><br><span class="line">        <span class="comment">// (file: and url: prefixes load from files and urls respectively):</span></span><br><span class="line">        Factory&lt;SecurityManager&gt; factory = <span class="keyword">new</span> IniSecurityManagerFactory(<span class="string">&quot;classpath:shiro.ini&quot;</span>);</span><br><span class="line">        SecurityManager securityManager = factory.getInstance();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// for this simple example quickstart, make the SecurityManager</span></span><br><span class="line">        <span class="comment">// accessible as a JVM singleton.  Most applications wouldn&#x27;t do this</span></span><br><span class="line">        <span class="comment">// and instead rely on their container configuration or web.xml for</span></span><br><span class="line">        <span class="comment">// webapps.  That is outside the scope of this simple quickstart, so</span></span><br><span class="line">        <span class="comment">// we&#x27;ll just do the bare minimum so you can continue to get a feel</span></span><br><span class="line">        <span class="comment">// for things.</span></span><br><span class="line">        SecurityUtils.setSecurityManager(securityManager);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Now that a simple Shiro environment is set up, let&#x27;s see what you can do:</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// get the currently executing user:</span></span><br><span class="line">        Subject currentUser = SecurityUtils.getSubject();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Do some stuff with a Session (no need for a web or EJB container!!!)</span></span><br><span class="line">        Session session = currentUser.getSession();</span><br><span class="line">        session.setAttribute(<span class="string">&quot;someKey&quot;</span>, <span class="string">&quot;aValue&quot;</span>);</span><br><span class="line">        String value = (String) session.getAttribute(<span class="string">&quot;someKey&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (value.equals(<span class="string">&quot;aValue&quot;</span>)) &#123;</span><br><span class="line">            log.info(<span class="string">&quot;Retrieved the correct value! [&quot;</span> + value + <span class="string">&quot;]&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// let&#x27;s login the current user so we can check against roles and permissions:</span></span><br><span class="line">        <span class="keyword">if</span> (!currentUser.isAuthenticated()) &#123;</span><br><span class="line">            UsernamePasswordToken token = <span class="keyword">new</span> UsernamePasswordToken(<span class="string">&quot;lonestarr&quot;</span>, <span class="string">&quot;vespa&quot;</span>);</span><br><span class="line">            token.setRememberMe(<span class="keyword">true</span>);</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                currentUser.login(token);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (UnknownAccountException uae) &#123;</span><br><span class="line">                log.info(<span class="string">&quot;There is no user with username of &quot;</span> + token.getPrincipal());</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IncorrectCredentialsException ice) &#123;</span><br><span class="line">                log.info(<span class="string">&quot;Password for account &quot;</span> + token.getPrincipal() + <span class="string">&quot; was incorrect!&quot;</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (LockedAccountException lae) &#123;</span><br><span class="line">                log.info(<span class="string">&quot;The account for username &quot;</span> + token.getPrincipal() + <span class="string">&quot; is locked.  &quot;</span> +</span><br><span class="line">                        <span class="string">&quot;Please contact your administrator to unlock it.&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// ... catch more exceptions here (maybe custom ones specific to your application?</span></span><br><span class="line">            <span class="keyword">catch</span> (AuthenticationException ae) &#123;</span><br><span class="line">                <span class="comment">//unexpected condition?  error?</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//say who they are:</span></span><br><span class="line">        <span class="comment">//print their identifying principal (in this case, a username):</span></span><br><span class="line">        log.info(<span class="string">&quot;User [&quot;</span> + currentUser.getPrincipal() + <span class="string">&quot;] logged in successfully.&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//test a role:</span></span><br><span class="line">        <span class="keyword">if</span> (currentUser.hasRole(<span class="string">&quot;schwartz&quot;</span>)) &#123;</span><br><span class="line">            log.info(<span class="string">&quot;May the Schwartz be with you!&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            log.info(<span class="string">&quot;Hello, mere mortal.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//test a typed permission (not instance-level)</span></span><br><span class="line">        <span class="keyword">if</span> (currentUser.isPermitted(<span class="string">&quot;lightsaber:wield&quot;</span>)) &#123;</span><br><span class="line">            log.info(<span class="string">&quot;You may use a lightsaber ring.  Use it wisely.&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            log.info(<span class="string">&quot;Sorry, lightsaber rings are for schwartz masters only.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//a (very powerful) Instance Level permission:</span></span><br><span class="line">        <span class="keyword">if</span> (currentUser.isPermitted(<span class="string">&quot;winnebago:drive:eagle5&quot;</span>)) &#123;</span><br><span class="line">            log.info(<span class="string">&quot;You are permitted to &#x27;drive&#x27; the winnebago with license plate (id) &#x27;eagle5&#x27;.  &quot;</span> +</span><br><span class="line">                    <span class="string">&quot;Here are the keys - have fun!&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            log.info(<span class="string">&quot;Sorry, you aren&#x27;t allowed to drive the &#x27;eagle5&#x27; winnebago!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//all done - log out!</span></span><br><span class="line">        currentUser.logout();</span><br><span class="line"></span><br><span class="line">        System.exit(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="25-9配置controller"><a href="#25-9配置controller" class="headerlink" title="25.9配置controller"></a>25.9配置controller</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.it.shiro.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.SecurityUtils;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authc.IncorrectCredentialsException;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authc.UnknownAccountException;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authc.UsernamePasswordToken;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.subject.Subject;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Repository;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.*;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@CrossOrigin(origins = &quot;*&quot;,maxAge = 3600)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@GetMapping(&quot;/login&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">Login</span><span class="params">(String username,String password)</span></span>&#123;</span><br><span class="line">        <span class="comment">//获取当前用户</span></span><br><span class="line">        Subject subject = SecurityUtils.getSubject();</span><br><span class="line">        <span class="comment">//封装用户的登录数据</span></span><br><span class="line">        UsernamePasswordToken token = <span class="keyword">new</span> UsernamePasswordToken(username,password);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            subject.login(token);<span class="comment">//执行登录方法，没有异常jiu ok</span></span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;登录成功&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">catch</span> (UnknownAccountException e)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;用户不存在&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">catch</span> (IncorrectCredentialsException e)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;密码错误&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/add&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">add</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;增加&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/del&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">del</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;删除&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//未授权跳转</span></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/noauth&quot;)</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">Unauthorized</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;未经授权无法范访问此页面&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="26-Swagger"><a href="#26-Swagger" class="headerlink" title="26.Swagger"></a>26.Swagger</h1><h2 id="26-1导入依赖"><a href="#26-1导入依赖" class="headerlink" title="26.1导入依赖"></a>26.1导入依赖</h2><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>导入依赖</span><br><span class="line">	        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;io.springfox&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;springfox-swagger2&lt;/artifactId&gt;</span><br><span class="line">            &lt;version&gt;2.7.0&lt;/version&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;io.springfox&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;springfox-swagger-ui&lt;/artifactId&gt;</span><br><span class="line">            &lt;version&gt;2.7.0&lt;/version&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br></pre></td></tr></table></figure>

<h2 id="26-2-Swagger的配置类"><a href="#26-2-Swagger的配置类" class="headerlink" title="26.2 Swagger的配置类"></a>26.2 Swagger的配置类</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2.</span>swagger的configuration</span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableSwagger2</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SwaggerConfig</span> <span class="keyword">extends</span> <span class="title">WebMvcConfigurationSupport</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Docket <span class="title">productApi</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Docket(DocumentationType.SWAGGER_2).select()</span><br><span class="line">                <span class="comment">// 扫描的包路径</span></span><br><span class="line">                .apis(RequestHandlerSelectors.basePackage(<span class="string">&quot;com.it.shiro.controller&quot;</span>))</span><br><span class="line">                <span class="comment">// 定义要生成文档的Api的url路径规则</span></span><br><span class="line">                .paths(PathSelectors.any())</span><br><span class="line">                .build()</span><br><span class="line">                <span class="comment">// 设置swagger-ui.html页面上的一些元素信息。</span></span><br><span class="line">                .apiInfo(metaData());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> ApiInfo <span class="title">metaData</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ApiInfoBuilder()</span><br><span class="line">                <span class="comment">// 标题</span></span><br><span class="line">                .title(<span class="string">&quot;SpringBoot集成Swagger2&quot;</span>)</span><br><span class="line">                <span class="comment">// 描述</span></span><br><span class="line">                .description(<span class="string">&quot;这是一篇博客演示&quot;</span>)</span><br><span class="line">                <span class="comment">// 文档版本</span></span><br><span class="line">                .version(<span class="string">&quot;1.0.0&quot;</span>)</span><br><span class="line">                .license(<span class="string">&quot;Apache License Version 2.0&quot;</span>)</span><br><span class="line">                .licenseUrl(<span class="string">&quot;https://www.apache.org/licenses/LICENSE-2.0&quot;</span>)</span><br><span class="line">                .build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">addResourceHandlers</span><span class="params">(ResourceHandlerRegistry registry)</span> </span>&#123;</span><br><span class="line">        registry.addResourceHandler(<span class="string">&quot;swagger-ui.html&quot;</span>)</span><br><span class="line">                .addResourceLocations(<span class="string">&quot;classpath:/META-INF/resources/&quot;</span>);</span><br><span class="line"></span><br><span class="line">        registry.addResourceHandler(<span class="string">&quot;/webjars/**&quot;</span>)</span><br><span class="line">                .addResourceLocations(<span class="string">&quot;classpath:/META-INF/resources/webjars/&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="26-3在Api上进行申明"><a href="#26-3在Api上进行申明" class="headerlink" title="26.3在Api上进行申明"></a>26.3在Api上进行申明</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Api</span></span><br><span class="line">	描述controller类</span><br><span class="line">	tags = <span class="string">&quot;&quot;</span> <span class="comment">// 描述此controller类</span></span><br><span class="line"><span class="meta">@ApiOperation</span>  描述一个方法或者一个API接口 </span><br><span class="line">	value = <span class="string">&quot;&quot;</span> <span class="comment">// 描述方法</span></span><br><span class="line">	notes = <span class="string">&quot;&quot;</span> <span class="comment">// 描述方法详细信息</span></span><br><span class="line"><span class="meta">@ApiParam</span>，对API参数的描述。</span><br><span class="line">		</span><br><span class="line"><span class="meta">@ApiImplicitParams</span></span><br><span class="line">		功能:汇集多个参数</span><br><span class="line">		注解位置: 方法</span><br><span class="line">		<span class="meta">@ApiImplicitParam</span>组成的列表</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line"> <span class="meta">@ApiModelProperty(value=&quot;用户id&quot;,name=&quot;id&quot;,required=true)</span></span><br><span class="line"> 		用来描述实体类属性的</span><br><span class="line"> 		</span><br><span class="line"> 		</span><br><span class="line">Bean实体类</span><br><span class="line">	<span class="meta">@Data</span></span><br><span class="line">	<span class="meta">@ApiModel</span></span><br><span class="line">	<span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;用户id&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;用户名&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;密码&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;权限&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String perms;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="26-4访问页面查看"><a href="#26-4访问页面查看" class="headerlink" title="26.4访问页面查看"></a>26.4访问页面查看</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">设定访问API doc的路由</span><br><span class="line"></span><br><span class="line">springfox.documentation.swagger.v2.path: /api-docs</span><br><span class="line"></span><br><span class="line">API doc的显示路由是：&lt;http:<span class="comment">//localhost:8080/swagger-ui.html&gt;</span></span><br></pre></td></tr></table></figure>





<h1 id="28-热部署"><a href="#28-热部署" class="headerlink" title="28.热部署"></a>28.热部署</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>导入jar包</span><br><span class="line">	&lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt;</span><br><span class="line">            &lt;scope&gt;runtime&lt;/scope&gt;</span><br><span class="line">            &lt;optional&gt;true&lt;/optional&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line"><span class="number">2.</span>配置文件</span><br><span class="line">    #热部署生效</span><br><span class="line">    spring.devtools.restart.enabled: <span class="keyword">true</span></span><br><span class="line">    #设置重启的目录</span><br><span class="line">    spring.devtools.restart.additional-paths: src/main/java</span><br><span class="line">    #classpath目录下的WEB-INF文件夹内容修改不重启</span><br><span class="line">    spring.devtools.restart.exclude: WEB-INF<span class="comment">/**</span></span><br><span class="line"><span class="comment">    </span></span><br><span class="line"><span class="comment"> 3.IDEA配置</span></span><br><span class="line"><span class="comment">当我们修改了Java类后，IDEA默认是不自动编译的，而spring-boot-devtools又是监测classpath下的文件发生变化才会重启应用，所以需要设置IDEA的自动编译：</span></span><br><span class="line"><span class="comment">（1）File-Settings-Compiler-Build Project automatically</span></span><br><span class="line"><span class="comment">（2）ctrl + shift + alt + /,选择Registry,勾上 Compiler autoMake allow when app running</span></span><br></pre></td></tr></table></figure>

<h1 id="29-配置druid"><a href="#29-配置druid" class="headerlink" title="29.配置druid"></a>29.配置druid</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;com.alibaba&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;druid&lt;/artifactId&gt;</span><br><span class="line">            &lt;version&gt;1.0.18&lt;/version&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">  配置文件 </span><br><span class="line">  spring:</span><br><span class="line">  ##数据库连接信息</span><br><span class="line">  datasource:</span><br><span class="line">    url: jdbc:mysql:<span class="comment">//localhost:3306/shiro</span></span><br><span class="line">    username: root</span><br><span class="line">    password: lzxs<span class="meta">@root123456</span></span><br><span class="line">    driver-class-name: com.mysql.jdbc.Driver</span><br><span class="line">    ###################以下为druid增加的配置###########################</span><br><span class="line">    type: com.alibaba.druid.pool.DruidDataSource</span><br><span class="line">    # 下面为连接池的补充设置，应用到上面所有数据源中</span><br><span class="line">    # 初始化大小，最小，最大</span><br><span class="line">    initialSize: <span class="number">5</span></span><br><span class="line">    minIdle: <span class="number">5</span></span><br><span class="line">    maxActive: <span class="number">20</span></span><br><span class="line">    # 配置获取连接等待超时的时间</span><br><span class="line">    maxWait: <span class="number">60000</span></span><br><span class="line">    # 配置间隔多久才进行一次检测，检测需要关闭的空闲连接，单位是毫秒</span><br><span class="line">    timeBetweenEvictionRunsMillis: <span class="number">60000</span></span><br><span class="line">    # 配置一个连接在池中最小生存的时间，单位是毫秒</span><br><span class="line">    minEvictableIdleTimeMillis: <span class="number">300000</span></span><br><span class="line">    validationQuery: SELECT <span class="number">1</span> FROM DUAL</span><br><span class="line">    testWhileIdle: <span class="keyword">true</span></span><br><span class="line">    testOnBorrow: <span class="keyword">false</span></span><br><span class="line">    testOnReturn: <span class="keyword">false</span></span><br><span class="line">    # 打开PSCache，并且指定每个连接上PSCache的大小</span><br><span class="line">    poolPreparedStatements: <span class="keyword">true</span></span><br><span class="line">    maxPoolPreparedStatementPerConnectionSize: <span class="number">20</span></span><br><span class="line">    # 配置监控统计拦截的filters，去掉后监控界面sql无法统计，&#x27;wall&#x27;用于防火墙</span><br><span class="line">    filters: stat,wall,log4j</span><br><span class="line">    # 通过connectProperties属性来打开mergeSql功能；慢SQL记录</span><br><span class="line">    connectionProperties: druid.stat.mergeSql=<span class="keyword">true</span>;druid.stat.slowSqlMillis=<span class="number">5000</span></span><br><span class="line">    # 合并多个DruidDataSource的监控数据</span><br><span class="line">    useGlobalDataSourceStat: <span class="keyword">true</span></span><br><span class="line">    ###############以上为配置druid添加的配置########################################</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">   	<span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DruidDataSource</span> </span>&#123;</span><br><span class="line">    <span class="meta">@ConfigurationProperties(prefix = &quot;spring.datasource&quot;)</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> DruidDataSource <span class="title">druidDataSource</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> DruidDataSource();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 配置监控服务器</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 返回监控注册的servlet对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@author</span> SimpleWu</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ServletRegistrationBean <span class="title">statViewServlet</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        ServletRegistrationBean servletRegistrationBean = <span class="keyword">new</span> ServletRegistrationBean(<span class="keyword">new</span> StatViewServlet(), <span class="string">&quot;/druid/*&quot;</span>);</span><br><span class="line">        <span class="comment">// 添加IP白名单</span></span><br><span class="line">        servletRegistrationBean.addInitParameter(<span class="string">&quot;allow&quot;</span>, <span class="string">&quot;127.0.0.1&quot;</span>);</span><br><span class="line">        <span class="comment">// 添加IP黑名单，当白名单和黑名单重复时，黑名单优先级更高</span></span><br><span class="line">        servletRegistrationBean.addInitParameter(<span class="string">&quot;deny&quot;</span>, <span class="string">&quot;127.0.0.1&quot;</span>);</span><br><span class="line">        <span class="comment">// 添加控制台管理用户</span></span><br><span class="line">        servletRegistrationBean.addInitParameter(<span class="string">&quot;loginUsername&quot;</span>, <span class="string">&quot;SimpleWu&quot;</span>);</span><br><span class="line">        servletRegistrationBean.addInitParameter(<span class="string">&quot;loginPassword&quot;</span>, <span class="string">&quot;123456&quot;</span>);</span><br><span class="line">        <span class="comment">// 是否能够重置数据</span></span><br><span class="line">        servletRegistrationBean.addInitParameter(<span class="string">&quot;resetEnable&quot;</span>, <span class="string">&quot;false&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> servletRegistrationBean;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 配置服务过滤器</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 返回过滤器配置对象</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> FilterRegistrationBean <span class="title">statFilter</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        FilterRegistrationBean filterRegistrationBean = <span class="keyword">new</span> FilterRegistrationBean(<span class="keyword">new</span> WebStatFilter());</span><br><span class="line">        <span class="comment">// 添加过滤规则</span></span><br><span class="line">        filterRegistrationBean.addUrlPatterns(<span class="string">&quot;/*&quot;</span>);</span><br><span class="line">        <span class="comment">// 忽略过滤格式</span></span><br><span class="line">        filterRegistrationBean.addInitParameter(<span class="string">&quot;exclusions&quot;</span>, <span class="string">&quot;*.js,*.gif,*.jpg,*.png,*.css,*.ico,/druid/*,&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> filterRegistrationBean;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="30-Lombok"><a href="#30-Lombok" class="headerlink" title="30.Lombok"></a>30.Lombok</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;lombok&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;1.18.10&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span>最常用的注解之一。注解在类上，提供该类所有属性的getter/setter方法，还提供了equals、canEqual、hashCode、toString方法。</span><br><span class="line"></span><br><span class="line"><span class="meta">@Log4j</span></span><br><span class="line">作用于类上，为该类提供一个属性名为log的log4j日志对象。</span><br><span class="line"></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line">作用于类上，为该类提供一个包含全部参的构造方法，注意此时默认构造方法不会提供。</span><br><span class="line"></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line">作用于类上，提供一个无参的构造方法。可以和<span class="meta">@AllArgsConstructor</span>同时使用，此时会生成两个构造方法：无参构造方法和全参构造方法。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@EqualsAndHashCode</span></span><br><span class="line">作用于类上，生成equals、canEqual、hashCode方法</span><br><span class="line"></span><br><span class="line"><span class="meta">@NonNull</span></span><br><span class="line">作用于属性上，提供关于此参数的非空检查，如果参数为空，则抛出空指针异常。</span><br><span class="line"></span><br><span class="line"><span class="meta">@Cleanup</span></span><br><span class="line">作用于变量，保证该变量代表的资源会被自动关闭，默认调用资源的close()方法，如果该资源有其它关闭方法，可使用<span class="meta">@Cleanup(“methodName”)</span>来指定。</span><br><span class="line"></span><br><span class="line"><span class="meta">@SneakyThrows</span></span><br><span class="line">作用于方法上，相当于把方法内的代码添加了一个<span class="keyword">try</span>-<span class="keyword">catch</span>处理，捕获异常<span class="keyword">catch</span>中用Lombok.sneakyThrow(e)抛出异常。使用<span class="meta">@SneakyThrows(BizException.class)</span>指定抛出具体异常。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Synchronized</span></span><br><span class="line">作用于类方法或实例方法上，效果与<span class="keyword">synchronized</span>相同。区别在于锁对象不同，对于类方法和实例方法，<span class="keyword">synchronized</span>关键字的锁对象分别是类的<span class="class"><span class="keyword">class</span>对象和<span class="title">this</span>对象，而@<span class="title">Synchronized</span>的锁对象分别是私有静态<span class="title">final</span>对象<span class="title">lock</span>和私有<span class="title">final</span>对象<span class="title">lock</span>。也可以指定锁对象。</span></span><br></pre></td></tr></table></figure>

<h1 id="31-SQL查询"><a href="#31-SQL查询" class="headerlink" title="31.SQL查询"></a>31.SQL查询</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">查询角色权限</span><br><span class="line">SELECT a.username,ur.role_id,r.role_name,p.perms FROM user a</span><br><span class="line">LEFT JOIN user_role ur on a.id = ur.user_id</span><br><span class="line">LEFT JOIN role r on ur.user_id = r.role_id</span><br><span class="line">LEFT JOIN role_perms rp on rp.role_id = ur.role_id </span><br><span class="line">LEFT JOIN permission p on p.perms_id = rp.perms_id</span><br><span class="line">WHERE r.role_id = <span class="number">2</span></span><br></pre></td></tr></table></figure>

<h1 id="32-MyBatis-plus"><a href="#32-MyBatis-plus" class="headerlink" title="32.MyBatis plus"></a>32.MyBatis plus</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//entity  实体类</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    <span class="keyword">private</span> String email;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//mapper接口继承basemapper</span></span><br><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserMapper</span> <span class="keyword">extends</span> <span class="title">BaseMapper</span>&lt;<span class="title">User</span>&gt; </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//查看sql输出日志</span></span><br><span class="line">#查看sql输出日志</span><br><span class="line">mybatis-plus.configuration.log-impl=org.apache.ibatis.logging.stdout.StdOutImpl</span><br><span class="line"></span><br><span class="line"> 	</span><br><span class="line">    </span><br><span class="line"><span class="comment">//修改主键生成策略</span></span><br><span class="line">	<span class="meta">@TableId(type = IdType.AUTO)</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br></pre></td></tr></table></figure>

<h2 id="32-1基本操作"><a href="#32-1基本操作" class="headerlink" title="32.1基本操作"></a>32.1基本操作</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 查询</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">findall</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        List&lt;User&gt; users = userMapper.selectList(<span class="keyword">null</span>);</span><br><span class="line">        System.out.println(users);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">	<span class="comment">//增加</span></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">()</span></span>&#123;</span><br><span class="line">        User user = <span class="keyword">new</span> User();</span><br><span class="line">        user.setAge(<span class="number">11</span>);</span><br><span class="line">        user.setEmail(<span class="string">&quot;1213@qq.com&quot;</span>);</span><br><span class="line">        user.setName(<span class="string">&quot;zhang&quot;</span>);</span><br><span class="line"><span class="comment">//        id mp 自动生成</span></span><br><span class="line">        userMapper.insert(user);</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 修改</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span>  <span class="keyword">void</span> <span class="title">update</span><span class="params">()</span></span>&#123;</span><br><span class="line">        User user = <span class="keyword">new</span> User();</span><br><span class="line">        user.setId(<span class="number">2L</span>);<span class="comment">//L表示长类型</span></span><br><span class="line">        user.setAge(<span class="number">120</span>);</span><br><span class="line">        userMapper.updateById(user);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//mp  主键生成策略</span></span><br></pre></td></tr></table></figure>

<h2 id="32-2自动填充"><a href="#32-2自动填充" class="headerlink" title="32.2自动填充"></a>32.2自动填充</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>在需要自动填充的实体类上面加上注解</span><br><span class="line">    <span class="meta">@TableField(fill = FieldFill.INSERT)</span></span><br><span class="line">    <span class="keyword">private</span> Date createTime;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@TableField(fill = FieldFill.INSERT_UPDATE)</span></span><br><span class="line">    <span class="keyword">private</span> Date updateTime;</span><br><span class="line"><span class="number">2.</span>创建类实现接口</span><br><span class="line">    <span class="meta">@Component</span></span><br><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyMetaObjectHandler</span> <span class="keyword">implements</span> <span class="title">MetaObjectHandler</span> </span>&#123;</span><br><span class="line">        <span class="comment">//insert方法</span></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insertFill</span><span class="params">(MetaObject metaObject)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.setFieldValByName(<span class="string">&quot;createTime&quot;</span>,<span class="keyword">new</span> Date(),metaObject);</span><br><span class="line">            <span class="keyword">this</span>.setFieldValByName(<span class="string">&quot;updateTime&quot;</span>,<span class="keyword">new</span> Date(),metaObject);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//更新方法</span></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateFill</span><span class="params">(MetaObject metaObject)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.setFieldValByName(<span class="string">&quot;updateTime&quot;</span>,<span class="keyword">new</span> Date(),metaObject);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h2 id="32-3乐观锁"><a href="#32-3乐观锁" class="headerlink" title="32.3乐观锁"></a>32.3乐观锁</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">主要解决丢失更新</span><br><span class="line">如果不考虑事务隔离性 产生读的问题\</span><br><span class="line"><span class="comment">//脏读 不可重复读 幻读</span></span><br><span class="line">丢失更新问题 </span><br><span class="line">多人同时修改同一条记录，最后提交数据会把之前的覆盖掉</span><br><span class="line"></span><br><span class="line"><span class="comment">//解决方案 </span></span><br><span class="line"><span class="number">1.</span>悲观锁</span><br><span class="line">	</span><br><span class="line"><span class="number">2.</span>乐观锁</span><br><span class="line">	<span class="comment">//实体类属性</span></span><br><span class="line">	<span class="meta">@TableField(fill = FieldFill.INSERT)</span></span><br><span class="line">    <span class="meta">@Version</span></span><br><span class="line">    <span class="keyword">private</span> Integer version;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//配置类</span></span><br><span class="line">	<span class="meta">@Configuration</span></span><br><span class="line">    <span class="meta">@MapperScan(&quot;com.example.mpdemo1.mapper&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Mpconfig</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 乐观锁插件</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="meta">@Bean</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> OptimisticLockerInterceptor <span class="title">optimisticLockerInterceptor</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> OptimisticLockerInterceptor();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//自动填充配置</span></span><br><span class="line">	<span class="meta">@Component</span></span><br><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyMetaObjectHandler</span> <span class="keyword">implements</span> <span class="title">MetaObjectHandler</span> </span>&#123;</span><br><span class="line">        <span class="comment">//insert方法</span></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insertFill</span><span class="params">(MetaObject metaObject)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.setFieldValByName(<span class="string">&quot;createTime&quot;</span>,<span class="keyword">new</span> Date(),metaObject);</span><br><span class="line">            <span class="keyword">this</span>.setFieldValByName(<span class="string">&quot;updateTime&quot;</span>,<span class="keyword">new</span> Date(),metaObject);</span><br><span class="line">            <span class="keyword">this</span>.setFieldValByName(<span class="string">&quot;version&quot;</span>,<span class="number">1</span>,metaObject);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//更新方法</span></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateFill</span><span class="params">(MetaObject metaObject)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.setFieldValByName(<span class="string">&quot;updateTime&quot;</span>,<span class="keyword">new</span> Date(),metaObject);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//单id查询</span></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span>  <span class="keyword">void</span> <span class="title">testlegaunsuo</span><span class="params">()</span></span>&#123;</span><br><span class="line">        User user1 = userMapper.selectById(<span class="number">1318836641189916674L</span>);</span><br><span class="line">        user1.setAge(<span class="number">150</span>);</span><br><span class="line">        userMapper.updateById(user1);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h2 id="32-4map查询"><a href="#32-4map查询" class="headerlink" title="32.4map查询"></a>32.4map查询</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"> 	<span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span>  <span class="keyword">void</span> <span class="title">TestSelectBatch</span><span class="params">()</span></span>&#123;</span><br><span class="line">        HashMap&lt;String, Object&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        map.put(<span class="string">&quot;name&quot;</span>,<span class="string">&quot;dsa&quot;</span>);</span><br><span class="line"><span class="comment">//        map.put(&quot;age&quot;,11);</span></span><br><span class="line">        List&lt;User&gt; users = userMapper.selectByMap(map);</span><br><span class="line">        System.out.println(users);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//用来查询AND 满足两个条件</span></span><br></pre></td></tr></table></figure>

<h2 id="32-5分页"><a href="#32-5分页" class="headerlink" title="32.5分页"></a>32.5分页</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//配置类</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 分页插件</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="meta">@Bean</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> PaginationInterceptor <span class="title">paginationInterceptor</span><span class="params">()</span></span>&#123;</span><br><span class="line">       <span class="keyword">return</span> <span class="keyword">new</span> PaginationInterceptor();</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">PageSelect</span><span class="params">()</span></span>&#123;</span><br><span class="line">       Page&lt;User&gt; page = <span class="keyword">new</span> Page&lt;&gt;(<span class="number">1</span>, <span class="number">3</span>);</span><br><span class="line">       userMapper.selectPage(page,<span class="keyword">null</span>);</span><br><span class="line">       System.out.println(page.getCurrent());<span class="comment">//当前页</span></span><br><span class="line">       System.out.println(page.getRecords());<span class="comment">//数据集合List</span></span><br><span class="line">       System.out.println(page.getSize());<span class="comment">//显示记录数</span></span><br><span class="line">       System.out.println(page.getTotal());<span class="comment">//总记录数</span></span><br><span class="line">       System.out.println(page.getPages());<span class="comment">//总页数</span></span><br><span class="line">       System.out.println(page.hasNext());<span class="comment">//是否有下一页</span></span><br><span class="line">       System.out.println(page.hasPrevious());<span class="comment">//是否有上一页</span></span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<h2 id="32-6删除"><a href="#32-6删除" class="headerlink" title="32.6删除"></a>32.6删除</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">逻辑删除和物理删除</span><br><span class="line"><span class="comment">//物理删除</span></span><br><span class="line">	 <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 物理删除</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delete1</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> i = userMapper.deleteById(<span class="number">1L</span>);</span><br><span class="line">        System.out.println(i);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//逻辑删除</span></span><br><span class="line">	<span class="comment">//3.05版本</span></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 逻辑删除</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@TableLogic</span></span><br><span class="line">    <span class="meta">@TableField(fill = FieldFill.INSERT)</span></span><br><span class="line">    <span class="keyword">private</span> Integer deleted;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**\</span></span><br><span class="line"><span class="comment">     * 逻辑删除</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ISqlInjector <span class="title">sqlInjector</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> LogicSqlInjector();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 物理删除</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delete2</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> i = userMapper.deleteById(<span class="number">1319156625164599297L</span>);</span><br><span class="line">        System.out.println(i);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h2 id="32-7性能分析"><a href="#32-7性能分析" class="headerlink" title="32.7性能分析"></a>32.7性能分析</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">@Bean</span><br><span class="line">@Profile(&#123;&quot;dev&quot;,&quot;test&quot;&#125;)&#x2F;&#x2F;设置dev test环境开启</span><br><span class="line">    public PerformanceInterceptor performanceInterceptor() &#123;</span><br><span class="line">    PerformanceInterceptor performanceInterceptor &#x3D; new PerformanceInterceptor();</span><br><span class="line">    performanceInterceptor.setMaxTime(100);</span><br><span class="line">    performanceInterceptor.setFormat(true);</span><br><span class="line">    return performanceInterceptor;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 环境 prod test prod</span><br><span class="line">&#x2F;&#x2F;spring.profiles.active&#x3D;dev</span><br><span class="line"></span><br><span class="line">	</span><br></pre></td></tr></table></figure>

<h2 id="32-8复杂查询"><a href="#32-8复杂查询" class="headerlink" title="32.8复杂查询"></a>32.8复杂查询</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//使用QueryWrapper构建复杂查询</span></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 条件查询</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">queryUnion</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//创建QueryWrapper</span></span><br><span class="line">        QueryWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line">        <span class="comment">//设置条件</span></span><br><span class="line">        <span class="comment">//ge,gt,le,lt  大于 小于 大于等于 小于等</span></span><br><span class="line">        wrapper.ge(<span class="string">&quot;age&quot;</span>, <span class="number">30</span>);</span><br><span class="line">        List&lt;User&gt; users = userMapper.selectList(wrapper);</span><br><span class="line">        System.out.println(users);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//eq 等去  ne  不等于</span></span><br><span class="line">        wrapper.eq(<span class="string">&quot;age&quot;</span>, <span class="number">110</span>);</span><br><span class="line">        List&lt;User&gt; users1 = userMapper.selectList(wrapper);</span><br><span class="line">        System.out.println(users1);</span><br><span class="line">        <span class="comment">//between</span></span><br><span class="line">        wrapper.between(<span class="string">&quot;age&quot;</span>, <span class="number">30</span>,<span class="number">110</span>);</span><br><span class="line">        List&lt;User&gt; users2 = userMapper.selectList(wrapper);</span><br><span class="line">        System.out.println(users2);</span><br><span class="line">        <span class="comment">//like 模糊查询</span></span><br><span class="line">        wrapper.like(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;a&quot;</span>);</span><br><span class="line">        List&lt;User&gt; users3 = userMapper.selectList(wrapper);</span><br><span class="line">        System.out.println(users3);</span><br><span class="line">        <span class="comment">//orderBy 升序降序</span></span><br><span class="line">        wrapper.orderByDesc(<span class="string">&quot;id&quot;</span>);</span><br><span class="line">        <span class="comment">//last 拼接</span></span><br><span class="line">        <span class="comment">//拼接sql语句</span></span><br><span class="line">        wrapper.last(<span class="string">&quot;limit 1&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//查询指定列</span></span><br><span class="line">        wrapper.select(<span class="string">&quot;id&quot;</span>,<span class="string">&quot;name&quot;</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">mikasa</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://yoursite.com/2020/11/30/java%E6%A1%86%E6%9E%B6/">http://yoursite.com/2020/11/30/java%E6%A1%86%E6%9E%B6/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://yoursite.com" target="_blank">mikasa</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://ss1.bdstatic.com/70cFvXSh_Q1YnxGkpoWK1HF6hhy/it/u=564071848,1846939077&amp;fm=26&amp;gp=0.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2020/11/30/linux/"><img class="prev-cover" src="https://ss0.bdstatic.com/70cFuHSh_Q1YnxGkpoWK1HF6hhy/it/u=1514243100,2352528106&amp;fm=26&amp;gp=0.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Linux</div></div></a></div><div class="next-post pull-right"><a href="/2020/11/30/Vue3.0/"><img class="next-cover" src="https://ss3.bdstatic.com/70cFv8Sh_Q1YnxGkpoWK1HF6hhy/it/u=22130535,2850036426&amp;fm=26&amp;gp=0.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Vue3</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside_content" id="aside_content"><div class="card-widget card-info"><div class="card-content"><div class="card-info-avatar is-center"><img class="avatar-img" src="/img/index/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">mikasa</div><div class="author-info__description">Java,JavaScript,Node,Json,Sql,前端,数据库,后端</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">57</div></a></div><div class="card-info-data-item is-center"><a href="/source/categories/"><div class="headline">分类</div><div class="length-num">16</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/zcz147258"><i class="fab fa-github"></i><span>Follow Me</span></a></div></div><div class="card-widget card-announcement"><div class="card-content"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">有缘人哦吼！</div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="card-content"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%80-maven"><span class="toc-number">1.</span> <span class="toc-text">一.maven</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-1%E4%BB%93%E5%BA%93%E7%9A%84%E7%A7%8D%E7%B1%BB"><span class="toc-number">1.1.</span> <span class="toc-text">1.1仓库的种类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-2%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">1.2.</span> <span class="toc-text">1.2配置文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-3maven%E5%B8%B8%E7%94%A8%E6%8C%87%E4%BB%A4"><span class="toc-number">1.3.</span> <span class="toc-text">1.3maven常用指令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-4%E5%88%9B%E5%BB%BAjava%E5%B7%A5%E7%A8%8B"><span class="toc-number">1.4.</span> <span class="toc-text">1.4创建java工程</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8C-mybatis"><span class="toc-number">2.</span> <span class="toc-text">二.mybatis</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2-1%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E6%B5%81%E7%A8%8B"><span class="toc-number">2.1.</span> <span class="toc-text">2.1环境搭建流程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-2%E6%B3%A8%E8%A7%A3"><span class="toc-number">2.2.</span> <span class="toc-text">2.2注解</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-3%E5%BC%80%E5%A7%8B%E6%89%A7%E8%A1%8C"><span class="toc-number">2.3.</span> <span class="toc-text">2.3开始执行</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-4-OGNL%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">2.4.</span> <span class="toc-text">2.4 OGNL表达式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-5%E9%80%9A%E8%BF%87%E9%85%8D%E7%BD%AEproperties%E6%96%87%E4%BB%B6%E6%9D%A5%E5%AE%9E%E7%8E%B0"><span class="toc-number">2.5.</span> <span class="toc-text">2.5通过配置properties文件来实现</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-6typealiases%EF%BC%8Cpackage%E6%A0%87%E7%AD%BE"><span class="toc-number">2.6.</span> <span class="toc-text">2.6typealiases，package标签</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-7mybatis%E7%9A%84%E8%BF%9E%E6%8E%A5%E6%B1%A0%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">2.7.</span> <span class="toc-text">2.7mybatis的连接池的使用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-7-1%E9%85%8D%E7%BD%AE"><span class="toc-number">2.7.1.</span> <span class="toc-text">2.7.1配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-7-2%E5%8A%A8%E6%80%81sql%E8%AF%AD%E5%8F%A5"><span class="toc-number">2.7.2.</span> <span class="toc-text">2.7.2动态sql语句</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-8%E5%A4%9A%E8%A1%A8%E6%9F%A5%E8%AF%A2"><span class="toc-number">2.8.</span> <span class="toc-text">2.8多表查询</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-9%E5%BB%B6%E8%BF%9F%E5%8A%A0%E8%BD%BD"><span class="toc-number">2.9.</span> <span class="toc-text">2.9延迟加载</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-10%E7%BC%93%E5%AD%98"><span class="toc-number">2.10.</span> <span class="toc-text">2.10缓存</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-11%E6%B3%A8%E8%A7%A3%E5%BC%80%E5%8F%91"><span class="toc-number">2.11.</span> <span class="toc-text">2.11注解开发</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3-Spring"><span class="toc-number">3.</span> <span class="toc-text">3.Spring</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#3-1-IOC"><span class="toc-number">3.1.</span> <span class="toc-text">3.1 IOC</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-2%E6%B3%A8%E5%85%A5"><span class="toc-number">3.2.</span> <span class="toc-text">3.2注入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-3AOP%E2%80%99"><span class="toc-number">3.3.</span> <span class="toc-text">3.3AOP’</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-1%E5%88%9D%E6%AD%A5%E9%85%8D%E7%BD%AE"><span class="toc-number">3.3.1.</span> <span class="toc-text">3.3.1初步配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-2%E5%88%87%E5%85%A5%E7%82%B9%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">3.3.2.</span> <span class="toc-text">3.3.2切入点表达式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-3%E7%8E%AF%E7%BB%95%E9%80%9A%E7%9F%A5"><span class="toc-number">3.3.3.</span> <span class="toc-text">3.3.3环绕通知</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-4%E6%B3%A8%E8%A7%A3aop"><span class="toc-number">3.3.4.</span> <span class="toc-text">3.3.4注解aop</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-4JDBCtemp%E4%BA%8B%E5%8A%A1"><span class="toc-number">3.4.</span> <span class="toc-text">3.4JDBCtemp事务</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-5%E4%BA%8B%E5%8A%A1%E6%8E%A7%E5%88%B6"><span class="toc-number">3.5.</span> <span class="toc-text">3.5事务控制</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#4-springmvc"><span class="toc-number">4.</span> <span class="toc-text">4.springmvc</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#4-1%E5%BC%80%E5%A7%8B%E9%85%8D%E7%BD%AE"><span class="toc-number">4.1.</span> <span class="toc-text">4.1开始配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-2%E5%A4%84%E7%90%86%E6%B5%81%E7%A8%8B"><span class="toc-number">4.2.</span> <span class="toc-text">4.2处理流程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-3RequestMapping"><span class="toc-number">4.3.</span> <span class="toc-text">4.3RequestMapping</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-4%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0%E7%9A%84%E7%BB%91%E5%AE%9A"><span class="toc-number">4.4.</span> <span class="toc-text">4.4请求参数的绑定</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-5%E8%87%AA%E5%AE%9A%E4%B9%89%E7%B1%BB%E5%9E%8B%E8%BD%AC%E5%8C%96%E5%99%A8"><span class="toc-number">4.5.</span> <span class="toc-text">4.5自定义类型转化器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-6%E5%9C%A8%E6%8E%A7%E5%88%B6%E5%99%A8%E4%B8%AD%E6%8B%BF%E5%88%B0servlet-Api"><span class="toc-number">4.6.</span> <span class="toc-text">4.6在控制器中拿到servlet Api</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-7%E5%B8%B8%E7%94%A8%E6%B3%A8%E8%A7%A3"><span class="toc-number">4.7.</span> <span class="toc-text">4.7常用注解</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-8%E5%88%9B%E5%BB%BA%E9%A1%B9%E7%9B%AE"><span class="toc-number">4.8.</span> <span class="toc-text">4.8创建项目</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-9%E7%9B%B8%E5%BA%94%E6%95%B0%E6%8D%AE"><span class="toc-number">4.9.</span> <span class="toc-text">4.9相应数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-10%E5%93%8D%E5%BA%94-JSON%E6%95%B0%E6%8D%AE"><span class="toc-number">4.10.</span> <span class="toc-text">4.10响应 JSON数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-11%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0"><span class="toc-number">4.11.</span> <span class="toc-text">4.11文件上传</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-12%E8%B7%A8%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8A%E4%BC%A0"><span class="toc-number">4.12.</span> <span class="toc-text">4.12跨服务器上传</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-13%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86"><span class="toc-number">4.13.</span> <span class="toc-text">4.13异常处理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-14%E6%8B%A6%E6%88%AA%E5%99%A8"><span class="toc-number">4.14.</span> <span class="toc-text">4.14拦截器</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#5-SSM%E6%A1%86%E6%9E%B6%E6%95%B4%E5%90%88"><span class="toc-number">5.</span> <span class="toc-text">5.SSM框架整合</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#5-1-%E6%90%AD%E5%BB%BAspring"><span class="toc-number">5.1.</span> <span class="toc-text">5.1.搭建spring</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-2springmvc%E6%95%B4%E5%90%88"><span class="toc-number">5.2.</span> <span class="toc-text">5.2springmvc整合</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-3spring%E6%95%B4%E5%90%88springmvc%E6%96%B9%E6%B3%95"><span class="toc-number">5.3.</span> <span class="toc-text">5.3spring整合springmvc方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-4-spring%E6%95%B4%E5%90%88mybatis%E6%A1%86%E6%9E%B6"><span class="toc-number">5.4.</span> <span class="toc-text">5.4 spring整合mybatis框架</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-5-restful%E9%A3%8E%E6%A0%BC"><span class="toc-number">5.5.</span> <span class="toc-text">5.5 restful风格</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-6%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B"><span class="toc-number">5.6.</span> <span class="toc-text">5.6逆向工程</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#6-springboot"><span class="toc-number">6.</span> <span class="toc-text">6.springboot</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#6-1%E5%BF%AB%E9%80%9F%E5%88%9B%E5%BB%BA"><span class="toc-number">6.1.</span> <span class="toc-text">6.1快速创建</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-%E5%AF%BC%E5%85%A5%E5%8C%85"><span class="toc-number">6.1.1.</span> <span class="toc-text">6.1.导入包</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2%E7%BC%96%E5%86%99%E4%B8%BB%E6%96%B9%E6%B3%95"><span class="toc-number">6.1.2.</span> <span class="toc-text">6.2编写主方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-3Controller"><span class="toc-number">6.1.3.</span> <span class="toc-text">6.3Controller</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-4%E9%83%A8%E7%BD%B2"><span class="toc-number">6.1.4.</span> <span class="toc-text">6.4部署</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-2%E5%BF%AB%E9%80%9F%E5%88%9B%E5%BB%BA"><span class="toc-number">6.2.</span> <span class="toc-text">6.2快速创建</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-3springboot%E9%85%8D%E7%BD%AE"><span class="toc-number">6.3.</span> <span class="toc-text">6.3springboot配置</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-3-1YAML%E8%AF%AD%E6%B3%95"><span class="toc-number">6.3.1.</span> <span class="toc-text">6.3.1YAML语法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-3-2%E5%9C%A8properties%E9%85%8D%E7%BD%AE"><span class="toc-number">6.3.2.</span> <span class="toc-text">6.3.2在properties配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-3-3value%E6%B3%A8%E8%A7%A3"><span class="toc-number">6.3.3.</span> <span class="toc-text">6.3.3value注解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-3-4-propertySource%E5%92%8C-ImportResource"><span class="toc-number">6.3.4.</span> <span class="toc-text">6.3.4@propertySource和@ImportResource</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-3-5%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E5%8D%A0%E4%BD%8D%E7%AC%A6"><span class="toc-number">6.3.5.</span> <span class="toc-text">6.3.5配置文件占位符</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-3-6profile%E5%92%8C%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E5%8A%A0%E8%BD%BD%E4%BD%8D%E7%BD%AE"><span class="toc-number">6.3.6.</span> <span class="toc-text">6.3.6profile和配置文件加载位置</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-4springboot%E6%97%A5%E5%BF%97"><span class="toc-number">6.4.</span> <span class="toc-text">6.4springboot日志</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-5-Springboot-web%E5%BC%80%E5%8F%91"><span class="toc-number">6.5.</span> <span class="toc-text">6.5 Springboot-web开发</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-5-1%E5%AF%B9%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%E5%BE%97%E6%98%A0%E5%B0%84%E8%A7%84%E5%88%99"><span class="toc-number">6.5.1.</span> <span class="toc-text">6.5.1对静态资源得映射规则</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-5-2-%E5%BC%95%E5%85%A5thymeleaf%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E"><span class="toc-number">6.5.2.</span> <span class="toc-text">6.5.2 引入thymeleaf模板引擎</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-5-2%E6%89%A9%E5%B1%95springmvc"><span class="toc-number">6.5.3.</span> <span class="toc-text">6.5.2扩展springmvc</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-6%E9%A1%B9%E7%9B%AE"><span class="toc-number">6.6.</span> <span class="toc-text">6.6项目</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-7%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86"><span class="toc-number">6.7.</span> <span class="toc-text">6.7错误处理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-8-%E9%85%8D%E7%BD%AE%E5%B5%8C%E5%85%A5%E5%BC%8FServlet%E5%AE%B9%E5%99%A8"><span class="toc-number">6.8.</span> <span class="toc-text">6.8. 配置嵌入式Servlet容器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-9%E6%B3%A8%E5%86%8CServlet%E7%9A%84%E4%B8%89%E5%A4%A7%E7%BB%84%E4%BB%B6"><span class="toc-number">6.9.</span> <span class="toc-text">6.9注册Servlet的三大组件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-10%E5%88%87%E6%8D%A2%E5%85%B6%E4%BB%96%E5%B5%8C%E5%85%A5%E5%BC%8Fservlet%E5%AE%B9%E5%99%A8"><span class="toc-number">6.10.</span> <span class="toc-text">6.10切换其他嵌入式servlet容器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-11%E5%A4%96%E7%BD%AE%E7%9A%84servlet%E5%AE%B9%E5%99%A8"><span class="toc-number">6.11.</span> <span class="toc-text">6.11外置的servlet容器</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#8-Springboot%E4%B8%8E%E6%95%B0%E6%8D%AE%E8%AE%BF%E9%97%AE"><span class="toc-number">7.</span> <span class="toc-text">8.Springboot与数据访问</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#8-1%E6%95%B0%E6%8D%AE%E6%BA%90%E7%B1%BB%E5%9E%8B%E6%89%A7%E8%A1%8Csql%E5%8E%9F%E7%94%9Fjdbc"><span class="toc-number">7.1.</span> <span class="toc-text">8.1数据源类型执行sql原生jdbc</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-2%E6%95%B4%E5%90%88mybatis"><span class="toc-number">7.2.</span> <span class="toc-text">8.2整合mybatis</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-3SpringData"><span class="toc-number">7.3.</span> <span class="toc-text">8.3SpringData</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#8-3-1%E6%95%B4%E5%90%88api"><span class="toc-number">7.3.1.</span> <span class="toc-text">8.3.1整合api</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#9-SpringBoot-%E4%B8%8E-%E7%BC%93%E5%AD%98"><span class="toc-number">8.</span> <span class="toc-text">9.SpringBoot 与 缓存</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#9-1ConcurrentMapCacheManage"><span class="toc-number">8.1.</span> <span class="toc-text">9.1ConcurrentMapCacheManage</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-2redis"><span class="toc-number">8.2.</span> <span class="toc-text">9.2redis</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#9-2-1%E6%B5%8B%E8%AF%95%E7%BC%93%E5%AD%98"><span class="toc-number">8.2.1.</span> <span class="toc-text">9.2.1测试缓存</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#10-%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97"><span class="toc-number">9.</span> <span class="toc-text">10.消息队列</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#10-1RabbitMQ"><span class="toc-number">9.1.</span> <span class="toc-text">10.1RabbitMQ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-2%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8"><span class="toc-number">9.2.</span> <span class="toc-text">10.2安装使用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-3%E7%9B%91%E5%90%AC"><span class="toc-number">9.3.</span> <span class="toc-text">10.3监听</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-4%E7%A8%8B%E5%BA%8F%E4%B8%AD%E5%88%9B%E5%BB%BA%E4%BA%A4%E6%8D%A2%E5%99%A8%E5%92%8C%E8%B7%AF%E7%94%B1AmqpAdmin"><span class="toc-number">9.4.</span> <span class="toc-text">10.4程序中创建交换器和路由AmqpAdmin</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#11-springboot%E6%A3%80%E7%B4%A2"><span class="toc-number">10.</span> <span class="toc-text">11.springboot检索</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#11-1springboot%E6%95%B4%E5%90%88"><span class="toc-number">10.1.</span> <span class="toc-text">11.1springboot整合</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#12-springboot-%E5%BC%82%E6%AD%A5%E4%BB%BB%E5%8A%A1"><span class="toc-number">11.</span> <span class="toc-text">12.springboot 异步任务</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#12-1%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1"><span class="toc-number">11.1.</span> <span class="toc-text">12.1定时任务</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-2%E9%82%AE%E4%BB%B6%E4%BB%BB%E5%8A%A1"><span class="toc-number">11.2.</span> <span class="toc-text">12.2邮件任务</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#13-springboot%E5%92%8C%E5%AE%89%E5%85%A8"><span class="toc-number">12.</span> <span class="toc-text">13.springboot和安全</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#13-1%E8%AE%A4%E8%AF%81%E5%92%8C%E6%8E%88%E6%9D%83"><span class="toc-number">12.1.</span> <span class="toc-text">13.1认证和授权</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#14-%E5%88%86%E5%B8%83%E5%BC%8Fdubbo-zookeeper"><span class="toc-number">13.</span> <span class="toc-text">14.分布式dubbo+zookeeper</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#15-springboot%E5%92%8Cspringcloud"><span class="toc-number">14.</span> <span class="toc-text">15.springboot和springcloud</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#15-1%E9%85%8D%E7%BD%AE"><span class="toc-number">14.1.</span> <span class="toc-text">15.1配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#17-java%E5%8F%91%E8%AF%B7%E6%B1%82%E5%92%8C%E8%BD%AC%E5%8C%96json"><span class="toc-number">14.2.</span> <span class="toc-text">17.java发请求和转化json</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#18-https%E8%AF%B7%E6%B1%82%E5%92%8C%E8%BD%AC%E5%8F%91"><span class="toc-number">15.</span> <span class="toc-text">18.https请求和转发</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#19sprinngboot%E8%B7%A8%E5%9F%9F"><span class="toc-number">16.</span> <span class="toc-text">19sprinngboot跨域</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#20-springboot%E8%BF%94%E5%9B%9E%E6%97%B6%E9%97%B4%E7%B1%BB%E5%9E%8B"><span class="toc-number">17.</span> <span class="toc-text">20.springboot返回时间类型</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#21-java%E5%AE%9E%E7%8E%B0qq%E8%BD%B0%E7%82%B8"><span class="toc-number">18.</span> <span class="toc-text">21.java实现qq轰炸</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#22-%E5%AE%9E%E7%8E%B0jwt"><span class="toc-number">19.</span> <span class="toc-text">22.实现jwt</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#23-%E5%AE%9E%E7%8E%B0%E6%96%87%E4%BB%B6%E7%9A%84%E4%B8%8A%E4%BC%A0%E4%B8%8B%E8%BD%BD"><span class="toc-number">20.</span> <span class="toc-text">23.实现文件的上传下载</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#24-%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">21.</span> <span class="toc-text">24.正则表达式</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#25-shrio"><span class="toc-number">22.</span> <span class="toc-text">25.shrio</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#25-1RBAC"><span class="toc-number">22.1.</span> <span class="toc-text">25.1RBAC</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#25-2%E7%B2%97%E7%B2%92%E5%BA%A6%E5%92%8C%E7%BB%86%E7%B2%92%E5%BA%A6"><span class="toc-number">22.2.</span> <span class="toc-text">25.2粗粒度和细粒度</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#25-3%E5%BC%80%E5%A7%8B%E6%90%AD%E5%BB%BA"><span class="toc-number">22.3.</span> <span class="toc-text">25.3开始搭建</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#25-4%E6%95%B0%E6%8D%AE%E5%BA%93%E5%88%9B%E5%BB%BA"><span class="toc-number">22.4.</span> <span class="toc-text">25.4数据库创建</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#25-5%E9%85%8D%E7%BD%AE"><span class="toc-number">22.5.</span> <span class="toc-text">25.5配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#25-6-shrioConfig-%E8%BF%87%E6%BB%A4%E8%AF%B7%E6%B1%82"><span class="toc-number">22.6.</span> <span class="toc-text">25.6 shrioConfig 过滤请求</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#25-7%E9%85%8D%E7%BD%AERealm"><span class="toc-number">22.7.</span> <span class="toc-text">25.7配置Realm</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#25-8-QuickStart"><span class="toc-number">22.8.</span> <span class="toc-text">25.8 QuickStart</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#25-9%E9%85%8D%E7%BD%AEcontroller"><span class="toc-number">22.9.</span> <span class="toc-text">25.9配置controller</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#26-Swagger"><span class="toc-number">23.</span> <span class="toc-text">26.Swagger</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#26-1%E5%AF%BC%E5%85%A5%E4%BE%9D%E8%B5%96"><span class="toc-number">23.1.</span> <span class="toc-text">26.1导入依赖</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#26-2-Swagger%E7%9A%84%E9%85%8D%E7%BD%AE%E7%B1%BB"><span class="toc-number">23.2.</span> <span class="toc-text">26.2 Swagger的配置类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#26-3%E5%9C%A8Api%E4%B8%8A%E8%BF%9B%E8%A1%8C%E7%94%B3%E6%98%8E"><span class="toc-number">23.3.</span> <span class="toc-text">26.3在Api上进行申明</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#26-4%E8%AE%BF%E9%97%AE%E9%A1%B5%E9%9D%A2%E6%9F%A5%E7%9C%8B"><span class="toc-number">23.4.</span> <span class="toc-text">26.4访问页面查看</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#28-%E7%83%AD%E9%83%A8%E7%BD%B2"><span class="toc-number">24.</span> <span class="toc-text">28.热部署</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#29-%E9%85%8D%E7%BD%AEdruid"><span class="toc-number">25.</span> <span class="toc-text">29.配置druid</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#30-Lombok"><span class="toc-number">26.</span> <span class="toc-text">30.Lombok</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#31-SQL%E6%9F%A5%E8%AF%A2"><span class="toc-number">27.</span> <span class="toc-text">31.SQL查询</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#32-MyBatis-plus"><span class="toc-number">28.</span> <span class="toc-text">32.MyBatis plus</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#32-1%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C"><span class="toc-number">28.1.</span> <span class="toc-text">32.1基本操作</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#32-2%E8%87%AA%E5%8A%A8%E5%A1%AB%E5%85%85"><span class="toc-number">28.2.</span> <span class="toc-text">32.2自动填充</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#32-3%E4%B9%90%E8%A7%82%E9%94%81"><span class="toc-number">28.3.</span> <span class="toc-text">32.3乐观锁</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#32-4map%E6%9F%A5%E8%AF%A2"><span class="toc-number">28.4.</span> <span class="toc-text">32.4map查询</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#32-5%E5%88%86%E9%A1%B5"><span class="toc-number">28.5.</span> <span class="toc-text">32.5分页</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#32-6%E5%88%A0%E9%99%A4"><span class="toc-number">28.6.</span> <span class="toc-text">32.6删除</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#32-7%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90"><span class="toc-number">28.7.</span> <span class="toc-text">32.7性能分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#32-8%E5%A4%8D%E6%9D%82%E6%9F%A5%E8%AF%A2"><span class="toc-number">28.8.</span> <span class="toc-text">32.8复杂查询</span></a></li></ol></li></ol></div></div></div><div class="card-widget card-recent-post"><div class="card-content"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2021/01/16/gulp/" title="Gulp打包"><img src="https://ss2.bdstatic.com/70cFvnSh_Q1YnxGkpoWK1HF6hhy/it/u=4045737814,934960022&amp;fm=26&amp;gp=0.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Gulp打包"/></a><div class="content"><a class="title" href="/2021/01/16/gulp/" title="Gulp打包">Gulp打包</a><time datetime="2021-01-16T02:30:11.932Z" title="发表于 2021-01-16 10:30:11">2021-01-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2020/12/18/proto%E5%9C%A8socket_io%E7%9A%84%E5%BA%94%E7%94%A8/" title="proto在socket_io的应用"><img src="https://ss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=4234896097,4021899470&amp;fm=26&amp;gp=0.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="proto在socket_io的应用"/></a><div class="content"><a class="title" href="/2020/12/18/proto%E5%9C%A8socket_io%E7%9A%84%E5%BA%94%E7%94%A8/" title="proto在socket_io的应用">proto在socket_io的应用</a><time datetime="2020-12-18T05:47:05.179Z" title="发表于 2020-12-18 13:47:05">2020-12-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2020/12/16/generator%E5%92%8Citerator/" title="generator和iterator"><img src="https://ss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=4234896097,4021899470&amp;fm=26&amp;gp=0.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="generator和iterator"/></a><div class="content"><a class="title" href="/2020/12/16/generator%E5%92%8Citerator/" title="generator和iterator">generator和iterator</a><time datetime="2020-12-16T03:42:48.398Z" title="发表于 2020-12-16 11:42:48">2020-12-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2020/12/16/js%E5%8A%A0%E8%A7%A3%E5%AF%86crypto.js/" title="js加解密"><img src="https://ss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=4234896097,4021899470&amp;fm=26&amp;gp=0.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="js加解密"/></a><div class="content"><a class="title" href="/2020/12/16/js%E5%8A%A0%E8%A7%A3%E5%AF%86crypto.js/" title="js加解密">js加解密</a><time datetime="2020-12-16T03:41:57.061Z" title="发表于 2020-12-16 11:41:57">2020-12-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2020/12/16/js%E5%AF%B9%E8%B1%A1%E6%95%B0%E7%BB%84%E6%8E%92%E5%BA%8F/" title="js对象数组排序"><img src="https://ss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=4234896097,4021899470&amp;fm=26&amp;gp=0.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="js对象数组排序"/></a><div class="content"><a class="title" href="/2020/12/16/js%E5%AF%B9%E8%B1%A1%E6%95%B0%E7%BB%84%E6%8E%92%E5%BA%8F/" title="js对象数组排序">js对象数组排序</a><time datetime="2020-12-16T03:40:27.119Z" title="发表于 2020-12-16 11:40:27">2020-12-16</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By mikasa</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">簡</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/medium-zoom/dist/medium-zoom.min.js"></script><div class="js-pjax"><script>function loadValine () {
  function initValine () {
    let initData = {
      el: '#vcomment',
      appId: 'BzB1So5EWrOm2CUDceS299It-gzGzoHsz',
      appKey: 'Ul1N9MAsFqovsupOVB5eoJee',
      placeholder: '记得留下你的暱称和邮箱....可以快速收到回復',
      avatar: 'monsterid',
      meta: 'nick,mail,link'.split(','),
      pageSize: '10',
      lang: 'zh-CN',
      recordIP: false,
      serverURLs: '',
      emojiCDN: '',
      emojiMaps: "",
      enableQQ: false,
      path: window.location.pathname,
    }

    if (true) { 
      initData.requiredFields= ('nick,mail'.split(','))
    }
    
    if (false) {
      const otherData = false
      initData = Object.assign({}, initData, otherData)
    }
    
    const valine = new Valine(initData)
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !true) {
  if (true) btf.loadComment(document.querySelector('#vcomment'),loadValine)
  else setTimeout(() => loadValine(), 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><div class="aplayer no-destroy" data-id="2484225391" data-server="netease" data-type="playlist" data-fixed="true" data-mini="true" data-listFolded="false" data-order="random" data-preload="none" data-autoplay="true" muted></div><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="false"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/gh/metowolf/MetingJS@1.2/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = [
  'title',
  '#config_change',
  '#body-wrap',
  '#rightside-config-hide',
  '#rightside-config-show',
  '.js-pjax'
]

if (false) {
  pjaxSelectors.unshift('meta[property="og:image"]', 'meta[property="og:title"]', 'meta[property="og:url"]')
}

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  if (typeof gtag === 'function') {
    gtag('config', '', {'page_path': window.location.pathname});
  }

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // Analytics
  if (false) {
    MtaH5.pgv()
  }

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()

  typeof preloader === 'object' && preloader.endLoading()
})


document.addEventListener('pjax:send', function () {
  typeof preloader === 'object' && preloader.initLoading()
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

})</script></div></body></html>