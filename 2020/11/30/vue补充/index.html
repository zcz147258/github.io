<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Vue补充 | mikasa</title><meta name="keywords" content="Vue补充"><meta name="author" content="mikasa"><meta name="copyright" content="mikasa"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="description" content="Vue补充">
<meta property="og:type" content="article">
<meta property="og:title" content="Vue补充">
<meta property="og:url" content="http://yoursite.com/2020/11/30/vue%E8%A1%A5%E5%85%85/index.html">
<meta property="og:site_name" content="mikasa">
<meta property="og:description" content="Vue补充">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://ss3.bdstatic.com/70cFv8Sh_Q1YnxGkpoWK1HF6hhy/it/u=22130535,2850036426&fm=26&gp=0.jpg">
<meta property="article:published_time" content="2020-11-30T07:28:46.317Z">
<meta property="article:modified_time" content="2020-11-30T08:53:31.826Z">
<meta property="article:author" content="mikasa">
<meta property="article:tag" content="Java,JavaScript,Node,Json,Sql,前端,数据库,后端">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://ss3.bdstatic.com/70cFv8Sh_Q1YnxGkpoWK1HF6hhy/it/u=22130535,2850036426&fm=26&gp=0.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://yoursite.com/2020/11/30/vue%E8%A1%A5%E5%85%85/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":1,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  ClickShowText: undefined,
  lightbox: 'mediumZoom',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
};

var saveToLocal = {
  set: function setWithExpiry(key, value, ttl) {
    const now = new Date()
    const expiryDay = ttl * 86400000
    const item = {
      value: value,
      expiry: now.getTime() + expiryDay,
    }
    localStorage.setItem(key, JSON.stringify(item))
  },

  get: function getWithExpiry(key) {
    const itemStr = localStorage.getItem(key)

    if (!itemStr) {
      return undefined
    }
    const item = JSON.parse(itemStr)
    const now = new Date()

    if (now.getTime() > item.expiry) {
      localStorage.removeItem(key)
      return undefined
    }
    return item.value
  }
}

// https://stackoverflow.com/questions/16839698/jquery-getscript-alternative-in-native-javascript
const getScript = url => new Promise((resolve, reject) => {
  const script = document.createElement('script')
  script.src = url
  script.async = true
  script.onerror = reject
  script.onload = script.onreadystatechange = function() {
    const loadState = this.readyState
    if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
    script.onload = script.onreadystatechange = null
    resolve()
  }
  document.head.appendChild(script)
})</script><script id="config_change">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2020-11-30 16:53:31'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(function () {  window.activateDarkMode = function () {
    document.documentElement.setAttribute('data-theme', 'dark')
    if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
    }
  }
  window.activateLightMode = function () {
    document.documentElement.setAttribute('data-theme', 'light')
   if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
    }
  }
  const autoChangeMode = 'false'
  const t = saveToLocal.get('theme')
  if (autoChangeMode === '1') {
    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
    const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
    const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified
    if (t === undefined) {
      if (isLightMode) activateLightMode()
      else if (isDarkMode) activateDarkMode()
      else if (isNotSpecified || hasNoSupport) {
        const now = new Date()
        const hour = now.getHours()
        const isNight = hour <= 6 || hour >= 18
        isNight ? activateDarkMode() : activateLightMode()
      }
      window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
        if (saveToLocal.get('theme') === undefined) {
          e.matches ? activateDarkMode() : activateLightMode()
        }
      })
    } else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else if (autoChangeMode === '2') {
    const now = new Date()
    const hour = now.getHours()
    const isNight = hour <= 6 || hour >= 18
    if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
    else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else {
    if (t === 'dark') activateDarkMode()
    else if (t === 'light') activateLightMode()
  }const asideStatus = saveToLocal.get('aside-status')
if (asideStatus !== undefined) {
   if (asideStatus === 'hide') {
     document.documentElement.classList.add('hide-aside')
   } else {
     document.documentElement.classList.remove('hide-aside')
   }
}})()</script><meta name="generator" content="Hexo 5.2.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="/img/index/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">57</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/source/categories/"><div class="headline">分类</div><div class="length-num">16</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标籤</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 娱乐</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li><li><a class="site-page" href="/games/"><i class="fa-fw fas fa-video"></i><span> 游戏</span></a></li><li><a class="site-page" href="/books/"><i class="fa-fw fas fa-video"></i><span> 书籍</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div></div></div></div><div id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://ss3.bdstatic.com/70cFv8Sh_Q1YnxGkpoWK1HF6hhy/it/u=22130535,2850036426&amp;fm=26&amp;gp=0.jpg)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">mikasa</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标籤</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 娱乐</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li><li><a class="site-page" href="/games/"><i class="fa-fw fas fa-video"></i><span> 游戏</span></a></li><li><a class="site-page" href="/books/"><i class="fa-fw fas fa-video"></i><span> 书籍</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Vue补充</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2020-11-30T07:28:46.317Z" title="发表于 2020-11-30 15:28:46">2020-11-30</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2020-11-30T08:53:31.826Z" title="更新于 2020-11-30 16:53:31">2020-11-30</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/source/categories/Vue/">Vue</a></span></div><div class="meta-secondline"> <span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">6k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>29分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="一-导航守卫"><a href="#一-导航守卫" class="headerlink" title="一.导航守卫"></a>一.导航守卫</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">import Vue from &#39;vue&#39;</span><br><span class="line">import Router from &#39;vue-router&#39;</span><br><span class="line">import HelloWorld from &#39;@&#x2F;components&#x2F;HelloWorld&#39;</span><br><span class="line">import Login from &#39;@&#x2F;components&#x2F;Login&#39;</span><br><span class="line">import Page from &#39;@&#x2F;components&#x2F;Page&#39;</span><br><span class="line">Vue.use(Router)</span><br><span class="line">const router &#x3D; new Router(&#123;</span><br><span class="line">    &#123;</span><br><span class="line">      path: &#39;&#x2F;&#39;,</span><br><span class="line">      name: &#39;HelloWorld&#39;,</span><br><span class="line">      component: HelloWorld,</span><br><span class="line">      meta:&#123;</span><br><span class="line">        title:&#39;首页&#39;,</span><br><span class="line">        allowBack: true</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      path: &#39;&#x2F;page&#39;,</span><br><span class="line">      name: &#39;Page&#39;,</span><br><span class="line">      component: Page,</span><br><span class="line">      title:&#39;页面&#39;,</span><br><span class="line">      meta:&#123;</span><br><span class="line">        title:&#39;首页&#39;,</span><br><span class="line">        allowBack: true</span><br><span class="line">      &#125;</span><br><span class="line">      &#x2F;&#x2F;内部导航</span><br><span class="line">      &#x2F;&#x2F; beforeEnter: (to, from, next) &#x3D;&gt; &#123;</span><br><span class="line">      &#x2F;&#x2F;   let token &#x3D; false;</span><br><span class="line">      &#x2F;&#x2F;   console.log(&quot;进入局部首位&quot;)</span><br><span class="line">      &#x2F;&#x2F;    if (token) &#123;</span><br><span class="line">      &#x2F;&#x2F;     next();</span><br><span class="line">      &#x2F;&#x2F;   &#125; else &#123;</span><br><span class="line">      &#x2F;&#x2F;     console.log(&quot;没有权限&quot;)</span><br><span class="line">      &#x2F;&#x2F;     next(&#39;login&#39;)</span><br><span class="line">      &#x2F;&#x2F;   &#125;</span><br><span class="line">      &#x2F;&#x2F; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line">&#x2F;&#x2F;全局导航</span><br><span class="line">	router.beforeEach((to, from, next) &#x3D;&gt; &#123;</span><br><span class="line">      &#x2F;&#x2F; to and from are both route objects. must call &#96;next&#96;.</span><br><span class="line">      &#x2F;&#x2F;console.log(&quot;进入全局导航守卫i&quot;)</span><br><span class="line">      console.log(to.matched.some(item &#x3D;&gt;item.meta.allowBack));</span><br><span class="line">      next();</span><br><span class="line">      &#x2F;&#x2F;if (to &#x3D; &#39;&#x2F;page&#39;) &#123;</span><br><span class="line">        &#x2F;&#x2F; if (token) &#123;</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; &#125; else &#123;</span><br><span class="line">        &#x2F;&#x2F;   console.log(&quot;没有权限&quot;)</span><br><span class="line">        &#x2F;&#x2F;   next(&#39;login&#39;)</span><br><span class="line">        &#x2F;&#x2F; &#125;</span><br><span class="line">      &#x2F;&#x2F;&#125;</span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure>

<h1 id="二-Token验证"><a href="#二-Token验证" class="headerlink" title="二.Token验证"></a>二.Token验证</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br></pre></td><td class="code"><pre><span class="line">导入axios</span><br><span class="line">http.js</span><br><span class="line">	import axios from &#39;axios&#39; &#x2F;&#x2F; 引用axios</span><br><span class="line">&#x2F;&#x2F;import QS from &#39;qs&#39;</span><br><span class="line">import router from &#39;@&#x2F;router&#39;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; axios 配置</span><br><span class="line">axios.defaults.timeout &#x3D; 50000 &#x2F;&#x2F;设置接口响应时间</span><br><span class="line">axios.defaults.baseURL &#x3D; &#39;http:&#x2F;&#x2F;localhost:8080&#39; &#x2F;&#x2F; 这是调用数据接口,公共接口url+调用接口名</span><br><span class="line">&#x2F;&#x2F;获取域名</span><br><span class="line">&#x2F;&#x2F; let httpUrl &#x3D; window.location.host</span><br><span class="line">&#x2F;&#x2F; if (httpUrl.indexOf(&#39;.com&#39;) !&#x3D;&#x3D; -1) &#123;</span><br><span class="line">&#x2F;&#x2F;   console.log(&#39;生产环境&#39;, httpUrl)</span><br><span class="line">&#x2F;&#x2F; &#125; else if (httpUrl.indexOf(&#39;.net&#39;) !&#x3D;&#x3D; -1) &#123;</span><br><span class="line">&#x2F;&#x2F;   console.log(&#39;测试环境&#39;, httpUrl)</span><br><span class="line">&#x2F;&#x2F;   axios.defaults.baseURL &#x3D; &#39;http:&#x2F;&#x2F;www.test.com&#39; &#x2F;&#x2F; 这是调用数据接口,公共接口url+调用接口名</span><br><span class="line">&#x2F;&#x2F; &#125; else if (httpUrl.indexOf(&#39;localhost:8088&#39;) !&#x3D;&#x3D; -1) &#123;</span><br><span class="line">&#x2F;&#x2F;   console.log(&#39;指定开发环境&#39;, httpUrl)</span><br><span class="line">&#x2F;&#x2F;   axios.defaults.baseURL &#x3D; &#39;http:&#x2F;&#x2F;localhost:8088&#x2F;&#39;</span><br><span class="line">&#x2F;&#x2F; &#125; else &#123;</span><br><span class="line">&#x2F;&#x2F;   console.log(&#39;开发环境&#39;, httpUrl)</span><br><span class="line">&#x2F;&#x2F;   axios.defaults.baseURL &#x3D; &#39;http:&#x2F;&#x2F;192.168.6.138:8080&#x2F;&#39; &#x2F;&#x2F; 这是调用数据接口,公共接口url+调用接口名</span><br><span class="line">&#x2F;&#x2F; &#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; http request 拦截器，通过这个，我们就可以把Cookie传到后台</span><br><span class="line">axios.interceptors.request.use(</span><br><span class="line">    &#x2F;&#x2F;config包含每次请求的信息</span><br><span class="line">    config &#x3D;&gt; &#123;</span><br><span class="line">        &#x2F;&#x2F;拿请求路径</span><br><span class="line">        &#x2F;&#x2F;console.log(&#39;请求路径&#39;, config.url)</span><br><span class="line">        &#x2F;&#x2F;去缓存中拿token</span><br><span class="line">        let token &#x3D; document.cookie.substring(6);  &#x2F;&#x2F;从缓存中取token</span><br><span class="line">        &#x2F;&#x2F;有token</span><br><span class="line">        if (token) &#123;</span><br><span class="line">            console.log(1111)</span><br><span class="line">            config.headers.Authorization &#x3D; token;    &#x2F;&#x2F;将token放到请求头发送给服务器</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            &#x2F;&#x2F;localStorage.clear();  &#x2F;&#x2F;清空缓存</span><br><span class="line">            &#x2F;&#x2F;排除login请求接口</span><br><span class="line">            if (router.currentRoute.name &amp;&amp; router.currentRoute.name.toLowerCase() &#x3D;&#x3D; &quot;login&quot;) &#123;</span><br><span class="line"></span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                &#x2F;&#x2F;否则 全部返回null</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return config</span><br><span class="line">    &#125;,</span><br><span class="line">    err &#x3D;&gt; &#123;</span><br><span class="line">        return Promise.reject(err)</span><br><span class="line">    &#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; http response 拦截器</span><br><span class="line">axios.interceptors.response.use(</span><br><span class="line">    response &#x3D;&gt; &#123;</span><br><span class="line">        return response; &#x2F;&#x2F;请求成功的时候返回的data</span><br><span class="line">    &#125;,</span><br><span class="line">    error &#x3D;&gt; &#123;</span><br><span class="line">        try &#123;</span><br><span class="line">            if (error.response) &#123;</span><br><span class="line">                switch (error.response.status) &#123;</span><br><span class="line">                    case 401: &#x2F;&#x2F;token过期，清除token并跳转到登录页面</span><br><span class="line">                        &#x2F;&#x2F;localStorage.clear();</span><br><span class="line">                        var baurl &#x3D; window.location.href;</span><br><span class="line">                        console.log(baurl)</span><br><span class="line">                        router.replace(&#123;</span><br><span class="line">                            path: &#39;login&#39;,</span><br><span class="line">                            query: &#123; backUrl: baurl &#125;</span><br><span class="line">                        &#125;);</span><br><span class="line">                        return;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            return Promise.reject(error.response.data)</span><br><span class="line">        &#125;</span><br><span class="line">        catch (e) &#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">)</span><br><span class="line">&#x2F;&#x2F; 封装axios的get请求</span><br><span class="line">export function getData(url, params) &#123;</span><br><span class="line">    return new Promise((resolve, reject) &#x3D;&gt; &#123;</span><br><span class="line">      axios.get(url, &#123;params:params&#125;).then(response &#x3D;&gt; &#123;</span><br><span class="line">          &#x2F;&#x2F;console.log(response)</span><br><span class="line">          resolve(response.data);</span><br><span class="line">        &#125;)</span><br><span class="line">        .catch(error &#x3D;&gt; &#123;</span><br><span class="line">          reject(error);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  &#x2F;&#x2F; 封装axios的post请求</span><br><span class="line">  export function postData(url, params) &#123;</span><br><span class="line">    return new Promise((resolve, reject) &#x3D;&gt; &#123;</span><br><span class="line">      axios.post(url, QS.stringify(params)).then(response &#x3D;&gt; &#123;</span><br><span class="line">          resolve(response.data);</span><br><span class="line">        &#125;)</span><br><span class="line">        .catch(error &#x3D;&gt; &#123;</span><br><span class="line">          reject(error);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">export default axios</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">api.js</span><br><span class="line">	import &#123; postData, getData &#125; from &#39;.&#x2F;http.js&#39;</span><br><span class="line">    export function Logininfo(data &#x3D; &#123;&#125;)&#123;</span><br><span class="line">        return getData(&#39;&#x2F;login&#39;, data);</span><br><span class="line">    &#125;</span><br><span class="line">    export function testinfo(data &#x3D; &#123;&#125;)&#123;</span><br><span class="line">        return getData(&#39;&#x2F;getMessage&#39;, data)</span><br><span class="line">    &#125;	</span><br><span class="line">Login.vue</span><br><span class="line">	import &#123; Logininfo, testinfo &#125; from &quot;@&#x2F;utils&#x2F;api.js&quot;;</span><br><span class="line">	submit() &#123;</span><br><span class="line">      Logininfo(&#123;</span><br><span class="line">        username: this.username,</span><br><span class="line">        password: this.password</span><br><span class="line">      &#125;).then(res &#x3D;&gt; &#123;</span><br><span class="line">        console.log(res);</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    test() &#123;</span><br><span class="line">      testinfo().then(res &#x3D;&gt; &#123;</span><br><span class="line">        console.log(res);</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<h1 id="三-less"><a href="#三-less" class="headerlink" title="三.less"></a>三.less</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">npm install less less-loader --save-dev  安装</span><br><span class="line">配置</span><br><span class="line">	&#123;</span><br><span class="line">        test: &#x2F;\.less$&#x2F;,</span><br><span class="line">        loader: &quot;style-loader!css-loader!less-loader&quot;,</span><br><span class="line">      &#125;</span><br><span class="line">      修改less版本不然会冲突</span><br><span class="line">         &quot;less-loader&quot;: &quot;^5.0.0&quot;,</span><br></pre></td></tr></table></figure>

<h1 id="四-Markdown"><a href="#四-Markdown" class="headerlink" title="四.Markdown"></a>四.Markdown</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">安装npm install text-loader --save-dev</span><br><span class="line">在webpack.base.config.js中的module.rules中添加规则</span><br><span class="line">1.&#x2F;&#x2F;普通显示markdown样式</span><br><span class="line">    &#123;</span><br><span class="line">    test: &#x2F;.md$&#x2F;,</span><br><span class="line">    loader: ‘text-loader’</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    template:</span><br><span class="line">        &lt;vue-markdown&gt;&#123;&#123;msg&#125;&#125;&lt;&#x2F;vue-markdown&gt;</span><br><span class="line">    js:</span><br><span class="line"></span><br><span class="line">    import VueMarkdown from &#39;vue-markdown’</span><br><span class="line">    import xxx from &#39;XXX.md’</span><br><span class="line">    export default &#123;</span><br><span class="line">        components: &#123;</span><br><span class="line">        VueMarkdown</span><br><span class="line">        &#125;,</span><br><span class="line">        data () &#123;</span><br><span class="line">            return &#123;</span><br><span class="line">            msg: xxx</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">2.进阶</span><br><span class="line">	import mavonEditor from &#39;mavon-editor&#39;</span><br><span class="line">    import &#39;mavon-editor&#x2F;dist&#x2F;css&#x2F;index.css&#39;</span><br><span class="line">    &#x2F;&#x2F; use</span><br><span class="line">    Vue.use(mavonEditor)</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">     &lt;mavon-editor</span><br><span class="line">      :value&#x3D;&quot;content&quot;</span><br><span class="line">      :subfield&#x3D;&quot;prop.subfield&quot;</span><br><span class="line">      :defaultOpen&#x3D;&quot;prop.defaultOpen&quot;</span><br><span class="line">      :toolbarsFlag&#x3D;&quot;prop.toolbarsFlag&quot;</span><br><span class="line">      :editable&#x3D;&quot;prop.editable&quot;</span><br><span class="line">      :scrollStyle&#x3D;&quot;prop.scrollStyle&quot;</span><br><span class="line">    &gt;&lt;&#x2F;mavon-editor&gt;</span><br><span class="line">    </span><br><span class="line">    data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      content: vuemd</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  computed: &#123;</span><br><span class="line">    prop() &#123;</span><br><span class="line">      let data &#x3D; &#123;</span><br><span class="line">        subfield: false, &#x2F;&#x2F; 单双栏模式</span><br><span class="line">        defaultOpen: &quot;preview&quot;, &#x2F;&#x2F;edit： 默认展示编辑区域 ， preview： 默认展示预览区域</span><br><span class="line">        editable: false,</span><br><span class="line">        toolbarsFlag: false,</span><br><span class="line">        scrollStyle: true</span><br><span class="line">      &#125;;</span><br><span class="line">      return data;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  &#x2F;&#x2F;cnpm install highlight.js --save-dev</span><br><span class="line">  import vuemd from &quot;..&#x2F;..&#x2F;..&#x2F;static&#x2F;md&#x2F;vue补充.md&quot;;</span><br><span class="line">    import &quot;highlight.js&#x2F;styles&#x2F;atom-one-light.css&quot;;</span><br><span class="line">    import hljs from &quot;highlight.js&quot;; &#x2F;&#x2F;导入代码高亮文件</span><br><span class="line">    async function highlighthandle() &#123;</span><br><span class="line">      await hljs;</span><br><span class="line">      let highlight &#x3D; document.querySelectorAll(&quot;code,pre&quot;);</span><br><span class="line">      highlight.forEach(block &#x3D;&gt; &#123;</span><br><span class="line">        hljs.highlightBlock(block);</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    mounted() &#123;</span><br><span class="line">    highlighthandle();</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>

<h1 id="五-SRC请求头发送信息"><a href="#五-SRC请求头发送信息" class="headerlink" title="五.SRC请求头发送信息"></a>五.SRC请求头发送信息</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;添加请求头信息</span><br><span class="line">    console.log(this.$store.state.token)</span><br><span class="line">    let token &#x3D; this.$store.state.token; </span><br><span class="line">    var img &#x3D; this.$refs.check</span><br><span class="line">    var url &#x3D; basesrc;</span><br><span class="line">    var request &#x3D; new XMLHttpRequest();</span><br><span class="line">    request.responseType &#x3D; &#39;blob&#39;;</span><br><span class="line">    request.open(&#39;get&#39;, url, true);</span><br><span class="line">    request.setRequestHeader(&#39;Authorization&#39;, token);</span><br><span class="line">    request.onreadystatechange &#x3D; e &#x3D;&gt; &#123;</span><br><span class="line">                if (request.readyState &#x3D;&#x3D; XMLHttpRequest.DONE &amp;&amp; request.status &#x3D;&#x3D; 200) &#123;</span><br><span class="line">                    img.src &#x3D; URL.createObjectURL(request.response);</span><br><span class="line">                    img.onload &#x3D; () &#x3D;&gt; &#123;</span><br><span class="line">                        URL.revokeObjectURL(img.src);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;;</span><br><span class="line">    request.send(null);</span><br></pre></td></tr></table></figure>

<h1 id="六-路由传值"><a href="#六-路由传值" class="headerlink" title="六.路由传值"></a>六.路由传值</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">1.</span><br><span class="line">&#123;</span><br><span class="line">      path: &#39;&#x2F;playvideo&#x2F;:name&#39;,</span><br><span class="line">      name: &#39;PlayVideo&#39;,</span><br><span class="line">      component: PlayVideo</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">  this.$router.push(</span><br><span class="line">        &#123;</span><br><span class="line">          path:&#96;&#x2F;playvideo&#x2F;$&#123;name&#125;&#96;</span><br><span class="line">        &#125;)</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line"> 2. this.$router.push(&#123;</span><br><span class="line">          name: &#39;Describe&#39;,</span><br><span class="line">          params: &#123;</span><br><span class="line">            id: id</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">3. this.$router.push(&#123;</span><br><span class="line">          path: &#39;&#x2F;describe&#39;,</span><br><span class="line">          query: &#123;</span><br><span class="line">            id: id</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;)</span><br></pre></td></tr></table></figure>

<h1 id="七-keep-alive"><a href="#七-keep-alive" class="headerlink" title="七.keep-alive"></a>七.keep-alive</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">keep-alive是Vue提供的一个抽象组件，用来对组件进行缓存，从而节省性能，由于是一个抽象组件，所以在v页面渲染完毕后不会被渲染成一个DOM元素</span><br><span class="line"></span><br><span class="line">被包裹在keep-alive中的组件的状态将会被保留，例如我们将某个列表类组件内容滑动到第100条位置，那么我们在切换到一个组件后再次切换回到该组件，该组件的位置状态依旧会保持在第100条列表处</span><br><span class="line">1.include 和 exclude</span><br><span class="line">    </span><br><span class="line">    &lt;keep-alive include&#x3D;&quot;bookLists,bookLists&quot;&gt;</span><br><span class="line">          &lt;router-view&gt;&lt;&#x2F;router-view&gt;</span><br><span class="line">    &lt;&#x2F;keep-alive&gt;</span><br><span class="line">    &lt;keep-alive exclude&#x3D;&quot;indexLists&quot;&gt;</span><br><span class="line">          &lt;router-view&gt;&lt;&#x2F;router-view&gt;</span><br><span class="line">    &lt;&#x2F;keep-alive&gt;</span><br><span class="line">	</span><br><span class="line">利用include、exclude属性</span><br><span class="line">include属性表示只有name属性为bookLists，bookLists的组件会被缓存，（注意是组件的名字，不是路由的名字）其它组件不会被缓存exclude属性表示除了name属性为indexLists的组件不会被缓存，其它组件都会被缓存</span><br><span class="line">2.</span><br></pre></td></tr></table></figure>

<h1 id="八-前端下载"><a href="#八-前端下载" class="headerlink" title="八.前端下载"></a>八.前端下载</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">console.log(res);</span><br><span class="line">          const blob &#x3D; new Blob([res.data]);</span><br><span class="line">          const fileName &#x3D; filename;</span><br><span class="line">          const alink &#x3D; document.createElement(&quot;a&quot;);</span><br><span class="line">          alink.download &#x3D; fileName;</span><br><span class="line">          alink.style.display &#x3D; &quot;none&quot;;</span><br><span class="line">          alink.href &#x3D; URL.createObjectURL(blob); &#x2F;&#x2F; 这里是将文件流转化为一个文件地址</span><br><span class="line">          document.body.appendChild(alink);</span><br><span class="line">          alink.click();</span><br><span class="line">          URL.revokeObjectURL(alink.href); &#x2F;&#x2F; 释放URL 对象</span><br><span class="line">          document.body.removeChild(alink);</span><br></pre></td></tr></table></figure>

<h1 id="九-router-view"><a href="#九-router-view" class="headerlink" title="九.router-view"></a>九.router-view</h1><p>嵌套路由跳转</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"> &lt;div&gt;</span><br><span class="line">      &lt;router-link to&#x3D;&quot;&#x2F;hello1&quot;&gt;hello1&lt;&#x2F;router-link&gt;</span><br><span class="line">      &lt;router-link to&#x3D;&quot;&#x2F;hello2&quot;&gt;hello2&lt;&#x2F;router-link&gt;</span><br><span class="line">      &lt;router-link to&#x3D;&quot;&#x2F;hello3&quot;&gt;hello3&lt;&#x2F;router-link&gt;</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">    路由1&lt;router-view id&#x3D;&quot;sencond&quot; name&#x3D;&quot;default&quot;&gt;&lt;&#x2F;router-view&gt;</span><br><span class="line"></span><br><span class="line">routes: [</span><br><span class="line">    &#x2F;&#x2F; &#123;</span><br><span class="line">    &#x2F;&#x2F;   path: &#39;&#x2F;&#39;,</span><br><span class="line">    &#x2F;&#x2F;   name: &#39;HelloWorld&#39;,</span><br><span class="line">    &#x2F;&#x2F;   component: HelloWorld,</span><br><span class="line">    &#x2F;&#x2F; &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      path: &#39;&#x2F;&#39;,</span><br><span class="line">      name: &#39;world&#39;,</span><br><span class="line">      components: &#123;</span><br><span class="line">        default: HelloWorld,</span><br><span class="line">        second: Test</span><br><span class="line">      &#125;,</span><br><span class="line">      children:[</span><br><span class="line">        &#123;</span><br><span class="line">          path: &#39;&#x2F;hello1&#39;,</span><br><span class="line">          name: &#39;hello1&#39;,</span><br><span class="line">          component: hello1</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          path: &#39;&#x2F;hello2&#39;,</span><br><span class="line">          name: &#39;hello2&#39;,</span><br><span class="line">          component: hello2</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          path: &#39;&#x2F;hello3&#39;,</span><br><span class="line">          name: &#39;hello3&#39;,</span><br><span class="line">          component: hello3</span><br><span class="line">        &#125;,</span><br></pre></td></tr></table></figure>

<h1 id="十-vue后台管理框架"><a href="#十-vue后台管理框架" class="headerlink" title="十.vue后台管理框架"></a>十.vue后台管理框架</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">1.vue element admin</span><br><span class="line">https:&#x2F;&#x2F;github.com&#x2F;PanJiaChen&#x2F;vue-element-admin</span><br><span class="line"></span><br><span class="line">2.vue admin</span><br><span class="line">https:&#x2F;&#x2F;github.com&#x2F;taylorchen709&#x2F;vue-admin</span><br><span class="line"></span><br><span class="line">3.vue-manage-system</span><br><span class="line">https:&#x2F;&#x2F;github.com&#x2F;lin-xin&#x2F;vue-manage-system</span><br><span class="line"></span><br><span class="line">4.iview-admin</span><br><span class="line">https:&#x2F;&#x2F;github.com&#x2F;iview&#x2F;iview-admin</span><br><span class="line"></span><br><span class="line">5.vuestic-admin</span><br><span class="line">https:&#x2F;&#x2F;github.com&#x2F;epicmaxco&#x2F;vuestic-admin</span><br><span class="line"></span><br><span class="line">6.d2-admin</span><br><span class="line">https:&#x2F;&#x2F;github.com&#x2F;d2-projects&#x2F;d2-admin</span><br></pre></td></tr></table></figure>

<h1 id="十一-add-routers权限控制"><a href="#十一-add-routers权限控制" class="headerlink" title="十一.add routers权限控制"></a>十一.add routers权限控制</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br></pre></td><td class="code"><pre><span class="line">这里面出现了两个个新的概念叫 “动态添加路由”和“导航守卫”，就是我前端router.js中只写所有人可以访问的路由表，比如login和404页面等。其他所有的组件资源全部写到一个新的components.js文件中，然后通过后端返回的menuData去映射符合components.js中的key，如果有对应的，就把它动态添加到router中，通过addRoutes添加。动态添加路由这个方法要写到导航守卫beforeEach这个钩子函数中。导航守卫的意思是我路由跳转到下个页面之前要做些什么。就是说我们登录后会跳到dashboard页面，在进到这个页面之前我们需要将后端请求回来的menuData进行二次封装，把他根据权限返回回来的data与我们前端components.js去做map匹配，将最终的数据通过addRoutes来push到我们的路由中，之后才能进到我们的dashborad页面，再通过dashborad页面进到对应的page页面，就是说我们把所有的权限控制全在dashboard页面进入之前就做完了。这里面还有一个小的优化的点：当我们通过前面说的浏览器菜单栏访问到非权限页面或者不存在的页面时，需要根据vue-router中的匹配优先级来最后addRoutes 404和*这个页面，这样就可以直接到达404页面而非空页面。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">1.所有页面资源</span><br><span class="line">	&#x2F;&#x2F; components.js 所有的页面资源  </span><br><span class="line">const home &#x3D; () &#x3D;&gt; import(&#39;..&#x2F;page&#x2F;Home.vue&#39;);</span><br><span class="line">const splashScreen &#x3D; () &#x3D;&gt; import(&#39;..&#x2F;page&#x2F;splashScreen&#x2F;SplashScreen.vue&#39;);</span><br><span class="line">const addSplashScreen &#x3D; () &#x3D;&gt; import(&#39;..&#x2F;page&#x2F;splashScreen&#x2F;AddSplashScreen.vue&#39;);</span><br><span class="line">const editSplashScreen &#x3D; () &#x3D;&gt; import(&#39;..&#x2F;page&#x2F;splashScreen&#x2F;EditSplashScreen.vue&#39;);</span><br><span class="line"></span><br><span class="line">    export default &#123;</span><br><span class="line">        home,</span><br><span class="line">        splashScreen,</span><br><span class="line">        addSplashScreen,</span><br><span class="line">        editSplashScreen,</span><br><span class="line">    &#125;;</span><br><span class="line">  2.router.js里面只书写所有用户通用的路由</span><br><span class="line">  3.路由跳转的时候进行</span><br><span class="line">  &#x2F;&#x2F; main.js  伪代码 只保留具体的相关逻辑</span><br><span class="line">import routeMap from &#39;.&#x2F;router&#x2F;component.js&#39;;</span><br><span class="line">const NotFound &#x3D; () &#x3D;&gt; import(&#39;.&#x2F;page&#x2F;404.vue&#39;);</span><br><span class="line">const formatRoutes &#x3D; function (routes, routeData) &#123;</span><br><span class="line">    if (!routeData) &#123;</span><br><span class="line">        routeData &#x3D; &#123;</span><br><span class="line">            name: &#39;home&#39;,</span><br><span class="line">            path: &#39;&#x2F;home&#39;,</span><br><span class="line">            &#x2F;&#x2F; 组件匹配成功的话才可以访问具体的页面</span><br><span class="line">            component: routeMap[&#39;home&#39;],</span><br><span class="line">            children: [],</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    routes.length &amp;&amp; routes.forEach(route &#x3D;&gt; &#123;</span><br><span class="line">        if(route.component) &#123;</span><br><span class="line">            route.component &#x3D; routeMap[route.component];</span><br><span class="line">            routeData.children.push(&#123;</span><br><span class="line">                path: route.path,</span><br><span class="line">                name: route.index,</span><br><span class="line">                component: route.component,</span><br><span class="line">                meta: &#123;</span><br><span class="line">                    title: route.title,</span><br><span class="line">                &#125;,</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">        if (route.children &amp;&amp; route.children.length) &#123;</span><br><span class="line">            formatRoutes(route.children, routeData);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    return routeData;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">let isFetchRemote &#x3D; true;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;使用钩子函数对路由进行权限跳转</span><br><span class="line">router.beforeEach((to, from, next) &#x3D;&gt; &#123;</span><br><span class="line">    const username &#x3D; sessionStorage.getItem(&#39;username&#39;);</span><br><span class="line">    if(!username &amp;&amp; to.path !&#x3D;&#x3D; &#39;&#x2F;login&#39;)&#123;</span><br><span class="line">        next(&#123;path: &#39;&#x2F;login&#39;&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    else if (isFetchRemote &amp;&amp; to.path !&#x3D;&#x3D; &#39;&#x2F;login&#39;) &#123;</span><br><span class="line">        ajaxPost(&#39;&#x2F;resourceAPI&#x2F;getMenuData&#39;).then(res &#x3D;&gt;&#123;</span><br><span class="line">            if (res.status &#x3D;&#x3D;&#x3D; 200 &amp;&amp; res.data.errno &#x3D;&#x3D;&#x3D; 0) &#123;</span><br><span class="line">                isFetchRemote &#x3D; false;</span><br><span class="line">                const menuData &#x3D; res.data.result;</span><br><span class="line">                localStorage.setItem(&#39;menudata&#39;, JSON.stringify(menuData));</span><br><span class="line">                const routeData &#x3D; formatRoutes(menuData);</span><br><span class="line">                resourceApp.$router.addRoutes([routeData].concat([</span><br><span class="line">                    &#123;name:&#39;404&#39;,path:&#39;&#x2F;404&#39;,component:NotFound&#125;,</span><br><span class="line">                    &#123;path:&#39;*&#39;,redirect: &#39;&#x2F;404&#39;&#125;]));</span><br><span class="line">                resourceApp.$router.push(&#123;</span><br><span class="line">                    path: to.path,</span><br><span class="line">                    query: to.query</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">            else &#123;</span><br><span class="line">                isFetchRemote &#x3D; true;</span><br><span class="line">            &#125;</span><br><span class="line">            next();</span><br><span class="line">        &#125;)</span><br><span class="line">        .catch(err &#x3D;&gt; &#123;</span><br><span class="line">            console.log(err);</span><br><span class="line">        &#125;);    </span><br><span class="line">    &#125;</span><br><span class="line">    else &#123;</span><br><span class="line">        next();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line">const resourceApp &#x3D; new Vue(&#123;</span><br><span class="line">    router,</span><br><span class="line">    render: h &#x3D;&gt; h(App)</span><br><span class="line">&#125;).$mount(&#39;#app&#39;);</span><br><span class="line"></span><br><span class="line">4.而sidebar和dashboard这两个组件都只需要通过session拿到后端的menudate就可以。</span><br><span class="line">	&#x2F;&#x2F; dashboard 伪代码</span><br><span class="line">    &lt;template&gt;</span><br><span class="line">        &lt;div class&#x3D;&quot;nav_list&quot;&gt;</span><br><span class="line">            &lt;div class&#x3D;&quot;nav_list_item&quot; v-for&#x3D;&quot;item in navList&quot; @click&#x3D;&quot;goPage(item)&quot;&gt;</span><br><span class="line">                &lt;i :class&#x3D;&quot;item.icon&quot;&gt;&lt;&#x2F;i&gt;</span><br><span class="line">                &lt;h2&gt;&#123;&#123;item.title&#125;&#125;&lt;&#x2F;h2&gt;</span><br><span class="line">            &lt;&#x2F;div&gt;</span><br><span class="line">        &lt;&#x2F;div&gt;                       </span><br><span class="line">    &lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">    &lt;script&gt;  </span><br><span class="line">        created()&#123;</span><br><span class="line">            const routeArr &#x3D; JSON.parse(localStorage.getItem(&#39;menudata&#39;));</span><br><span class="line">            this.navList &#x3D; routeArr;</span><br><span class="line">        &#125;,  </span><br><span class="line">        methods: &#123;</span><br><span class="line">            goPage(item)&#123;</span><br><span class="line">                &#x2F;&#x2F; 只有一级菜单</span><br><span class="line">                if(item.component)&#123;</span><br><span class="line">                    this.$router.push(item.path);</span><br><span class="line">                &#125;else&#123;</span><br><span class="line">                    &#x2F;&#x2F; 二级菜单的数据结构中只在children中有path</span><br><span class="line">                    this.$router.push(item.children[0][&#39;path&#39;]);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &lt;&#x2F;script&gt;</span><br><span class="line"> 5.</span><br><span class="line"> &#x2F;&#x2F; sidebar 伪代码</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    export default &#123;</span><br><span class="line">        data() &#123;</span><br><span class="line">            return &#123;</span><br><span class="line">                routes: [],</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        methods: &#123;</span><br><span class="line">            bouncer(arr)&#123;</span><br><span class="line">                return arr.filter(function(val)&#123;</span><br><span class="line">                  return !(!val || val &#x3D;&#x3D;&#x3D; &quot;&quot;);</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        created()&#123;</span><br><span class="line">            const menuData &#x3D; JSON.parse(localStorage.getItem(&#39;menudata&#39;));</span><br><span class="line">            &#x2F;&#x2F; 通过当前router的path来map对应的整个路由数组</span><br><span class="line">            let routes &#x3D; menuData.map((item)&#x3D;&gt;&#123;</span><br><span class="line"></span><br><span class="line">                &#x2F;&#x2F; 只有一级路由</span><br><span class="line">                if(item.component &amp;&amp; item.path &#x3D;&#x3D; this.$route.path)&#123;</span><br><span class="line">                    console.log(item)</span><br><span class="line">                    return item;</span><br><span class="line">                &#125;else&#123;</span><br><span class="line">                    if(item.children[0][&#39;path&#39;] &#x3D;&#x3D; this.$route.path)&#123;</span><br><span class="line">                        console.log(item)</span><br><span class="line">                        return item;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">            &#x2F;&#x2F; 去掉数组中的undefined、null 等空值 假值</span><br><span class="line">            this.routes &#x3D; this.bouncer(routes);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<h1 id="十二-vue打包注意事项"><a href="#十二-vue打包注意事项" class="headerlink" title="十二.vue打包注意事项"></a>十二.vue打包注意事项</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line">在build&#x2F;utils.js里找到以下代码段添加 publicPath:&#39;..&#x2F;..&#x2F;&#39; </span><br><span class="line"></span><br><span class="line">把config&#x2F;index.js里的module.exports的build的assetsPublicPath改为&#39;.&#x2F;&#39;</span><br><span class="line"></span><br><span class="line">1.在config&#x2F;index.js中将assetsPublicPath原来的’&#x2F;‘修改为‘.&#x2F;’。</span><br><span class="line">2.在nigx服务器上的操作</span><br><span class="line"></span><br><span class="line">2.在nigx服务器上的操作</span><br><span class="line">  1.</span><br><span class="line">server</span><br><span class="line">&#123;</span><br><span class="line">##在server下添加或在location里面添加以下代码</span><br><span class="line">location &#x2F;</span><br><span class="line">&#123;</span><br><span class="line">if (!-e $request_filename) &#123;</span><br><span class="line">rewrite ^(.*)$ &#x2F;index.html?s&#x3D;$1 last;</span><br><span class="line">break;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">## 如果访问的不是根目录用下面方式设置 qiancheng是我的子目录</span><br><span class="line">   location &#x2F;qiancheng&#123;</span><br><span class="line">　　　　if (!-e $request_filename) &#123;</span><br><span class="line">　　　　　　rewrite ^&#x2F;(.*) &#x2F;qiancheng&#x2F;index.html last;</span><br><span class="line">　　　　　　break;</span><br><span class="line">　　　　&#125;</span><br><span class="line">　　&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">配置后刷新页面出现404的话前端改一下打包文件把相对路径改成绝对路径就OK了!</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 这是原来的代码</span><br><span class="line">&lt;link href&#x3D;.&#x2F;static&#x2F;css&#x2F;app.917e9845e61fd94284baf966597e6264.css rel&#x3D;stylesheet&gt;</span><br><span class="line">&#x2F;&#x2F; 这是修改后的代码</span><br><span class="line">&lt;link href&#x3D;&#x2F;static&#x2F;css&#x2F;app.917e9845e61fd94284baf966597e6264.css rel&#x3D;stylesheet&gt;</span><br><span class="line">&#x2F;&#x2F; 如果访问的是子目录请加上子目录</span><br><span class="line">&lt;link href&#x3D;&#x2F;子目录&#x2F;static&#x2F;css&#x2F;app.917e9845e61fd94284baf966597e6264.css rel&#x3D;stylesheet&gt;</span><br><span class="line"></span><br><span class="line"> 2.</span><br><span class="line"></span><br><span class="line">把项目打包后的dist里面的文件复制粘贴到Nginx的html文件下（替换Nginx的文件）</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">3.部署在tomcat</span><br><span class="line">	1、解决history模式，报404。直接在Tomcat中的web.xml中加入以下内容解决：</span><br><span class="line">                 &lt;error-page&gt;    </span><br><span class="line">                    &lt;error-code&gt;404&lt;&#x2F;error-code&gt;    </span><br><span class="line">                    &lt;location&gt;&#x2F;&lt;&#x2F;location&gt;    </span><br><span class="line">                &lt;&#x2F;error-page&gt; </span><br><span class="line">     2.config文件夹中，index.js文件代码打包配置如下，此处只展示build节点</span><br><span class="line">               build: &#123;</span><br><span class="line"></span><br><span class="line">            &#x2F;&#x2F; Template for index.html</span><br><span class="line">            index: path.resolve(__dirname, &#39;..&#x2F;dist&#x2F;index.html&#39;),</span><br><span class="line"></span><br><span class="line">            &#x2F;&#x2F; Paths</span><br><span class="line">            assetsRoot: path.resolve(__dirname, &#39;..&#x2F;dist&#39;),</span><br><span class="line">            assetsSubDirectory: &#39;static&#39;,</span><br><span class="line">            assetsPublicPath: &#39;&#x2F;dist&#x2F;&#39;,</span><br><span class="line"></span><br><span class="line">            &#x2F;**</span><br><span class="line">             * Source Maps</span><br><span class="line">             *&#x2F;</span><br><span class="line"></span><br><span class="line">            productionSourceMap: false,</span><br><span class="line">            &#x2F;&#x2F; https:&#x2F;&#x2F;webpack.js.org&#x2F;configuration&#x2F;devtool&#x2F;#production</span><br><span class="line">            devtool: &#39;#source-map&#39;,</span><br><span class="line"></span><br><span class="line">            &#x2F;&#x2F; Gzip off by default as many popular static hosts such as</span><br><span class="line">            &#x2F;&#x2F; Surge or Netlify already gzip all static assets for you.</span><br><span class="line">            &#x2F;&#x2F; Before setting to &#96;true&#96;, make sure to:</span><br><span class="line">            &#x2F;&#x2F; npm install --save-dev compression-webpack-plugin</span><br><span class="line">            productionGzip: false,</span><br><span class="line">            productionGzipExtensions: [&#39;js&#39;, &#39;css&#39;],</span><br><span class="line"></span><br><span class="line">            &#x2F;&#x2F; Run the build command with an extra argument to</span><br><span class="line">            &#x2F;&#x2F; View the bundle analyzer report after build finishes:</span><br><span class="line">            &#x2F;&#x2F; &#96;npm run build --report&#96;</span><br><span class="line">            &#x2F;&#x2F; Set to &#96;true&#96; or &#96;false&#96; to always turn it on or off</span><br><span class="line">            bundleAnalyzerReport: process.env.npm_config_report</span><br><span class="line">          &#125;</span><br><span class="line">3.、代码中解决静态资源无法找到，比如图片的路径必须定位到精确目录。</span><br><span class="line">	&lt;img src&#x3D;&quot;..&#x2F;..&#x2F;..&#x2F;static&#x2F;image&#x2F;complain1.png&quot; class&#x3D;&quot;card-img&quot;&gt;</span><br><span class="line">	</span><br><span class="line">	具体文献参考https:&#x2F;&#x2F;www.jianshu.com&#x2F;p&#x2F;a8fb034f6b6a</span><br></pre></td></tr></table></figure>

<h1 id="十三-自定义指令"><a href="#十三-自定义指令" class="headerlink" title="十三.自定义指令"></a>十三.自定义指令</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">const aclDirective &#x3D; &#123;</span><br><span class="line">    inserted:function(el,binding)&#123; &#x2F;&#x2F; 在被绑定的元素插入到dom中时</span><br><span class="line">        const hasAuth &#x3D; function(needAuths，haveAuths)&#123; &#x2F;&#x2F;判断用户是否拥有权限的function</span><br><span class="line">            &#x2F;&#x2F; implement </span><br><span class="line">        &#125;</span><br><span class="line">        const havaAuths &#x3D; []; &#x2F;&#x2F; 用户拥有的权限列表</span><br><span class="line">        if(!hasAuth(binding.value,haveAuths))&#123; &#x2F;&#x2F;binding.value 可以获得绑定指令时传入的参数</span><br><span class="line">            el.style &#x3D; &quot;display:none&quot;; &#x2F;&#x2F;修改元素的可见状态</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;main.js</span><br><span class="line">Vue.directive(&#39;acl&#39;,aclDirective);</span><br></pre></td></tr></table></figure>

<h1 id="十四-vuex的核心概念"><a href="#十四-vuex的核心概念" class="headerlink" title="十四.vuex的核心概念"></a>十四.vuex的核心概念</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">Vuex有五个核心概念：</span><br><span class="line"></span><br><span class="line">　　state, getters, mutations, actions, modules。</span><br><span class="line"></span><br><span class="line">　　1. state：vuex的基本数据，用来存储变量</span><br><span class="line"></span><br><span class="line">　　 2. geeter：从基本数据(state)派生的数据，相当于state的计算属性</span><br><span class="line">　　 3. mutation：提交更新数据的方法，必须是同步的(如果需要异步使用action)。每个 mutation 都有一个字符串的 事件类型 (type) 和 一个 回调函数 (handler)。</span><br><span class="line"></span><br><span class="line">　　 回调函数就是我们实际进行状态更改的地方，并且它会接受 state 作为第一个参数，提交载荷作为第二个参数。</span><br><span class="line">　　 4. action：和mutation的功能大致相同，不同之处在于 &#x3D;&#x3D;》1. Action 提交的是 mutation，而不是直接变更状态。 2. Action 可以包含任意异步操作。</span><br><span class="line"></span><br><span class="line">　　  5. modules：模块化vuex，可以让每一个模块拥有自己的state、mutation、action、getters,使得结构非常清晰，方便管理。</span><br><span class="line">　　  </span><br><span class="line">　　  使用下面这两种方法存储数据：</span><br><span class="line">　　dispatch：异步操作，写法： this.$store.dispatch(&#39;mutations方法名&#39;,值)</span><br><span class="line">　　commit：同步操作，写法：this.$store.commit(&#39;mutations方法名&#39;,值)</span><br><span class="line">　　</span><br><span class="line">　　在actions中提交mutation，并且可以包含任何的异步操作。actions可以理解为通过将mutations里面处里数据的方法变成可异步的处理数据的方法，简单的说就是异步操作数据（但是还是通过mutation来操作，因为只有它能操作）</span><br></pre></td></tr></table></figure>

<h1 id="十五-在vue中使用富文本编辑器"><a href="#十五-在vue中使用富文本编辑器" class="headerlink" title="十五.在vue中使用富文本编辑器"></a>十五.在vue中使用富文本编辑器</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">1. 安装</span><br><span class="line">	npm install vue-quill-editor -S</span><br><span class="line">	npm install quill -S</span><br><span class="line">2.引入</span><br><span class="line">    &#x2F;&#x2F;引入富文本编辑器</span><br><span class="line">    import &#123; quillEditor &#125; from &#39;vue-quill-editor&#39;</span><br><span class="line">    import &#39;quill&#x2F;dist&#x2F;quill.core.css&#39;</span><br><span class="line">    import &#39;quill&#x2F;dist&#x2F;quill.snow.css&#39;</span><br><span class="line">    import &#39;quill&#x2F;dist&#x2F;quill.bubble.css&#39;</span><br><span class="line">    Vue.use(quillEditor)</span><br><span class="line">3.使用</span><br><span class="line">	&lt;quill-editor</span><br><span class="line">    v-model&#x3D;&quot;content&quot;</span><br><span class="line">    ref&#x3D;&quot;myQuillEditor&quot;</span><br><span class="line">    :options&#x3D;&quot;editorOption&quot;</span><br><span class="line">    @focus&#x3D;&quot;onEditorFocus($event)&quot;</span><br><span class="line">    @blur&#x3D;&quot;onEditorBlur($event)&quot;</span><br><span class="line">    @change&#x3D;&quot;onEditorChange($event)&quot;</span><br><span class="line">  &gt;</span><br><span class="line">  &lt;&#x2F;quill-editor&gt;</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  import &#123;quillEditor&#125; from &#39;vue-quill-editor&#39;</span><br><span class="line">export default &#123;</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      content: &quot;&quot;, &#x2F;&#x2F; 富文本编辑器默认内容</span><br><span class="line">      editorOption: &#123;</span><br><span class="line">       </span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  mounted() &#123;</span><br><span class="line">    this.editor &#x3D; this.$refs.myQuillEditor.quill;</span><br><span class="line">  &#125;,</span><br><span class="line">  beforeDestroy() &#123;</span><br><span class="line">    this.editor &#x3D; null;</span><br><span class="line">    delete this.editor;</span><br><span class="line">  &#125;,</span><br><span class="line">  components:&#123;</span><br><span class="line">      quillEditor</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    &#x2F;&#x2F; 准备富文本编辑器</span><br><span class="line">    onEditorReady(editor) &#123;&#125;,</span><br><span class="line">    &#x2F;&#x2F; 富文本编辑器 失去焦点事件</span><br><span class="line">    onEditorBlur(editor) &#123;&#125;,</span><br><span class="line">    &#x2F;&#x2F; 富文本编辑器 获得焦点事件</span><br><span class="line">    onEditorFocus(editor) &#123;&#125;,</span><br><span class="line">    &#x2F;&#x2F; 富文本编辑器 内容改变事件</span><br><span class="line">    onEditorChange(editor,html,text) &#123;</span><br><span class="line">        console.log(this.content)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h1 id="十六-vuex持久化"><a href="#十六-vuex持久化" class="headerlink" title="十六.vuex持久化"></a>十六.vuex持久化</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">设置state为null,然后在对应的getters里面添加sessionStorage控制,在mutations里面添加对应sessionStorage控制,如：</span><br><span class="line">1.方法1</span><br><span class="line">let _store &#x3D; &#123;</span><br><span class="line">  state: &#123;</span><br><span class="line">    appType: null</span><br><span class="line">  &#125;,</span><br><span class="line">  getters: &#123;</span><br><span class="line">    appType(state)&#123;</span><br><span class="line">        if(!state.appType) &#123;</span><br><span class="line">          state.appType &#x3D; getSessionStorage(&quot;appType&quot;)</span><br><span class="line">        &#125;</span><br><span class="line">        return state.appType</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  mutations: &#123;</span><br><span class="line">    setAppType (state, appType) &#123;</span><br><span class="line">       state.appType &#x3D; appType</span><br><span class="line">       setSessionStorage(&quot;appType&quot;,appType)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">2.方法2</span><br><span class="line">在页面初始化的时候,取出所有的保存在sessionStorage里面的值,同时在页面刷新前,将所有的state保存在sessionStorage里面</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;在页面加载时读取sessionStorage里的状态信息</span><br><span class="line">if (sessionStorage.getItem(&quot;store&quot;) ) &#123;</span><br><span class="line">    this.$store.replaceState(Object.assign(&#123;&#125;,     </span><br><span class="line">    this.$store.state,JSON.parse(sessionStorage.getItem(&quot;store&quot;))))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F;在页面刷新时将vuex里的信息保存到sessionStorage里</span><br><span class="line">window.addEventListener(&quot;beforeunload&quot;,()&#x3D;&gt;&#123;</span><br><span class="line">    sessionStorage.setItem(&quot;store&quot;,JSON.stringify(this.$store.state))</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">3.最终解决方案:</span><br><span class="line">const myPlugin &#x3D; store &#x3D;&gt; &#123;</span><br><span class="line">      &#x2F;&#x2F; 当 store 初始化后调用</span><br><span class="line">      let _state &#x3D; store.state;</span><br><span class="line">      for(let key in _state) &#123;</span><br><span class="line">        let _sessionvalue &#x3D; getSessionStorage(key);</span><br><span class="line">        if(_sessionvalue) &#123;</span><br><span class="line">          _state[key] &#x3D; _sessionvalue;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;&lt;br</span><br><span class="line">      </span><br><span class="line"></span><br><span class="line">办法一：将vuex中的数据直接保存到浏览器缓存中（sessionStorage、localStorage、cookie）</span><br><span class="line">办法二：在页面刷新的时候再次请求远程数据，使之动态更新vuex数据</span><br><span class="line">办法三：在父页面向后台请求远程数据，并且在页面刷新前将vuex的数据先保存至sessionStorage（以防请求数据量过大页面加载时拿不到返回的数据）</span><br><span class="line"></span><br><span class="line">分析：</span><br><span class="line">办法一的缺点是不安全，不适用大数据量的存储；</span><br><span class="line">办法二适用于少量的数据，并且不会出现网络延迟；</span><br><span class="line">办法三是要讲的重点，办法二和办法一一起使用。</span><br><span class="line"></span><br><span class="line">作者：kimshare</span><br><span class="line">链接：https:&#x2F;&#x2F;www.jianshu.com&#x2F;p&#x2F;c2078f6f63b3</span><br><span class="line">来源：简书</span><br><span class="line">著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。</span><br></pre></td></tr></table></figure>

<h1 id="十七-自定义指令"><a href="#十七-自定义指令" class="headerlink" title="十七.自定义指令"></a>十七.自定义指令</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Vue.directive(&#39;focus&#39;, &#123;</span><br><span class="line">  &#x2F;&#x2F; 当被绑定的元素插入到 DOM 中时……</span><br><span class="line">  inserted: function (el) &#123;</span><br><span class="line">    &#x2F;&#x2F; 聚焦元素</span><br><span class="line">    el.focus()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line">&lt;input v-focus&gt;</span><br></pre></td></tr></table></figure>

<h1 id="十八-瀑布流"><a href="#十八-瀑布流" class="headerlink" title="十八.瀑布流"></a>十八.瀑布流</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm i vue-waterfall2@latest --save</span><br><span class="line">import waterfall from &#39;vue-waterfall2&#39;;</span><br><span class="line">Vue.use(waterfall);</span><br></pre></td></tr></table></figure>

<h1 id="十九-elementUI表单验证"><a href="#十九-elementUI表单验证" class="headerlink" title="十九.elementUI表单验证"></a>十九.elementUI表单验证</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">el-form属性</span><br><span class="line">	model	表单数据对象</span><br><span class="line">			:model&#x3D;&quot;ruleForm&quot;  ruleForm&#x3D;&#123;pass: &#39;&#39;,checkPass: &#39;&#39;,age: &#39;&#39;&#125; 控制</span><br><span class="line">			el-form-item  子表单项目使用 prop&#x3D;&quot;pass&quot;来输入值</span><br><span class="line">	rules	表单验证规则</span><br><span class="line">	</span><br><span class="line">	ref&#x3D;&quot;ruleForm&quot;  操作DOM对象</span><br><span class="line">	</span><br><span class="line">	status-icon	是否在输入框中显示校验结果反馈图标</span><br></pre></td></tr></table></figure>

<h1 id="二十-权限控制"><a href="#二十-权限控制" class="headerlink" title="二十.权限控制"></a>二十.权限控制</h1><h2 id="20-1菜单栏控制"><a href="#20-1菜单栏控制" class="headerlink" title="20.1菜单栏控制"></a>20.1菜单栏控制</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">this.$store.commit(&#39;SetRouterList&#39;,res.routerList)</span><br><span class="line">this.$store.commit(&#39;Setusername&#39;,this.username)</span><br><span class="line"></span><br><span class="line">state:&#123;</span><br><span class="line">        token:&#39;&#39;,</span><br><span class="line">        routerList: JSON.parse(sessionStorage.getItem(&#39;routerList&#39;) || &#39;[]&#39;),</span><br><span class="line">        username:sessionStorage.getItem(&#39;username&#39;) || &#39;&#39;</span><br><span class="line">    &#125;,</span><br><span class="line">    mutations:&#123;</span><br><span class="line">        Setusername(state,name)&#123;</span><br><span class="line">            sessionStorage.setItem(&#39;username&#39;,name)</span><br><span class="line">            state.username &#x3D; name</span><br><span class="line">        &#125;,</span><br><span class="line">        changeToken(state,str)&#123;</span><br><span class="line">            state.token &#x3D; str;</span><br><span class="line">        &#125;,</span><br><span class="line">        exit(state)&#123;</span><br><span class="line">            state.token &#x3D; &#39;&#39;;</span><br><span class="line">        &#125;,</span><br><span class="line">        SetRouterList(state,arr)&#123;</span><br><span class="line">            sessionStorage.setItem(&#39;routerList&#39;,JSON.stringify(arr))</span><br><span class="line">            state.routerList &#x3D; arr</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    &#x2F;&#x2F;表单</span><br><span class="line">     &lt;el-menu-item</span><br><span class="line">          v-for&#x3D;&quot;(item, index) in menuList&quot;</span><br><span class="line">          :key&#x3D;&quot;index&quot;</span><br><span class="line">          :index&#x3D;&quot;&#96;$&#123;index+1&#125;&#96;&quot;</span><br><span class="line">          @click&#x3D;&quot;handleOpen(index+1,item.routerpath)&quot;</span><br><span class="line">        &gt;</span><br><span class="line">          &lt;i :class&#x3D;&quot;&#39;el-icon-&#39; + item.icon&quot;&gt;&lt;&#x2F;i&gt;</span><br><span class="line">          &lt;span slot&#x3D;&quot;title&quot;&gt;&#123;&#123; item.routername &#125;&#125;&lt;&#x2F;span&gt;</span><br><span class="line">        &lt;&#x2F;el-menu-item&gt;</span><br></pre></td></tr></table></figure>

<h2 id="20-2路由控制"><a href="#20-2路由控制" class="headerlink" title="20.2路由控制"></a>20.2路由控制</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>根据token判断</span><br><span class="line">    <span class="keyword">var</span> checked = <span class="literal">false</span>;</span><br><span class="line">    router.beforeEach(<span class="function">(<span class="params">to, <span class="keyword">from</span>, next</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">//const isLogin = store.state.token ? true : false;</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">// if (to.path == &quot;/&quot; || to.path == &quot;/word&quot;) &#123;</span></span><br><span class="line">      <span class="comment">//   next();</span></span><br><span class="line">      <span class="comment">// &#125; else &#123;</span></span><br><span class="line">      <span class="comment">//   if (store.state.token == &quot;&quot;) &#123;</span></span><br><span class="line">      <span class="comment">//     Message(&#123;</span></span><br><span class="line">      <span class="comment">//       message: &quot;没有token请重新登录&quot;,</span></span><br><span class="line">      <span class="comment">//       type: &quot;err&quot;</span></span><br><span class="line">      <span class="comment">//     &#125;);</span></span><br><span class="line">      <span class="comment">//     next(&quot;/&quot;);</span></span><br><span class="line">      <span class="comment">//   &#125; else &#123;</span></span><br><span class="line">      <span class="comment">//检测权限控制</span></span><br><span class="line">      <span class="comment">// if (!checked) &#123;</span></span><br><span class="line">      <span class="comment">//   GetAuthority(&#123;</span></span><br><span class="line">      <span class="comment">//     username: &quot;mikasa&quot;</span></span><br><span class="line">      <span class="comment">//   &#125;).then(res =&gt; &#123;</span></span><br><span class="line">      <span class="comment">//     console.log(res);</span></span><br><span class="line">      <span class="comment">//   &#125;);</span></span><br><span class="line">      <span class="comment">//   checked = true;</span></span><br><span class="line">      <span class="comment">// &#125;</span></span><br><span class="line">      next();</span><br><span class="line">      <span class="comment">// &#125;</span></span><br><span class="line">      <span class="comment">// &#125;</span></span><br><span class="line">    &#125;);</span><br><span class="line"> <span class="number">2.</span>定义路由规则</span><br><span class="line">     <span class="keyword">const</span> blogRule = &#123;<span class="attr">path</span>: <span class="string">&quot;/blogsub&quot;</span>,<span class="attr">name</span>: <span class="string">&quot;Editor&quot;</span>,<span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&quot;@/view/dashboard/blogsub&quot;</span>)&#125;</span><br><span class="line">    <span class="keyword">const</span> noteadminRule = &#123;<span class="attr">path</span>: <span class="string">&quot;/noteadmin&quot;</span>,<span class="attr">name</span>: <span class="string">&quot;Music&quot;</span>,<span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&quot;@/view/dashboard/noteadmin&quot;</span>)&#125;</span><br><span class="line">    <span class="keyword">const</span> userRule = &#123;<span class="attr">path</span>: <span class="string">&quot;/useradmin&quot;</span>,<span class="attr">name</span>: <span class="string">&quot;Self&quot;</span>,<span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&quot;@/view/dashboard/useradmin&quot;</span>)&#125;</span><br><span class="line">    <span class="keyword">const</span> prctureRule = &#123;<span class="attr">path</span>: <span class="string">&quot;/picture&quot;</span>,<span class="attr">name</span>: <span class="string">&quot;Display&quot;</span>,<span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&quot;@/view/dashboard/picture&quot;</span>)&#125;</span><br><span class="line">    <span class="keyword">const</span> selfinfoRule = &#123;<span class="attr">path</span>: <span class="string">&quot;/selfinfo&quot;</span>,<span class="attr">name</span>: <span class="string">&quot;Blog&quot;</span>,<span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&quot;@/view/dashboard/selfinfo&quot;</span>)&#125;</span><br><span class="line">    <span class="comment">//路由映射规则</span></span><br><span class="line">    <span class="keyword">const</span> ruleMappming = &#123;</span><br><span class="line">      <span class="string">&#x27;blogsub&#x27;</span> : blogRule,</span><br><span class="line">      <span class="string">&#x27;noteadmin&#x27;</span>: noteadminRule,</span><br><span class="line">      <span class="string">&#x27;useradmin&#x27;</span>:userRule,</span><br><span class="line">      <span class="string">&#x27;picture&#x27;</span>:prctureRule,</span><br><span class="line">      <span class="string">&#x27;selfinfo&#x27;</span>:selfinfoRule</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//匹配所有不存在就跳转</span></span><br><span class="line">    &#123;</span><br><span class="line">      path:<span class="string">&quot;*&quot;</span>,</span><br><span class="line">      component: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&quot;@/view/Notfound&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//动态路由添加</span></span><br><span class="line">    <span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">initDynamicRoutes</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">      <span class="comment">//获取当前的路由</span></span><br><span class="line">      <span class="keyword">const</span> currentRoute = router.options.routes</span><br><span class="line">      <span class="keyword">const</span> RoleList = store.state.routerList</span><br><span class="line">      RoleList.forEach(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">//如果有二级权限需要进行再次循环遍历</span></span><br><span class="line">        <span class="keyword">const</span> temp = ruleMappming[item.routerpath]</span><br><span class="line">        currentRoute[<span class="number">3</span>].children.push(temp)</span><br><span class="line">      &#125;);</span><br><span class="line">      router.addRoutes(currentRoute)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="number">3.</span>按钮级别的权限控制</span><br><span class="line">    V-permission=<span class="string">&quot;&#123;action:&#x27;add&#x27;,effect:&#x27;disabled&#x27;&#125;&quot;</span></span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    Vue.directive(<span class="string">&#x27;permission&#x27;</span>,&#123;</span><br><span class="line">        inserted:<span class="function"><span class="keyword">function</span>(<span class="params">el,binding</span>)</span>&#123;</span><br><span class="line">        	<span class="comment">//获取到值</span></span><br><span class="line">            <span class="keyword">const</span> action = binding.value.action</span><br><span class="line">            <span class="comment">//路由对应的组件中的meta字段</span></span><br><span class="line">            <span class="keyword">const</span> currentRoutes = route.currentRoute.meta</span><br><span class="line">            <span class="keyword">if</span>(currentRoutes.indexOf(action) == -<span class="number">1</span>)&#123;</span><br><span class="line">                <span class="keyword">if</span>(effect === <span class="string">&#x27;disabled&#x27;</span>)&#123;</span><br><span class="line">                	el.disabled = <span class="literal">true</span></span><br><span class="line">                	el.classlist.add(<span class="string">&#x27;is-disabled&#x27;</span>)</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                	<span class="comment">//el.parentNode.removeChild(el)</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">mikasa</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://yoursite.com/2020/11/30/vue%E8%A1%A5%E5%85%85/">http://yoursite.com/2020/11/30/vue%E8%A1%A5%E5%85%85/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://yoursite.com" target="_blank">mikasa</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://ss3.bdstatic.com/70cFv8Sh_Q1YnxGkpoWK1HF6hhy/it/u=22130535,2850036426&amp;fm=26&amp;gp=0.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2020/11/30/git/"><img class="prev-cover" src="https://ss2.bdstatic.com/70cFvnSh_Q1YnxGkpoWK1HF6hhy/it/u=283932388,350254066&amp;fm=26&amp;gp=0.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Git</div></div></a></div><div class="next-post pull-right"><a href="/2020/11/30/uniapp/"><img class="next-cover" src="https://ss0.bdstatic.com/70cFuHSh_Q1YnxGkpoWK1HF6hhy/it/u=2182504131,1408054639&amp;fm=11&amp;gp=0.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Uni-App</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside_content" id="aside_content"><div class="card-widget card-info"><div class="card-content"><div class="card-info-avatar is-center"><img class="avatar-img" src="/img/index/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">mikasa</div><div class="author-info__description">Java,JavaScript,Node,Json,Sql,前端,数据库,后端</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">57</div></a></div><div class="card-info-data-item is-center"><a href="/source/categories/"><div class="headline">分类</div><div class="length-num">16</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/zcz147258"><i class="fab fa-github"></i><span>Follow Me</span></a></div></div><div class="card-widget card-announcement"><div class="card-content"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">有缘人哦吼！</div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="card-content"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%80-%E5%AF%BC%E8%88%AA%E5%AE%88%E5%8D%AB"><span class="toc-number">1.</span> <span class="toc-text">一.导航守卫</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8C-Token%E9%AA%8C%E8%AF%81"><span class="toc-number">2.</span> <span class="toc-text">二.Token验证</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%89-less"><span class="toc-number">3.</span> <span class="toc-text">三.less</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9B%9B-Markdown"><span class="toc-number">4.</span> <span class="toc-text">四.Markdown</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%94-SRC%E8%AF%B7%E6%B1%82%E5%A4%B4%E5%8F%91%E9%80%81%E4%BF%A1%E6%81%AF"><span class="toc-number">5.</span> <span class="toc-text">五.SRC请求头发送信息</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%AD-%E8%B7%AF%E7%94%B1%E4%BC%A0%E5%80%BC"><span class="toc-number">6.</span> <span class="toc-text">六.路由传值</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%83-keep-alive"><span class="toc-number">7.</span> <span class="toc-text">七.keep-alive</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%AB-%E5%89%8D%E7%AB%AF%E4%B8%8B%E8%BD%BD"><span class="toc-number">8.</span> <span class="toc-text">八.前端下载</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B9%9D-router-view"><span class="toc-number">9.</span> <span class="toc-text">九.router-view</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8D%81-vue%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E6%A1%86%E6%9E%B6"><span class="toc-number">10.</span> <span class="toc-text">十.vue后台管理框架</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8D%81%E4%B8%80-add-routers%E6%9D%83%E9%99%90%E6%8E%A7%E5%88%B6"><span class="toc-number">11.</span> <span class="toc-text">十一.add routers权限控制</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8D%81%E4%BA%8C-vue%E6%89%93%E5%8C%85%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-number">12.</span> <span class="toc-text">十二.vue打包注意事项</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8D%81%E4%B8%89-%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8C%87%E4%BB%A4"><span class="toc-number">13.</span> <span class="toc-text">十三.自定义指令</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8D%81%E5%9B%9B-vuex%E7%9A%84%E6%A0%B8%E5%BF%83%E6%A6%82%E5%BF%B5"><span class="toc-number">14.</span> <span class="toc-text">十四.vuex的核心概念</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8D%81%E4%BA%94-%E5%9C%A8vue%E4%B8%AD%E4%BD%BF%E7%94%A8%E5%AF%8C%E6%96%87%E6%9C%AC%E7%BC%96%E8%BE%91%E5%99%A8"><span class="toc-number">15.</span> <span class="toc-text">十五.在vue中使用富文本编辑器</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8D%81%E5%85%AD-vuex%E6%8C%81%E4%B9%85%E5%8C%96"><span class="toc-number">16.</span> <span class="toc-text">十六.vuex持久化</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8D%81%E4%B8%83-%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8C%87%E4%BB%A4"><span class="toc-number">17.</span> <span class="toc-text">十七.自定义指令</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8D%81%E5%85%AB-%E7%80%91%E5%B8%83%E6%B5%81"><span class="toc-number">18.</span> <span class="toc-text">十八.瀑布流</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8D%81%E4%B9%9D-elementUI%E8%A1%A8%E5%8D%95%E9%AA%8C%E8%AF%81"><span class="toc-number">19.</span> <span class="toc-text">十九.elementUI表单验证</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8C%E5%8D%81-%E6%9D%83%E9%99%90%E6%8E%A7%E5%88%B6"><span class="toc-number">20.</span> <span class="toc-text">二十.权限控制</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#20-1%E8%8F%9C%E5%8D%95%E6%A0%8F%E6%8E%A7%E5%88%B6"><span class="toc-number">20.1.</span> <span class="toc-text">20.1菜单栏控制</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#20-2%E8%B7%AF%E7%94%B1%E6%8E%A7%E5%88%B6"><span class="toc-number">20.2.</span> <span class="toc-text">20.2路由控制</span></a></li></ol></li></ol></div></div></div><div class="card-widget card-recent-post"><div class="card-content"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2021/01/16/gulp/" title="Gulp打包"><img src="https://ss2.bdstatic.com/70cFvnSh_Q1YnxGkpoWK1HF6hhy/it/u=4045737814,934960022&amp;fm=26&amp;gp=0.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Gulp打包"/></a><div class="content"><a class="title" href="/2021/01/16/gulp/" title="Gulp打包">Gulp打包</a><time datetime="2021-01-16T02:30:11.932Z" title="发表于 2021-01-16 10:30:11">2021-01-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2020/12/18/proto%E5%9C%A8socket_io%E7%9A%84%E5%BA%94%E7%94%A8/" title="proto在socket_io的应用"><img src="https://ss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=4234896097,4021899470&amp;fm=26&amp;gp=0.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="proto在socket_io的应用"/></a><div class="content"><a class="title" href="/2020/12/18/proto%E5%9C%A8socket_io%E7%9A%84%E5%BA%94%E7%94%A8/" title="proto在socket_io的应用">proto在socket_io的应用</a><time datetime="2020-12-18T05:47:05.179Z" title="发表于 2020-12-18 13:47:05">2020-12-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2020/12/16/generator%E5%92%8Citerator/" title="generator和iterator"><img src="https://ss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=4234896097,4021899470&amp;fm=26&amp;gp=0.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="generator和iterator"/></a><div class="content"><a class="title" href="/2020/12/16/generator%E5%92%8Citerator/" title="generator和iterator">generator和iterator</a><time datetime="2020-12-16T03:42:48.398Z" title="发表于 2020-12-16 11:42:48">2020-12-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2020/12/16/js%E5%8A%A0%E8%A7%A3%E5%AF%86crypto.js/" title="js加解密"><img src="https://ss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=4234896097,4021899470&amp;fm=26&amp;gp=0.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="js加解密"/></a><div class="content"><a class="title" href="/2020/12/16/js%E5%8A%A0%E8%A7%A3%E5%AF%86crypto.js/" title="js加解密">js加解密</a><time datetime="2020-12-16T03:41:57.061Z" title="发表于 2020-12-16 11:41:57">2020-12-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2020/12/16/js%E5%AF%B9%E8%B1%A1%E6%95%B0%E7%BB%84%E6%8E%92%E5%BA%8F/" title="js对象数组排序"><img src="https://ss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=4234896097,4021899470&amp;fm=26&amp;gp=0.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="js对象数组排序"/></a><div class="content"><a class="title" href="/2020/12/16/js%E5%AF%B9%E8%B1%A1%E6%95%B0%E7%BB%84%E6%8E%92%E5%BA%8F/" title="js对象数组排序">js对象数组排序</a><time datetime="2020-12-16T03:40:27.119Z" title="发表于 2020-12-16 11:40:27">2020-12-16</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By mikasa</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">簡</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/medium-zoom/dist/medium-zoom.min.js"></script><div class="js-pjax"><script>function loadValine () {
  function initValine () {
    let initData = {
      el: '#vcomment',
      appId: 'BzB1So5EWrOm2CUDceS299It-gzGzoHsz',
      appKey: 'Ul1N9MAsFqovsupOVB5eoJee',
      placeholder: '记得留下你的暱称和邮箱....可以快速收到回復',
      avatar: 'monsterid',
      meta: 'nick,mail,link'.split(','),
      pageSize: '10',
      lang: 'zh-CN',
      recordIP: false,
      serverURLs: '',
      emojiCDN: '',
      emojiMaps: "",
      enableQQ: false,
      path: window.location.pathname,
    }

    if (true) { 
      initData.requiredFields= ('nick,mail'.split(','))
    }
    
    if (false) {
      const otherData = false
      initData = Object.assign({}, initData, otherData)
    }
    
    const valine = new Valine(initData)
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !true) {
  if (true) btf.loadComment(document.querySelector('#vcomment'),loadValine)
  else setTimeout(() => loadValine(), 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><div class="aplayer no-destroy" data-id="2484225391" data-server="netease" data-type="playlist" data-fixed="true" data-mini="true" data-listFolded="false" data-order="random" data-preload="none" data-autoplay="true" muted></div><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="false"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/gh/metowolf/MetingJS@1.2/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = [
  'title',
  '#config_change',
  '#body-wrap',
  '#rightside-config-hide',
  '#rightside-config-show',
  '.js-pjax'
]

if (false) {
  pjaxSelectors.unshift('meta[property="og:image"]', 'meta[property="og:title"]', 'meta[property="og:url"]')
}

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  if (typeof gtag === 'function') {
    gtag('config', '', {'page_path': window.location.pathname});
  }

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // Analytics
  if (false) {
    MtaH5.pgv()
  }

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()

  typeof preloader === 'object' && preloader.endLoading()
})


document.addEventListener('pjax:send', function () {
  typeof preloader === 'object' && preloader.initLoading()
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

})</script></div></body></html>